import{a1 as V,a2 as L,a3 as oe,a4 as be,a5 as ye,a6 as je,a7 as ce,a8 as de,a9 as Ne,aa as we,ab as me,ac as ue,ad as M,ae as Pe,af as J,ag as R,ah as xe,ai as Ae,aj as Ee,ak as Oe,al as Se,am as Y,an as z,ao as Te,ap as Ce,aq as ke,ar as De,as as Ie,at as Le,au as Re,av as _e,aw as Me,ax as Ke,ay as Fe,az as $e,aA as ee,aB as W,aC as te,aD as q,aE as Ue,aF as K,aG as Be,aH as We,aI as ze,aJ as Ve,aK as Ge,aL as He,j as a,aM as qe,i as Ze,m as Je,k as pe,U as Qe,T as Xe,N as Ye,aN as ae,aO as et,aP as tt,aQ as at,aR as st,aS as rt}from"./index-BrYbJWdQ.js";import{b as c,h as nt}from"./vendor-react-q0iRXJvs.js";import{g as ge,a as lt}from"./crmSupabase-DjQYshl6.js";import{C as it}from"./circle-alert-CY6baFk7.js";import{R as ot}from"./refresh-cw-ojo4KZA7.js";import"./vendor-supabase-DhDedaeW.js";function se(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function re(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?se(Object(s),!0).forEach(function(r){ct(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):se(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function ct(t,e,s){return(e=dt(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function dt(t){var e=mt(t,"string");return typeof e=="symbol"?e:e+""}function mt(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ut=(t,e)=>e,Q=V([je,ut],(t,e)=>t.filter(s=>s.type==="pie").find(s=>s.id===e)),xt=[],X=(t,e,s)=>s?.length===0?xt:s,ve=V([ye,Q,X],(t,e,s)=>{var{chartData:r}=t;if(e!=null){var n;if(e?.data!=null&&e.data.length>0?n=e.data:n=r,(!n||!n.length)&&s!=null&&(n=s.map(o=>re(re({},e.presentationProps),o.props))),n!=null)return n}}),pt=V([ve,Q,X],(t,e,s)=>{if(!(t==null||e==null))return t.map((r,n)=>{var o,d=L(r,e.nameKey,e.name),m;return s!=null&&(o=s[n])!==null&&o!==void 0&&(o=o.props)!==null&&o!==void 0&&o.fill?m=s[n].props.fill:typeof r=="object"&&r!=null&&"fill"in r?m=r.fill:m=e.fill,{value:oe(d,e.dataKey),color:m,payload:r,type:e.legendType}})}),gt=V([ve,Q,X,be],(t,e,s,r)=>{if(!(e==null||t==null))return Rt({offset:r,pieSettings:e,displayedData:t,cells:s})}),vt=["key"],ft=["onMouseEnter","onClick","onMouseLeave"],ht=["id"],bt=["id"];function ne(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function g(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?ne(Object(s),!0).forEach(function(r){yt(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ne(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function yt(t,e,s){return(e=jt(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function jt(t){var e=Nt(t,"string");return typeof e=="symbol"?e:e+""}function Nt(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S(){return S=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},S.apply(null,arguments)}function G(t,e){if(t==null)return{};var s,r,n=wt(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)s=o[r],e.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function wt(t,e){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function Pt(t){var e=c.useMemo(()=>ue(t.children,z),[t.children]),s=M(r=>pt(r,t.id,e));return s==null?null:c.createElement(Pe,{legendPayload:s})}var At=c.memo(t=>{var{dataKey:e,nameKey:s,sectors:r,stroke:n,strokeWidth:o,fill:d,name:m,hide:v,tooltipType:u,id:h}=t,f={dataDefinedOnItem:r.map(l=>l.tooltipPayload),getPosition:l=>{var x;return(x=r[Number(l)])===null||x===void 0?void 0:x.tooltipPosition},settings:{stroke:n,strokeWidth:o,fill:d,dataKey:e,nameKey:s,name:oe(m,e),hide:v,type:u,color:d,unit:"",graphicalItemId:h}};return c.createElement(Ae,{tooltipEntrySettings:f})}),Et=(t,e)=>t>e?"start":t<e?"end":"middle",Ot=(t,e,s)=>typeof e=="function"?K(e(t),s,s*.8):K(e,s,s*.8),St=(t,e,s)=>{var{top:r,left:n,width:o,height:d}=e,m=Ue(o,d),v=n+K(t.cx,o,o/2),u=r+K(t.cy,d,d/2),h=K(t.innerRadius,m,0),f=Ot(s,t.outerRadius,m),l=t.maxRadius||Math.sqrt(o*o+d*d)/2;return{cx:v,cy:u,innerRadius:h,outerRadius:f,maxRadius:l}},Tt=(t,e)=>{var s=W(e-t),r=Math.min(Math.abs(e-t),360);return s*r},Ct=(t,e)=>{if(c.isValidElement(t))return c.cloneElement(t,e);if(typeof t=="function")return t(e);var s=J("recharts-pie-label-line",typeof t!="boolean"?t.className:""),{key:r}=e,n=G(e,vt);return c.createElement(Be,S({},n,{type:"linear",className:s}))},kt=(t,e,s)=>{if(c.isValidElement(t))return c.cloneElement(t,e);var r=s;if(typeof t=="function"&&(r=t(e),c.isValidElement(r)))return r;var n=J("recharts-pie-label-text",We(t));return c.createElement(ze,S({},e,{alignmentBaseline:"middle",className:n}),r)};function Dt(t){var{sectors:e,props:s,showLabels:r}=t,{label:n,labelLine:o,dataKey:d}=s;if(!r||!n||!e)return null;var m=de(s),v=te(n),u=te(o),h=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,f=e.map((l,x)=>{var y=(l.startAngle+l.endAngle)/2,j=q(l.cx,l.cy,l.outerRadius+h,y),P=g(g(g(g({},m),l),{},{stroke:"none"},v),{},{index:x,textAnchor:Et(j.x,l.cx)},j),i=g(g(g(g({},m),l),{},{fill:"none",stroke:l.fill},u),{},{index:x,points:[q(l.cx,l.cy,l.outerRadius,y),j],key:"line"});return c.createElement(xe,{zIndex:me.label,key:"label-".concat(l.startAngle,"-").concat(l.endAngle,"-").concat(l.midAngle,"-").concat(x)},c.createElement(R,null,o&&Ct(o,i),kt(n,P,L(l,d))))});return c.createElement(R,{className:"recharts-pie-labels"},f)}function It(t){var{sectors:e,props:s,showLabels:r}=t,{label:n}=s;return typeof n=="object"&&n!=null&&"position"in n?c.createElement($e,{label:n}):c.createElement(Dt,{sectors:e,props:s,showLabels:r})}function Lt(t){var{sectors:e,activeShape:s,inactiveShape:r,allOtherPieProps:n,shape:o,id:d}=t,m=M(Ce),v=M(ke),u=M(De),{onMouseEnter:h,onClick:f,onMouseLeave:l}=n,x=G(n,ft),y=Ie(h,n.dataKey,d),j=Le(l),P=Re(f,n.dataKey,d);return e==null||e.length===0?null:c.createElement(c.Fragment,null,e.map((i,p)=>{if(i?.startAngle===0&&i?.endAngle===0&&e.length!==1)return null;var T=u==null||u===d,E=String(p)===m&&(v==null||n.dataKey===v)&&T,A=m?r:null,w=s&&E?s:A,N=g(g({},i),{},{stroke:i.stroke,tabIndex:-1,[Me]:p,[_e]:d});return c.createElement(R,S({key:"sector-".concat(i?.startAngle,"-").concat(i?.endAngle,"-").concat(i.midAngle,"-").concat(p),tabIndex:-1,className:"recharts-pie-sector"},Ke(x,i,p),{onMouseEnter:y(i,p),onMouseLeave:j(i,p),onClick:P(i,p)}),c.createElement(Fe,S({option:o??w,index:p,shapeType:"sector",isActive:E},N)))}))}function Rt(t){var e,{pieSettings:s,displayedData:r,cells:n,offset:o}=t,{cornerRadius:d,startAngle:m,endAngle:v,dataKey:u,nameKey:h,tooltipType:f}=s,l=Math.abs(s.minAngle),x=Tt(m,v),y=Math.abs(x),j=r.length<=1?0:(e=s.paddingAngle)!==null&&e!==void 0?e:0,P=r.filter(w=>L(w,u,0)!==0).length,i=(y>=360?P:P-1)*j,p=y-P*l-i,T=r.reduce((w,N)=>{var b=L(N,u,0);return w+(ee(b)?b:0)},0),E;if(T>0){var A;E=r.map((w,N)=>{var b=L(w,u,0),_=L(w,h,N),O=St(s,o,w),C=(ee(b)?b:0)/T,k,D=g(g({},w),n&&n[N]&&n[N].props);N?k=A.endAngle+W(x)*j*(b!==0?1:0):k=m;var F=k+W(x)*((b!==0?l:0)+C*p),$=(k+F)/2,U=(O.innerRadius+O.outerRadius)/2,B=[{name:_,value:b,payload:D,dataKey:u,type:f,graphicalItemId:s.id}],he=q(O.cx,O.cy,U,$);return A=g(g(g(g({},s.presentationProps),{},{percent:C,cornerRadius:typeof d=="string"?parseFloat(d):d,name:_,tooltipPayload:B,midAngle:$,middleRadius:U,tooltipPosition:he},D),O),{},{value:b,dataKey:u,startAngle:k,endAngle:F,payload:D,paddingAngle:W(x)*j}),A})}return E}function _t(t){var{showLabels:e,sectors:s,children:r}=t,n=c.useMemo(()=>!e||!s?[]:s.map(o=>({value:o.value,payload:o.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:o.cx,cy:o.cy,innerRadius:o.innerRadius,outerRadius:o.outerRadius,startAngle:o.startAngle,endAngle:o.endAngle,clockWise:!1},fill:o.fill})),[s,e]);return c.createElement(Te,{value:e?n:void 0},r)}function Mt(t){var{props:e,previousSectorsRef:s,id:r}=t,{sectors:n,isAnimationActive:o,animationBegin:d,animationDuration:m,animationEasing:v,activeShape:u,inactiveShape:h,onAnimationStart:f,onAnimationEnd:l}=e,x=Ee(e,"recharts-pie-"),y=s.current,[j,P]=c.useState(!1),i=c.useCallback(()=>{typeof l=="function"&&l(),P(!1)},[l]),p=c.useCallback(()=>{typeof f=="function"&&f(),P(!0)},[f]);return c.createElement(_t,{showLabels:!j,sectors:n},c.createElement(Oe,{animationId:x,begin:d,duration:m,isActive:o,easing:v,onAnimationStart:p,onAnimationEnd:i,key:x},T=>{var E,A=[],w=n&&n[0],N=(E=w?.startAngle)!==null&&E!==void 0?E:0;return n?.forEach((b,_)=>{var O=y&&y[_],C=_>0?Se(b,"paddingAngle",0):0;if(O){var k=Y(O.endAngle-O.startAngle,b.endAngle-b.startAngle,T),D=g(g({},b),{},{startAngle:N+C,endAngle:N+k+C});A.push(D),N=D.endAngle}else{var{endAngle:F,startAngle:$}=b,U=Y(0,F-$,T),B=g(g({},b),{},{startAngle:N+C,endAngle:N+U+C});A.push(B),N=B.endAngle}}),s.current=A,c.createElement(R,null,c.createElement(Lt,{sectors:A,activeShape:u,inactiveShape:h,allOtherPieProps:e,shape:e.shape,id:r}))}),c.createElement(It,{showLabels:!j,sectors:n,props:e}),e.children)}var Kt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:me.area};function Ft(t){var{id:e}=t,s=G(t,ht),{hide:r,className:n,rootTabIndex:o}=t,d=c.useMemo(()=>ue(t.children,z),[t.children]),m=M(h=>gt(h,e,d)),v=c.useRef(null),u=J("recharts-pie",n);return r||m==null?(v.current=null,c.createElement(R,{tabIndex:o,className:u})):c.createElement(xe,{zIndex:t.zIndex},c.createElement(At,{dataKey:t.dataKey,nameKey:t.nameKey,sectors:m,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:e}),c.createElement(R,{tabIndex:o,className:u},c.createElement(Mt,{props:g(g({},s),{},{sectors:m}),previousSectorsRef:v,id:e})))}function fe(t){var e=ce(t,Kt),{id:s}=e,r=G(e,bt),n=de(r);return c.createElement(Ne,{id:s,type:"pie"},o=>c.createElement(c.Fragment,null,c.createElement(we,{type:"pie",id:o,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:n,maxRadius:e.maxRadius}),c.createElement(Pt,S({},r,{id:o})),c.createElement(Ft,S({},r,{id:o}))))}fe.displayName="Pie";function le(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function ie(t){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?le(Object(s),!0).forEach(function(r){$t(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):le(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function $t(t,e,s){return(e=Ut(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function Ut(t){var e=Bt(t,"string");return typeof e=="symbol"?e:e+""}function Bt(t,e){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wt=["item"],zt=ie(ie({},He),{},{layout:"centric",startAngle:0,endAngle:360}),Vt=c.forwardRef((t,e)=>{var s=ce(t,zt);return c.createElement(Ve,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Wt,tooltipPayloadSearcher:Ge,categoricalChartProps:s,ref:e})});const Z=[{touch:1,name:"Initial Outreach",daysAfterPrevious:0,type:"initial"},{touch:2,name:"Value-Add Follow-up",daysAfterPrevious:3,type:"value"},{touch:3,name:"Social Proof",daysAfterPrevious:5,type:"proof"},{touch:4,name:"Meeting Request",daysAfterPrevious:5,type:"meeting"},{touch:5,name:"Permission to Close",daysAfterPrevious:7,type:"breakup"}];function Gt(t,e=1){if(!t)return null;const s=new Date(t),r=Z[e];if(!r)return null;let n=0;for(let d=1;d<=e;d++)n+=Z[d].daysAfterPrevious;const o=new Date(s);return o.setDate(o.getDate()+n),{touch:r.touch,name:r.name,type:r.type,dueDate:o,daysUntilDue:Math.ceil((o-new Date)/(1e3*60*60*24))}}function Ht(t){let e=1;(t.stage==="contacted"||t.stage==="meeting"||t.stage==="proposal")&&(e=1);const s=Gt(t.last_contact,e);if(!s)return{status:"complete",...t};const{daysUntilDue:r}=s;let n="upcoming";return r<0?n="overdue":r===0?n="today":r<=2&&(n="soon"),{...t,nextTouch:s,status:n,daysUntilDue:r}}function qt(){const[t,e]=c.useState([]),[s,r]=c.useState(!0),[n,o]=c.useState("all");c.useEffect(()=>{d()},[]);const d=async()=>{r(!0);try{const x=(await ge()).filter(y=>["new","contacted","meeting"].includes(y.stage)&&y.last_contact);e(x.map(Ht))}catch(l){console.error("Error loading leads:",l)}finally{r(!1)}},v=n==="all"?t:t.filter(l=>l.status===n),u=t.filter(l=>l.status==="overdue").length,h=t.filter(l=>l.status==="today").length,f=t.filter(l=>l.status==="soon").length;return s?a.jsx("div",{className:"text-gray-400",children:"Loading follow-ups..."}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white",children:"Follow-Up Scheduler"}),a.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mt-1",children:"5-Touch outreach strategy tracker"})]}),a.jsxs("div",{className:"flex gap-4 sm:gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-500",children:u}),a.jsx("div",{className:"text-xs text-gray-400",children:"Overdue"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-yellow-500",children:h}),a.jsx("div",{className:"text-xs text-gray-400",children:"Today"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-500",children:f}),a.jsx("div",{className:"text-xs text-gray-400",children:"Soon"})]})]})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:["all","overdue","today","soon","upcoming"].map(l=>a.jsx("button",{onClick:()=>o(l),className:`px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-all ${n===l?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:l.charAt(0).toUpperCase()+l.slice(1)},l))}),v.length===0?a.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 sm:p-8 text-center text-gray-400",children:[a.jsx(qe,{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2 sm:mb-3 text-green-500"}),a.jsxs("p",{className:"text-sm sm:text-base",children:["No follow-ups ",n!=="all"?n:"needed","!"]})]}):a.jsx("div",{className:"space-y-3",children:v.map(l=>a.jsx("div",{className:`bg-gray-800 rounded-lg p-3 sm:p-4 border-l-4 ${l.status==="overdue"?"border-red-500":l.status==="today"?"border-yellow-500":l.status==="soon"?"border-blue-500":"border-gray-600"}`,children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 flex-wrap",children:[a.jsx("h3",{className:"text-base sm:text-lg font-bold text-white truncate",children:l.org_name}),a.jsxs("span",{className:`px-2 py-0.5 sm:py-1 rounded text-xs font-medium flex-shrink-0 ${l.tier===1?"bg-red-900 text-red-200":l.tier===2?"bg-yellow-900 text-yellow-200":"bg-blue-900 text-blue-200"}`,children:["Tier ",l.tier]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4 text-xs sm:text-sm text-gray-400",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ze,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),a.jsxs("span",{className:"truncate",children:["Touch ",l.nextTouch.touch,": ",l.nextTouch.name]})]}),a.jsxs("div",{className:"flex items-center gap-4 sm:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),a.jsxs("span",{children:["Due: ",l.nextTouch.dueDate.toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(pe,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),a.jsx("span",{className:l.status==="overdue"?"text-red-400 font-medium":l.status==="today"?"text-yellow-400 font-medium":"text-gray-400",children:l.daysUntilDue===0?"Today":l.daysUntilDue<0?`${Math.abs(l.daysUntilDue)} days overdue`:`In ${l.daysUntilDue} days`})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 self-end sm:self-auto",children:[l.status==="overdue"&&a.jsx(it,{className:"w-5 h-5 text-red-500 hidden sm:block"}),a.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-all whitespace-nowrap",children:"Send Follow-Up"})]})]})},l.id))}),a.jsxs("details",{className:"bg-gray-800 rounded-lg",children:[a.jsxs("summary",{className:"p-3 sm:p-4 text-xs sm:text-sm font-bold text-white cursor-pointer list-none flex items-center justify-between",children:["5-Touch Strategy Timeline",a.jsx("span",{className:"text-gray-500 text-xs",children:"tap to expand"})]}),a.jsxs("div",{className:"px-3 sm:px-4 pb-3 sm:pb-4 space-y-2 text-xs sm:text-sm",children:[Z.map((l,x)=>a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-gray-400",children:[a.jsxs("span",{className:"font-mono text-[10px] sm:text-xs bg-gray-700 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded",children:["T",l.touch]}),a.jsx("span",{className:"flex-1 text-xs sm:text-sm",children:l.name}),a.jsx("span",{className:"text-[10px] sm:text-xs",children:x===0?"Initial":`+${l.daysAfterPrevious} days`})]},l.touch)),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700 text-[10px] sm:text-xs text-gray-500",children:"üí° Research shows 80% of sales happen between Touch 5-12. Don't give up early!"})]})]})]})}const H=["#ef4444","#f59e0b","#3b82f6"],I={new:"#6b7280",contacted:"#3b82f6",meeting:"#8b5cf6",proposal:"#eab308",negotiating:"#f97316",signed:"#10b981"};function ta(){const t=nt(),[e,s]=c.useState(null),[r,n]=c.useState([]),[o,d]=c.useState(!0),[m,v]=c.useState(""),[u,h]=c.useState(""),[f,l]=c.useState("");c.useEffect(()=>{x()},[]);const x=async()=>{d(!0);try{const[i,p]=await Promise.all([lt(),ge()]);s(i),n(p)}catch(i){console.error("Error loading CRM data:",i)}finally{d(!1)}},y=()=>{let i=r;return m&&(i=i.filter(p=>p.tier===parseInt(m))),u&&(i=i.filter(p=>p.sport?.toLowerCase().includes(u.toLowerCase()))),f&&(i=i.filter(p=>p.stage===f)),i};if(o)return a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsx("div",{className:"text-gray-400 text-lg",children:"Loading CRM data..."})});const j=[{name:"New",value:e.stageCounts.new,color:I.new},{name:"Contacted",value:e.stageCounts.contacted,color:I.contacted},{name:"Meeting",value:e.stageCounts.meeting,color:I.meeting},{name:"Proposal",value:e.stageCounts.proposal,color:I.proposal},{name:"Negotiating",value:e.stageCounts.negotiating,color:I.negotiating},{name:"Signed",value:e.stageCounts.signed,color:I.signed}],P=[{name:"Tier 1",value:e.tierCounts[1]||0,color:H[0]},{name:"Tier 2",value:e.tierCounts[2]||0,color:H[1]},{name:"Tier 3",value:e.tierCounts[3]||0,color:H[2]}].filter(i=>i.value>0);return a.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4 mb-6 sm:mb-8",children:[a.jsxs("h1",{className:"text-2xl sm:text-3xl font-black text-white tracking-tight",children:[a.jsx("span",{className:"text-red-500",children:"CRM"})," DASHBOARD"]}),a.jsxs("div",{className:"flex gap-2 sm:gap-3 w-full sm:w-auto",children:[a.jsxs("button",{onClick:x,className:"bg-gray-700 hover:bg-gray-600 text-white px-3 sm:px-4 py-2 rounded-lg font-medium transition-all flex items-center justify-center gap-2 text-xs sm:text-sm flex-1 sm:flex-none",children:[a.jsx(ot,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),"Refresh"]}),a.jsx("button",{onClick:()=>t("/portal/pipeline/board"),className:"bg-red-600 hover:bg-red-700 text-white px-4 sm:px-6 py-2 rounded-lg font-bold transition-all hover:scale-105 text-xs sm:text-sm flex-1 sm:flex-none whitespace-nowrap",children:"View Pipeline Board"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 mb-6 sm:mb-8",children:[a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[a.jsx(Qe,{size:16,className:"text-gray-500 sm:w-5 sm:h-5"}),a.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Total Leads"})]}),a.jsx("div",{className:"text-2xl sm:text-3xl font-black text-white",children:e.totalLeads})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[a.jsx(Xe,{size:16,className:"text-pink-500 sm:w-5 sm:h-5"}),a.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Conversion"})]}),a.jsxs("div",{className:"text-2xl sm:text-3xl font-black text-pink-500",children:[e.conversionRate,"%"]})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[a.jsx(pe,{size:16,className:"text-purple-500 sm:w-5 sm:h-5"}),a.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Meetings"})]}),a.jsx("div",{className:"text-2xl sm:text-3xl font-black text-purple-500",children:e.meetingsThisWeek})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[a.jsx(Ye,{size:16,className:"text-red-400 sm:w-5 sm:h-5"}),a.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Pipeline"})]}),a.jsxs("div",{className:"text-2xl sm:text-3xl font-black text-red-400",children:["$",(e.pipelineValue/1e3).toFixed(0),"K"]})]})]}),a.jsx("div",{className:"mb-6 sm:mb-8",children:a.jsx(qt,{})}),a.jsxs("div",{className:"hidden sm:grid md:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[a.jsxs("div",{className:"md:col-span-2 bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50",children:[a.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Pipeline Funnel"}),a.jsx(ae,{width:"100%",height:200,children:a.jsxs(et,{data:j,layout:"vertical",children:[a.jsx(tt,{type:"number",stroke:"#6b7280"}),a.jsx(at,{dataKey:"name",type:"category",stroke:"#6b7280",width:80,tick:{fontSize:12}}),a.jsx(st,{dataKey:"value",radius:[0,8,8,0],children:j.map((i,p)=>a.jsx(z,{fill:i.color},`cell-${p}`))})]})})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50",children:[a.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Leads by Tier"}),a.jsx(ae,{width:"100%",height:200,children:a.jsx(Vt,{children:a.jsx(fe,{data:P,cx:"50%",cy:"50%",innerRadius:50,outerRadius:75,dataKey:"value",label:i=>`${i.name}: ${i.value}`,children:P.map((i,p)=>a.jsx(z,{fill:i.color},`cell-${p}`))})})})]})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50 mb-4 sm:mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[a.jsx(rt,{size:16,className:"text-gray-500 sm:w-5 sm:h-5"}),a.jsx("h3",{className:"text-base sm:text-lg font-bold text-white",children:"Quick Filters"})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:[a.jsxs("select",{value:m,onChange:i=>v(i.target.value),className:"px-3 sm:px-4 py-2 sm:py-3 bg-[#12122a] border border-gray-800/50 rounded-lg sm:rounded-xl text-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40",children:[a.jsx("option",{value:"",children:"All Tiers"}),a.jsx("option",{value:"1",children:"Tier 1"}),a.jsx("option",{value:"2",children:"Tier 2"}),a.jsx("option",{value:"3",children:"Tier 3"})]}),a.jsxs("select",{value:f,onChange:i=>l(i.target.value),className:"px-3 sm:px-4 py-2 sm:py-3 bg-[#12122a] border border-gray-800/50 rounded-lg sm:rounded-xl text-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"new",children:"New"}),a.jsx("option",{value:"contacted",children:"Contacted"}),a.jsx("option",{value:"meeting",children:"Meeting Booked"}),a.jsx("option",{value:"proposal",children:"Proposal Sent"}),a.jsx("option",{value:"negotiating",children:"Negotiating"}),a.jsx("option",{value:"signed",children:"Signed"}),a.jsx("option",{value:"lost",children:"Lost"})]}),a.jsx("input",{type:"text",value:u,onChange:i=>h(i.target.value),placeholder:"Filter by sport...",className:"col-span-2 sm:col-span-1 px-3 sm:px-4 py-2 sm:py-3 bg-[#12122a] border border-gray-800/50 rounded-lg sm:rounded-xl text-white placeholder-gray-600 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40"})]}),(m||u||f)&&a.jsx("div",{className:"mt-3 sm:mt-4",children:a.jsxs("div",{className:"text-xs sm:text-sm text-gray-400",children:["Showing ",y().length," of ",e.totalLeads," leads"]})})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50 mb-4 sm:mb-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Recent Activity"}),e.recentActivities.length===0?a.jsx("div",{className:"text-gray-500 text-center py-6 sm:py-8 text-sm",children:"No recent activity"}):a.jsx("div",{className:"space-y-2 sm:space-y-3",children:e.recentActivities.map(i=>a.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 p-3 sm:p-4 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-gray-700 transition-all",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-red-600/20 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-red-400 text-base sm:text-xl",children:i.type==="Phone Call"?"üìû":i.type==="Email"?"üìß":i.type==="Meeting"?"ü§ù":"üìù"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[a.jsx("span",{className:"font-bold text-white text-sm sm:text-base",children:i.lead_name}),a.jsx("span",{className:"text-gray-600",children:"‚Ä¢"}),a.jsx("span",{className:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase",children:i.type})]}),a.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mb-1 line-clamp-2",children:i.notes}),a.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600",children:new Date(i.created_at).toLocaleDateString("en-AU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]},i.id))})]}),a.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50",children:[a.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Follow-up Reminders"}),a.jsxs("div",{className:"text-gray-500 text-center py-6 sm:py-8 text-sm",children:["No pending follow-ups",a.jsx("div",{className:"text-xs sm:text-sm mt-2",children:"Add activities with due dates to see reminders here"})]})]})]})}export{ta as default};
