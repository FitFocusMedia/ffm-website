const a={PROFILES:"ffm_athlete_profiles",EVENTS:"ffm_athlete_events",CONTENT:"ffm_athlete_content",ACCESS:"ffm_athlete_access"},c=t=>{try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(e){return console.error(`Error reading ${t}:`,e),[]}},g=(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(n){console.error(`Error writing ${t}:`,n)}},_=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,u=t=>{const e=c(a.PROFILES),n={id:_(),name:t.name,email:t.email,sport:t.sport||"",gym:t.gym||"",created_at:new Date().toISOString()};return e.push(n),g(a.PROFILES,e),n},E=()=>c(a.PROFILES),S=()=>c(a.EVENTS).sort((t,e)=>new Date(e.date)-new Date(t.date)),p=t=>c(a.EVENTS).find(n=>n.id===t),f=t=>{const e=c(a.EVENTS),n={id:_(),name:t.name,date:t.date,venue:t.venue||"",org_name:t.org_name||"",created_at:new Date().toISOString()};return e.push(n),g(a.EVENTS,e),n},h=t=>{const e=c(a.ACCESS),n=c(a.EVENTS),s=e.filter(o=>o.athlete_id===t),r=[...new Set(s.map(o=>o.event_id))];return n.filter(o=>r.includes(o.id)).map(o=>{const l=s.find(d=>d.event_id===o.id);return{...o,package_type:l?.package_type||"match",granted_at:l?.granted_at}}).sort((o,l)=>new Date(l.date)-new Date(o.date))},m=(t,e)=>{const n=c(a.CONTENT);return c(a.ACCESS).some(o=>o.athlete_id===t&&o.event_id===e)?n.filter(o=>o.athlete_id===t&&o.event_id===e).sort((o,l)=>new Date(l.created_at)-new Date(o.created_at)):[]},v=t=>c(a.CONTENT).filter(n=>n.athlete_id===t).sort((n,s)=>new Date(s.created_at)-new Date(n.created_at)),C=t=>{const e=c(a.CONTENT),n=h(t),s=e.filter(d=>d.athlete_id===t),r=s.filter(d=>d.type==="photo"),o=s.filter(d=>d.type==="video"),l=n.length>0?n[0].package_type:null;return{totalEvents:n.length,totalPhotos:r.length,totalVideos:o.length,activePackage:l}},A=(t,e,n,s)=>{const r=c(a.CONTENT),o=c(a.ACCESS),l=n.map(i=>({id:_(),athlete_id:t,event_id:e,type:i.type,title:i.title||"",drive_url:i.drive_url,thumbnail_url:i.thumbnail_url||i.drive_url,package_type:s,duration:i.duration||null,created_at:new Date().toISOString()}));return r.push(...l),g(a.CONTENT,r),o.find(i=>i.athlete_id===t&&i.event_id===e)||(o.push({athlete_id:t,event_id:e,package_type:s,granted_at:new Date().toISOString()}),g(a.ACCESS,o)),l},N=t=>c(a.CONTENT).filter(n=>n.event_id===t),w=t=>{const n=c(a.CONTENT).filter(r=>r.athlete_id===t),s=h(t);return{totalEvents:s.length,totalPhotos:n.filter(r=>r.type==="photo").length,totalVideos:n.filter(r=>r.type==="video").length,packages:s.map(r=>r.package_type)}},y=t=>({vip:"VIP Package",match:"Match Package",season:"Season Pass"})[t]||t,T=t=>({vip:"from-yellow-500/20 to-amber-600/20 border-yellow-500/30",match:"from-blue-500/20 to-cyan-600/20 border-blue-500/30",season:"from-purple-500/20 to-pink-600/20 border-purple-500/30"})[t]||"from-gray-500/20 to-gray-600/20 border-gray-500/30",O=t=>new Date(t).toLocaleDateString("en-AU",{year:"numeric",month:"long",day:"numeric"}),P=t=>{const e=[/\/file\/d\/([a-zA-Z0-9_-]+)/,/id=([a-zA-Z0-9_-]+)/,/\/d\/([a-zA-Z0-9_-]+)/];for(const n of e){const s=t.match(n);if(s)return`https://drive.google.com/uc?export=download&id=${s[1]}`}return t};export{v as a,C as b,u as c,y as d,T as e,O as f,h as g,p as h,m as i,P as j,E as k,S as l,w as m,N as n,A as o,f as p};
