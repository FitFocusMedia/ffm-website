import{c as I,j as e,aX as Z,aY as J,aZ as K,I as Q,P as ee,a_ as te,O as ae,a$ as se,b0 as re,b1 as le,b2 as ne}from"./index-Cgv4WUQW.js";import{b as h,h as ie}from"./vendor-react-q0iRXJvs.js";import{E as z}from"./external-link-CX7bbSgg.js";import{F as oe}from"./file-text-Dr2E0S34.js";import{A as ce}from"./archive-HA2zXGF2.js";import"./vendor-supabase-DhDedaeW.js";const de=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],R=I("file",de);const xe=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],ge=I("music",xe),L=[{id:"branding",category:"Branding & Assets",icon:"âœ¨",items:[{id:"logo",label:"High-resolution logo",type:"file",priority:"essential"},{id:"brand_kit",label:"Brand kit (colors, fonts, guidelines)",type:"file",priority:"important"},{id:"event_graphics",label:"Event-specific graphics/banners",type:"file",priority:"important"},{id:"sponsor_logos",label:"Sponsor logos for on-screen display",type:"file",priority:"nice"}]},{id:"athletes",category:"Athlete Information",icon:"ðŸ‘¥",items:[{id:"registration_list",label:"Registration list (Name, Email, Phone, Instagram)",type:"file",priority:"essential"},{id:"notable_athletes",label:"Notable athletes to feature",type:"textarea",priority:"important"}]},{id:"venue",category:"Venue & Technical",icon:"ðŸ“",items:[{id:"floor_plan",label:"Venue floor plan (mat layout)",type:"file",priority:"essential"},{id:"internet_specs",label:"Internet specs (upload speed, hardwired access)",type:"textarea",priority:"essential"},{id:"power_locations",label:"Power outlet locations",type:"textarea",priority:"important"},{id:"load_in_time",label:"Load-in/crew access time",type:"text",priority:"important"},{id:"venue_contact",label:"Venue contact for event day",type:"contact",priority:"important"}]},{id:"event",category:"Event Operations",icon:"ðŸ“…",items:[{id:"mat_count",label:"Number of mats running",type:"number",priority:"essential"},{id:"schedule",label:"Event schedule/run sheet",type:"file",priority:"essential"},{id:"bracket_system",label:"Bracket/scoring system used",type:"text",priority:"important"},{id:"match_comms_method",label:"How match order will be communicated",type:"textarea",priority:"important"}]},{id:"social",category:"Social & Promotion",icon:"ðŸ“¸",items:[{id:"org_instagram",label:"Organization Instagram",type:"text",priority:"important"},{id:"org_facebook",label:"Organization Facebook",type:"text",priority:"nice"},{id:"org_website",label:"Organization Website",type:"text",priority:"nice"},{id:"existing_content",label:"Existing footage/photos for promos",type:"file",priority:"nice"},{id:"existing_content_links",label:"Links to existing footage (Google Drive, Dropbox, etc.)",type:"textarea",priority:"nice"}]}];function pe({session:i,onClose:g,onSave:u}){const[f,v]=h.useState("checklist"),[E,D]=h.useState(!1),[_,O]=h.useState({}),[o,$]=h.useState({}),[n,x]=h.useState({}),[p,k]=h.useState({});h.useEffect(()=>{if(!i)return;const a={};L.forEach(l=>{a[l.id]={},l.items.forEach(s=>{const c=i.checklist_config?.[l.id]?.[s.id]||{};a[l.id][s.id]={enabled:c.enabled!==!1,priority:c.priority||s.priority,alreadyHave:c.alreadyHave||!1}})}),O(a),$(i.collected_data||{}),x(i.admin_item_notes||{}),k(i.manual_completions||{})},[i]);const y=(a,l)=>{O(s=>({...s,[a]:{...s[a],[l]:{...s[a][l],enabled:!s[a][l].enabled}}}))},P=(a,l)=>{O(s=>({...s,[a]:{...s[a],[l]:{...s[a][l],alreadyHave:!s[a][l].alreadyHave}}}))},j=(a,l,s)=>{O(c=>({...c,[a]:{...c[a],[l]:{...c[a][l],priority:s}}}))},C=(a,l,s)=>{x(c=>({...c,[`${a}.${l}`]:s}))},F=(a,l)=>{const s=`${a}.${l}`;k(c=>({...c,[s]:!c[s]}))},N=(a,l,s)=>{$(c=>({...c,[a]:{...c[a]||{},[l]:s}}))},r=async()=>{D(!0);try{const a={checklist_config:_,collected_data:o,admin_item_notes:n,manual_completions:p};await Z(i.id,a),u&&u(a),g()}catch(a){console.error("Error saving:",a),alert("Failed to save changes: "+a.message)}finally{D(!1)}},m=(a,l)=>{const s=o[a]||{},c=s[l]||s[`${l}_url`],S=p[`${a}.${l}`],b=_[a]?.[l]?.alreadyHave;return S?{status:"manual",label:"Manually Complete",color:"blue"}:c?{status:"complete",label:"Client Provided",color:"green"}:b?{status:"already",label:"Already Have",color:"purple"}:{status:"pending",label:"Pending",color:"gray"}};return i?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",onClick:g,children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl w-full max-w-5xl my-8 border border-gray-700 shadow-2xl",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Edit Session"}),e.jsx("p",{className:"text-gray-400",children:i.org_name})]}),e.jsx("button",{onClick:g,className:"text-gray-500 hover:text-white text-xl",children:"âœ•"})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("div",{className:"flex gap-1 px-6",children:[{id:"checklist",label:"Checklist Config",icon:"âš™ï¸"},{id:"data",label:"Collected Data",icon:"ðŸ“"}].map(a=>e.jsxs("button",{onClick:()=>v(a.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 ${f===a.id?"border-orange-500 text-white":"border-transparent text-gray-500 hover:text-white"}`,children:[e.jsx("span",{children:a.icon})," ",a.label]},a.id))})}),e.jsxs("div",{className:"p-6 max-h-[600px] overflow-y-auto",children:[f==="checklist"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"ðŸ’¡ What this does:"}),' Configure what items the client sees, set priorities, mark items as "already have", and add internal notes for your team.']})}),L.map(a=>e.jsxs("div",{className:"bg-gray-900/50 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-700 bg-gray-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsx("h3",{className:"font-bold text-white",children:a.category})]})}),e.jsx("div",{className:"p-4 space-y-4",children:a.items.map(l=>{const s=_[a.id]?.[l.id]||{},c=m(a.id,l.id),S=n[`${a.id}.${l.id}`]||"";return e.jsx("div",{className:`p-4 rounded-lg border transition-all ${s.enabled?"bg-gray-800/50 border-gray-700":"bg-gray-900/30 border-gray-800 opacity-60"}`,children:e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("button",{onClick:()=>y(a.id,l.id),className:`flex-shrink-0 w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${s.enabled?"bg-orange-500 border-orange-500":"bg-transparent border-gray-600"}`,children:s.enabled&&e.jsx("span",{className:"text-white text-sm",children:"âœ“"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-medium ${s.enabled?"text-white":"text-gray-500"}`,children:l.label}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full bg-${c.color}-500/20 text-${c.color}-400 border border-${c.color}-500/30`,children:c.label})]}),s.enabled&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:s.priority,onChange:b=>j(a.id,l.id,b.target.value),className:"text-xs bg-gray-900 border border-gray-700 rounded px-2 py-1 text-white focus:outline-none focus:border-orange-500",children:[e.jsx("option",{value:"essential",children:"Essential"}),e.jsx("option",{value:"important",children:"Important"}),e.jsx("option",{value:"nice",children:"Nice to have"})]}),e.jsx("button",{onClick:()=>P(a.id,l.id),className:`text-xs px-3 py-1 rounded border transition-colors ${s.alreadyHave?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-gray-900 text-gray-400 border-gray-700"}`,children:s.alreadyHave?"âœ“ Already Have":'Mark "Already Have"'}),e.jsx("button",{onClick:()=>F(a.id,l.id),className:`text-xs px-3 py-1 rounded border transition-colors ${p[`${a.id}.${l.id}`]?"bg-blue-500/20 text-blue-400 border-blue-500/30":"bg-gray-900 text-gray-400 border-gray-700"}`,children:p[`${a.id}.${l.id}`]?"âœ“ Manually Complete":"Mark Complete"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Internal Note (not visible to client)"}),e.jsx("textarea",{value:S,onChange:b=>C(a.id,l.id,b.target.value),placeholder:"e.g., Client sent logo via email - see Drive folder",rows:2,className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500 resize-none"})]})]})]})]})},l.id)})})]},a.id))]}),f==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-yellow-200 text-sm",children:[e.jsx("strong",{children:"âš ï¸ Caution:"})," You're editing data the client submitted. Only modify if you need to correct errors or add information on their behalf."]})}),L.map(a=>{const l=o[a.id]||{};return e.jsxs("div",{className:"bg-gray-900/50 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-700 bg-gray-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsx("h3",{className:"font-bold text-white",children:a.category})]})}),e.jsx("div",{className:"p-4 space-y-4",children:a.items.filter(s=>_[a.id]?.[s.id]?.enabled!==!1).map(s=>{const c=l[s.id]||"",S=l[`${s.id}_url`]||"";return e.jsxs("div",{className:"p-3 rounded-lg bg-gray-800/50 border border-gray-700",children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:s.label}),s.type==="file"&&e.jsxs("div",{children:[e.jsx("input",{type:"text",value:S,onChange:b=>N(a.id,`${s.id}_url`,b.target.value),placeholder:"File URL (if uploaded)",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),S&&e.jsx("a",{href:S,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-orange-500 hover:underline mt-1 inline-block",children:"View uploaded file â†’"})]}),s.type==="text"&&e.jsx("input",{type:"text",value:c,onChange:b=>N(a.id,s.id,b.target.value),placeholder:s.placeholder||"",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),s.type==="number"&&e.jsx("input",{type:"number",value:c,onChange:b=>N(a.id,s.id,b.target.value),placeholder:s.placeholder||"",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),s.type==="textarea"&&e.jsx("textarea",{value:c,onChange:b=>N(a.id,s.id,b.target.value),placeholder:s.placeholder||"",rows:3,className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500 resize-none"}),s.type==="contact"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:l[`${s.id}_name`]||"",onChange:b=>N(a.id,`${s.id}_name`,b.target.value),placeholder:"Contact name",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),e.jsx("input",{type:"tel",value:l[`${s.id}_phone`]||"",onChange:b=>N(a.id,`${s.id}_phone`,b.target.value),placeholder:"Phone number",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),e.jsx("input",{type:"email",value:l[`${s.id}_email`]||"",onChange:b=>N(a.id,`${s.id}_email`,b.target.value),placeholder:"Email address",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"})]})]},s.id)})})]},a.id)})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:g,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:r,disabled:E,className:"px-6 py-2 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):e.jsx(e.Fragment,{children:"ðŸ’¾ Save Changes"})})]})]})}):null}const B=[{id:"branding",category:"Branding & Assets",icon:"âœ¨",items:[{id:"logo",label:"High-resolution logo",type:"file"},{id:"brand_kit",label:"Brand kit (colors, fonts, guidelines)",type:"file"},{id:"event_graphics",label:"Event-specific graphics/banners",type:"file"},{id:"sponsor_logos",label:"Sponsor logos for on-screen display",type:"file"}]},{id:"athletes",category:"Athlete Information",icon:"ðŸ‘¥",items:[{id:"registration_list",label:"Registration list",type:"file"},{id:"notable_athletes",label:"Notable athletes to feature",type:"textarea"}]},{id:"venue",category:"Venue & Technical",icon:"ðŸ“",items:[{id:"floor_plan",label:"Venue floor plan",type:"file"},{id:"internet_specs",label:"Internet specs",type:"textarea"},{id:"power_locations",label:"Power outlet locations",type:"textarea"},{id:"load_in_time",label:"Load-in/crew access time",type:"text"},{id:"venue_contact",label:"Venue contact for event day",type:"contact"}]},{id:"event",category:"Event Operations",icon:"ðŸ“…",items:[{id:"mat_count",label:"Number of mats running",type:"number"},{id:"schedule",label:"Event schedule/run sheet",type:"file"},{id:"bracket_system",label:"Bracket/scoring system used",type:"text"},{id:"match_comms_method",label:"How match order will be communicated",type:"textarea"}]},{id:"social",category:"Social & Promotion",icon:"ðŸ“¸",items:[{id:"org_instagram",label:"Organization Instagram",type:"text"},{id:"org_facebook",label:"Organization Facebook",type:"text"},{id:"org_website",label:"Organization Website",type:"text"},{id:"existing_content",label:"Existing footage/photos for promos",type:"file"},{id:"existing_content_links",label:"Links to existing footage",type:"textarea"}]}],me=i=>{if(!i)return{icon:R,type:"file",isImage:!1};const g=i.toLowerCase();return g.match(/\.(jpg|jpeg|png|gif|webp|svg|bmp)(\?|$)/i)?{icon:Q,type:"image",isImage:!0}:g.match(/\.(mp4|mov|avi|webm|mkv)(\?|$)/i)?{icon:ee,type:"video",isImage:!1}:g.match(/\.(mp3|wav|aac|ogg|m4a)(\?|$)/i)?{icon:ge,type:"audio",isImage:!1}:g.match(/\.(pdf|doc|docx|xls|xlsx|ppt|pptx|txt|csv)(\?|$)/i)?{icon:oe,type:"document",isImage:!1}:g.match(/\.(zip|rar|7z|tar|gz)(\?|$)/i)?{icon:ce,type:"archive",isImage:!1}:{icon:R,type:"file",isImage:!1}},he=i=>{if(!i)return"File";try{const f=new URL(i).pathname.split("/").pop(),v=decodeURIComponent(f);return v.length>40?v.substring(0,37)+"...":v}catch{return"File"}};function be({url:i,label:g}){const{icon:u,type:f,isImage:v}=me(i),E=he(i);return e.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"group block",children:e.jsxs("div",{className:"border border-gray-700 rounded-xl overflow-hidden hover:border-orange-500/50 transition-all",children:[e.jsxs("div",{className:"bg-gray-900 aspect-video flex items-center justify-center relative overflow-hidden",children:[v?e.jsx("img",{src:i,alt:g,className:"w-full h-full object-cover group-hover:scale-105 transition-transform",onError:D=>{D.target.style.display="none",D.target.nextSibling.style.display="flex"}}):null,e.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${v?"hidden":""}`,style:v?{display:"none"}:{},children:[e.jsx(u,{size:48,className:"mb-2"}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:f})]}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:e.jsx("div",{className:"bg-orange-500 text-white p-2 rounded-full",children:e.jsx(z,{size:20})})})]}),e.jsxs("div",{className:"p-3 bg-gray-800",children:[e.jsx("p",{className:"text-sm text-white truncate",children:E}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:g})]})]})})}function ue({value:i,isUrl:g}){return i?Array.isArray(i)?i.length===0?e.jsx("span",{className:"text-gray-500 italic",children:"No links provided"}):e.jsx("div",{className:"space-y-1",children:i.map((u,f)=>e.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 break-all flex items-center gap-1 block",children:["ðŸ”— ",u.includes("drive.google")?"Google Drive":u.includes("dropbox")?"Dropbox":"External"," link",e.jsx(z,{size:14})]},f))}):g||i.startsWith("http://")||i.startsWith("https://")?e.jsxs("a",{href:i.startsWith("http")?i:`https://${i}`,target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 hover:text-orange-400 break-all flex items-center gap-1",children:[i,e.jsx(z,{size:14})]}):i.includes(`
`)?e.jsx("p",{className:"text-white whitespace-pre-wrap",children:i}):e.jsx("span",{className:"text-white",children:i}):e.jsx("span",{className:"text-gray-500 italic",children:"Not provided"})}function ye({data:i,itemId:g}){const u=i[`${g}_name`],f=i[`${g}_phone`],v=i[`${g}_email`];return!u&&!f&&!v?e.jsx("span",{className:"text-gray-500 italic",children:"Not provided"}):e.jsxs("div",{className:"space-y-1",children:[u&&e.jsx("p",{className:"text-white font-medium",children:u}),f&&e.jsxs("a",{href:`tel:${f}`,className:"text-orange-500 hover:text-orange-400 block",children:["ðŸ“ž ",f]}),v&&e.jsxs("a",{href:`mailto:${v}`,className:"text-orange-500 hover:text-orange-400 block",children:["âœ‰ï¸ ",v]})]})}function fe({data:i,files:g=[],checklistConfig:u}){const[f,v]=h.useState(new Set(B.map(n=>n.id))),E=u||B,D=(n,x)=>{const p=E.find(y=>y.id===n);return p&&p.items.find(y=>y.id===x)?.label||null},_={};for(const n of g){if(!n.category)continue;_[n.category]||(_[n.category]=[]);const x=D(n.category,n.file_type);_[n.category].push({id:n.file_type||n.id,label:x||n.file_type||"Uploaded file",url:n.drive_file_url||n.public_url,fileName:n.file_name,mimeType:n.mime_type})}const O=n=>{v(x=>{const p=new Set(x);return p.has(n)?p.delete(n):p.add(n),p})},o=n=>{if(_[n]?.length>0)return!0;const x=i?.[n];return x?Object.values(x).some(p=>p&&p!==""):!1},$=n=>{const x=i?.[n.id]||{},p=_[n.id]||[];let k=0,y=n.items.length;const P=new Set(p.map(j=>j.id));return n.items.forEach(j=>{if(j.type==="file")(P.has(j.id)||x[`${j.id}_url`])&&k++;else if(j.type==="contact")(x[`${j.id}_name`]||x[`${j.id}_phone`]||x[`${j.id}_email`])&&k++;else{const C=x[j.id];C&&C!==""&&k++}}),{completed:k,total:y}};return!i||Object.keys(i).length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No information collected yet"})}):e.jsx("div",{className:"space-y-4",children:E.map(n=>{const x=i[n.id]||{},p=f.has(n.id),k=o(n.id),y=$(n),P=_[n.id]||[],j=new Set(P.map(r=>r.id)),C=n.items.filter(r=>r.type==="file").filter(r=>!j.has(r.id)).map(r=>({...r,url:x[`${r.id}_url`]||x[r.id]})).filter(r=>r.url&&r.url.startsWith("http")),F=[...P,...C],N=n.items.filter(r=>r.type!=="file");return e.jsxs("div",{className:`border rounded-xl overflow-hidden transition-colors ${k?"border-gray-700 bg-gray-800/50":"border-gray-800 bg-gray-900/30"}`,children:[e.jsxs("button",{onClick:()=>O(n.id),className:"w-full flex items-center justify-between p-4 hover:bg-gray-700/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:n.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-white",children:n.category}),e.jsxs("p",{className:"text-xs text-gray-500",children:[y.completed,"/",y.total," items provided"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[y.completed===y.total?e.jsx("span",{className:"text-green-400 text-sm",children:"âœ“ Complete"}):y.completed>0?e.jsxs("span",{className:"text-yellow-400 text-sm",children:[y.completed,"/",y.total]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"Empty"}),p?e.jsx(J,{size:20,className:"text-gray-400"}):e.jsx(K,{size:20,className:"text-gray-400"})]})]}),p&&e.jsxs("div",{className:"border-t border-gray-700 p-4",children:[F.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:["Files (",F.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:F.map((r,m)=>e.jsx(be,{url:r.url,label:r.label||r.fileName||"Uploaded file"},r.id||m))})]}),N.length>0&&e.jsxs("div",{className:F.length>0?"mt-4 pt-4 border-t border-gray-700":"",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:"Details"}),e.jsx("div",{className:"space-y-4",children:N.map(r=>{const m=x[r.id],a=r.type==="contact"?x[`${r.id}_name`]||x[`${r.id}_phone`]||x[`${r.id}_email`]:m&&m!=="";return e.jsxs("div",{className:`${a?"":"opacity-50"}`,children:[e.jsx("label",{className:"text-sm text-gray-400 block mb-1",children:r.label}),r.type==="contact"?e.jsx(ye,{data:x,itemId:r.id}):e.jsx(ue,{value:m,isUrl:r.id.includes("website")||r.id.includes("facebook")||r.id.includes("instagram")})]},r.id)})})]}),Object.entries(x).filter(([r,m])=>r.endsWith("_links")&&Array.isArray(m)&&m.length>0).length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:"External Links"}),e.jsx("div",{className:"space-y-4",children:Object.entries(x).filter(([r,m])=>r.endsWith("_links")&&Array.isArray(m)&&m.length>0).map(([r,m])=>{const a=r.replace(/_links$/,""),s=n.items.find(c=>c.id===a)?.label||a.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-1",children:[s," (external links)"]}),e.jsx("div",{className:"space-y-1",children:m.map((c,S)=>e.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 break-all flex items-center gap-2 p-2 bg-blue-500/10 rounded-lg text-sm",children:[e.jsx("span",{children:"ðŸ”—"}),e.jsxs("span",{className:"flex-1 truncate",children:[c.includes("drive.google")?"Google Drive":c.includes("dropbox")?"Dropbox":"External"," link"]}),e.jsx(z,{size:14})]},S))})]},r)})})]}),F.length===0&&N.every(r=>{const m=x[r.id];return r.type==="contact"?!(x[`${r.id}_name`]||x[`${r.id}_phone`]||x[`${r.id}_email`]):!m||m===""})&&e.jsx("p",{className:"text-gray-500 text-center py-4 italic",children:"No information provided for this category"})]})]},n.id)})})}function Ce(){const i=ie(),[g,u]=h.useState([]),[f,v]=h.useState([]),[E,D]=h.useState(!0),[_,O]=h.useState(null),[o,$]=h.useState(null),[n,x]=h.useState([]),[p,k]=h.useState("all"),[y,P]=h.useState(""),[j,C]=h.useState(!1),[F,N]=h.useState(!1),[r,m]=h.useState(!1),[a,l]=h.useState(!1),[s,c]=h.useState({org_name:"",contact_name:"",contact_email:"",contact_phone:"",event_name:"",event_date:"",event_location:""});h.useEffect(()=>{S()},[]);const S=async()=>{try{const[t,d]=await Promise.all([te(),ae()]);u(t||[]),v(d||[])}catch(t){O(t.message)}finally{D(!1)}},b=async t=>{t.preventDefault(),l(!0);try{const d=await se(s);u(w=>[d,...w]),C(!1),c({org_name:"",contact_name:"",contact_email:"",contact_phone:"",event_name:"",event_date:"",event_location:""})}catch(d){alert("Error: "+d.message)}finally{l(!1)}},U=async t=>{try{await re(t,"Brandon Hibbs"),await S(),$(null)}catch(d){alert("Error: "+d.message)}},W=async t=>{if(confirm("Are you sure you want to delete this onboarding session? This cannot be undone."))try{await le(t),u(d=>d.filter(w=>w.id!==t)),$(null)}catch(d){alert("Error deleting session: "+d.message)}},G=t=>{u(d=>d.map(w=>w.id===o.id?{...w,...t}:w)),$(d=>({...d,...t})),m(!1)},q=async t=>{$(t);try{const d=await ne(t.id);x(d||[])}catch(d){console.error("Error fetching files:",d),x([])}},M=t=>{const d={pending:"bg-yellow-500/20 text-yellow-400",in_progress:"bg-blue-500/20 text-blue-400",submitted:"bg-green-500/20 text-green-400",reviewed:"bg-purple-500/20 text-purple-400"},w={pending:"Pending",in_progress:"In Progress",submitted:"Submitted",reviewed:"Reviewed"};return e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${d[t]||d.pending}`,children:w[t]||"Unknown"})},A=t=>{const d=t.checklist_progress||{},w=18,Y=Object.values(d).filter(X=>X).length;return Math.round(Y/w*100)},H=g.filter(t=>!(p!=="all"&&t.status!==p||y&&!t.org_name?.toLowerCase().includes(y.toLowerCase()))),V=t=>`${window.location.origin}/#/onboarding/${t}`,T=f.filter(t=>t.status==="signed");return E?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i("/portal/contracts"),className:"text-gray-400 hover:text-white",children:"â† Back"}),e.jsx("h1",{className:"text-xl font-bold",children:"Partner Onboarding"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2",children:"ðŸ“„ From Contract"}),e.jsx("button",{onClick:()=>C(!0),className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2",children:"âž• New Session"})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:e.jsx("div",{className:"grid grid-cols-4 gap-4",children:[{label:"Total",value:g.length,color:"orange"},{label:"Pending",value:g.filter(t=>t.status==="pending").length,color:"yellow"},{label:"Submitted",value:g.filter(t=>t.status==="submitted").length,color:"green"},{label:"Reviewed",value:g.filter(t=>t.status==="reviewed").length,color:"purple"}].map((t,d)=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:[e.jsx("div",{className:`text-3xl font-bold text-${t.color}-500`,children:t.value}),e.jsx("div",{className:"text-sm text-gray-500",children:t.label})]},d))})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search organizations...",value:y,onChange:t=>P(t.target.value),className:"flex-1 max-w-xs px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:border-orange-500 focus:outline-none"}),e.jsxs("select",{value:p,onChange:t=>k(t.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"reviewed",children:"Reviewed"})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 pb-12",children:H.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-xl p-12 text-center border border-gray-700",children:[e.jsx("div",{className:"text-4xl mb-4",children:"ðŸ“‹"}),e.jsx("p",{className:"text-gray-400",children:"No onboarding sessions found"}),e.jsx("button",{onClick:()=>C(!0),className:"mt-4 bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg text-sm",children:"Create First Session"})]}):e.jsx("div",{className:"space-y-3",children:H.map(t=>e.jsx("div",{onClick:()=>q(t),className:"bg-gray-800 rounded-xl p-5 border border-gray-700 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.org_name}),M(t.status)]}),e.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[t.event_name&&e.jsxs("span",{children:["ðŸ“… ",t.event_name]}),t.contact_name&&e.jsxs("span",{children:["ðŸ‘¤ ",t.contact_name]}),t.event_date&&e.jsxs("span",{children:["ðŸ—“ ",new Date(t.event_date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-500",children:[A(t),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Complete"})]})]})},t.id))})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>$(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-auto border border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:o.org_name}),M(o.status)]}),e.jsx("button",{onClick:()=>$(null),className:"text-gray-500 hover:text-white text-xl",children:"âœ•"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Event Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[o.event_name&&e.jsxs("p",{children:[e.jsx("strong",{children:"Event:"})," ",o.event_name]}),o.event_date&&e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(o.event_date).toLocaleDateString()]}),o.event_location&&e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",o.event_location]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Contact"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[o.contact_name&&e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",o.contact_name]}),o.contact_email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",e.jsx("a",{href:`mailto:${o.contact_email}`,className:"text-orange-500",children:o.contact_email})]}),o.contact_phone&&e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",e.jsx("a",{href:`tel:${o.contact_phone}`,className:"text-orange-500",children:o.contact_phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Progress"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500",style:{width:`${A(o)}%`}})}),e.jsxs("span",{className:"font-bold text-orange-500",children:[A(o),"%"]})]})]}),o.collected_data&&Object.keys(o.collected_data).length>0||n.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:"Collected Information"}),e.jsx(fe,{data:o.collected_data,files:n})]}):null,e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Google Drive Status"}),o.drive_folder_id?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-400",children:"âœ“"}),e.jsx("span",{className:"text-sm",children:"Synced to Google Drive"})]}),(o.shared_with||[]).length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Team access:"}),o.shared_with.map((t,d)=>e.jsxs("span",{className:"text-xs text-gray-400",children:[t.email,d<o.shared_with.length-1?", ":""]},d))]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"â³"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Pending sync (runs every 10 min)"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>m(!0),className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm",children:"âœï¸ Edit Session"}),e.jsx("a",{href:V(o.share_token),target:"_blank",rel:"noopener noreferrer",className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"ðŸ”— View Portal"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(V(o.share_token)),alert("Link copied!")},className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"ðŸ“‹ Copy Link"}),o.drive_folder_id&&e.jsx("a",{href:o.drive_folder_url||`https://drive.google.com/drive/folders/${o.drive_folder_id}`,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"ðŸ“ View Drive Folder"}),o.status==="submitted"&&e.jsx("button",{onClick:()=>U(o.id),className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg text-sm",children:"âœ“ Mark Reviewed"}),e.jsx("button",{onClick:()=>W(o.id),className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm",children:"ðŸ—‘ Delete"})]})]})]})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>C(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-md w-full border border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsx("h2",{className:"text-lg font-bold",children:"Create Onboarding Session"})}),e.jsxs("form",{onSubmit:b,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization Name *"}),e.jsx("input",{required:!0,value:s.org_name,onChange:t=>c({...s,org_name:t.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Name"}),e.jsx("input",{value:s.contact_name,onChange:t=>c({...s,contact_name:t.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Email"}),e.jsx("input",{type:"email",value:s.contact_email,onChange:t=>c({...s,contact_email:t.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{value:s.event_name,onChange:t=>c({...s,event_name:t.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Date"}),e.jsx("input",{type:"date",value:s.event_date,onChange:t=>c({...s,event_date:t.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{value:s.event_location,onChange:t=>c({...s,event_location:t.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"flex-1 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a,className:"flex-1 py-2 bg-orange-500 hover:bg-orange-600 rounded-lg disabled:opacity-50",children:a?"Creating...":"Create"})]})]})]})}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>N(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-md w-full border border-gray-700",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsx("h2",{className:"text-lg font-bold",children:"Create From Signed Contract"})}),e.jsxs("div",{className:"p-6",children:[T.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No signed contracts available"}):e.jsx("div",{className:"space-y-2 max-h-80 overflow-auto",children:T.map(t=>{const d=g.some(w=>w.contract_id===t.id);return e.jsxs("button",{onClick:()=>!d&&i(`/portal/onboarding/new?contractId=${t.id}`),disabled:d,className:`w-full p-4 rounded-xl text-left transition-colors ${d?"bg-gray-700/50 cursor-not-allowed opacity-50":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsx("div",{className:"font-medium",children:t.org_name}),e.jsx("div",{className:"text-sm text-gray-400",children:t.promoter_name}),d&&e.jsx("div",{className:"text-xs text-orange-500 mt-1",children:"Session already exists"})]},t.id)})}),e.jsx("button",{onClick:()=>N(!1),className:"w-full mt-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Close"})]})]})}),r&&o&&e.jsx(pe,{session:o,onClose:()=>m(!1),onSave:G})]})}export{Ce as default};
