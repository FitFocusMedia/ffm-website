import{W as C,j as e,Z as f}from"./index-y3ibYX3b.js";import{f as w,b as r,h as j}from"./vendor-react-q0iRXJvs.js";import{g as v,c as k,a as N,d as i,e as _}from"./contractHelpers-DfGjr2hJ.js";import"./vendor-supabase-DhDedaeW.js";function I(){const{id:s}=w(),[t,d]=r.useState(null),[m,u]=r.useState(!0),o=j();r.useEffect(()=>{x()},[s]);const x=async()=>{try{const a=await C(s);d(a)}catch(a){console.error("Error loading contract:",a),alert("Contract not found"),o("/portal/contracts")}finally{u(!1)}},[c,l]=r.useState(!1),p=async()=>{const a=i(t.share_token);try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a);else{const n=document.createElement("textarea");n.value=a,n.style.position="fixed",n.style.left="-9999px",document.body.appendChild(n),n.focus(),n.select(),document.execCommand("copy"),document.body.removeChild(n)}l(!0),setTimeout(()=>l(!1),3e3)}catch{alert(`Copy this link:

`+a)}},h=()=>{const{subject:a,body:n}=_(t.share_token,t.contract_data?.promoter_name||"there",t.org_name||"Organization"),y=`mailto:${t.contract_data?.promoter_email||""}?subject=${encodeURIComponent(a)}&body=${encodeURIComponent(n)}`;window.open(y,"_blank"),navigator.clipboard.writeText(i(t.share_token)).catch(()=>{})},g=()=>{window.print()},b=async()=>{if(confirm("Are you sure you want to delete this contract? This cannot be undone."))try{await f(t.id),alert("Contract deleted successfully."),o("/portal/contracts")}catch(a){console.error("Error deleting contract:",a),alert("Failed to delete contract: "+a.message)}};return m?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-white text-xl",children:"Loading contract..."})}):t?e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6 print:hidden",children:[e.jsx("button",{onClick:()=>o("/portal/contracts"),className:"text-gray-400 hover:text-white mb-2 inline-flex items-center gap-2",children:"â† Back to Dashboard"}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:t.org_name||"Untitled Contract"}),e.jsx("p",{className:"text-gray-400",children:t.promoter_name||"No promoter name"})]}),e.jsxs("span",{className:k(t.status),children:[v(t.status)," ",t.status]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6 print:hidden",children:[e.jsx("button",{onClick:p,className:`px-4 py-2 ${c?"bg-green-600":"bg-gray-700 hover:bg-gray-600"} text-white rounded-lg transition-colors`,children:c?"âœ… Copied!":"ğŸ“‹ Copy Link"}),t.status!=="signed"&&e.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"ğŸ“§ Send to Client"}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"ğŸ“„ Download PDF"}),t.status!=="signed"&&e.jsx("button",{onClick:()=>o(`/portal/contracts/${t.id}/edit`),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors",children:"âœï¸ Edit Contract"}),e.jsx("button",{onClick:b,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors ml-auto",children:"ğŸ—‘ï¸ Delete"})]}),e.jsx("div",{className:"bg-dark-900 rounded-lg p-8 border border-gray-800",dangerouslySetInnerHTML:{__html:N(t)}})]}):null}export{I as default};
