import{O as E,j as e}from"./index-NbYuVc0-.js";import{b as n,h as k}from"./vendor-react-q0iRXJvs.js";import{g as L}from"./contractHelpers-DfGjr2hJ.js";import"./vendor-supabase-DhDedaeW.js";const M={draft:"bg-gray-700 text-gray-200",sent:"bg-blue-600/20 text-blue-400 border border-blue-500/30",viewed:"bg-yellow-600/20 text-yellow-400 border border-yellow-500/30",signed:"bg-green-600/20 text-green-400 border border-green-500/30",expired:"bg-red-600/20 text-red-400 border border-red-500/30"};function R(){const[o,m]=n.useState([]),[h,f]=n.useState([]),[b,v]=n.useState(!0),[c,j]=n.useState(""),[x,p]=n.useState(""),[u,y]=n.useState("created_desc"),[l,N]=n.useState({total:0,signedThisMonth:0,pending:0,drafts:0,value:0}),g=k();n.useEffect(()=>{w()},[]),n.useEffect(()=>{C()},[o,c,x,u]);const w=async()=>{try{const t=await E();m(t),S(t)}catch(t){console.error("Error loading contracts:",t)}finally{v(!1)}},S=t=>{const r=new Date,a=t.filter(s=>{if(s.status!=="signed")return!1;const i=new Date(s.created_at);return i.getMonth()===r.getMonth()&&i.getFullYear()===r.getFullYear()}),d=t.filter(s=>s.status==="sent"||s.status==="viewed"),_=t.filter(s=>s.status==="draft"),T=t.reduce((s,i)=>{const D=i.contract_data?.vip_price||0,A=i.contract_data?.expected_athletes||0;return s+D*A*.3},0);N({total:t.length,signedThisMonth:a.length,pending:d.length,drafts:_.length,value:Math.round(T)})},C=()=>{let t=[...o];if(c){const r=c.toLowerCase();t=t.filter(a=>(a.org_name||"").toLowerCase().includes(r)||(a.promoter_name||"").toLowerCase().includes(r)||(a.promoter_email||"").toLowerCase().includes(r))}x&&(t=t.filter(r=>r.status===x)),t.sort((r,a)=>{switch(u){case"created_asc":return new Date(r.created_at)-new Date(a.created_at);case"created_desc":return new Date(a.created_at)-new Date(r.created_at);case"org_name":return(r.org_name||"").localeCompare(a.org_name||"");case"status":return(r.status||"").localeCompare(a.status||"");default:return 0}}),f(t)};return b?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"text-gray-400 text-lg",children:"Loading contracts..."})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("h1",{className:"text-3xl font-black text-white tracking-tight",children:[e.jsx("span",{className:"text-red-500",children:"CONTRACT"})," MANAGEMENT"]}),e.jsxs("button",{onClick:()=>g("/portal/contracts/new"),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-bold transition-all hover:scale-105 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"+"})," Create New Contract"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[{label:"TOTAL CONTRACTS",value:l.total,color:"text-white",filter:""},{label:"DRAFTS",value:l.drafts,color:"text-yellow-500",filter:"draft"},{label:"SIGNED THIS MONTH",value:l.signedThisMonth,color:"text-green-500",filter:"signed"},{label:"PENDING SIGNATURES",value:l.pending,color:"text-blue-400",filter:""},{label:"TOTAL VALUE",value:`$${l.value.toLocaleString()}`,color:"text-red-400",filter:""}].map(({label:t,value:r,color:a,filter:d})=>e.jsxs("div",{onClick:()=>d!==void 0&&p(d),className:`bg-[#1a1a2e] rounded-xl p-5 border border-gray-800/50 ${d!==""?"cursor-pointer hover:border-gray-600 transition-colors":""}`,children:[e.jsx("div",{className:"text-[11px] font-bold text-gray-500 tracking-widest uppercase mb-3",children:t}),e.jsx("div",{className:`text-3xl font-black ${a}`,children:r})]},t))}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mb-6",children:[e.jsx("input",{type:"text",value:c,onChange:t=>j(t.target.value),placeholder:"Search by organization name...",className:"flex-1 px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40"}),e.jsxs("select",{value:x,onChange:t=>p(t.target.value),className:"px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40 min-w-[160px]",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"viewed",children:"Viewed"}),e.jsx("option",{value:"signed",children:"Signed"}),e.jsx("option",{value:"expired",children:"Expired"})]}),e.jsxs("select",{value:u,onChange:t=>y(t.target.value),className:"px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40 min-w-[160px]",children:[e.jsx("option",{value:"created_desc",children:"Newest First"}),e.jsx("option",{value:"created_asc",children:"Oldest First"}),e.jsx("option",{value:"org_name",children:"Organization A-Z"}),e.jsx("option",{value:"status",children:"Status"})]})]}),h.length===0?e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-12 text-center border border-gray-800/50",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“„"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:o.length===0?"No Contracts Yet":"No Contracts Found"}),e.jsx("p",{className:"text-gray-500 mb-6",children:o.length===0?"Create your first contract to get started":"Try adjusting your search or filters"}),o.length===0&&e.jsx("button",{onClick:()=>g("/portal/contracts/new"),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-bold transition-all",children:"Create New Contract"})]}):e.jsx("div",{className:"flex flex-col gap-3",children:h.map(t=>{const r=t.contract_data?.event_date?new Date(t.contract_data.event_date).toLocaleDateString("en-AU"):"Not set",a=new Date(t.created_at).toLocaleDateString("en-AU");return e.jsx("div",{onClick:()=>t.status==="draft"?g(`/portal/contracts/${t.id}/edit`):g(`/portal/contracts/${t.id}`),className:`bg-[#1a1a2e] rounded-xl p-5 border-l-4 ${t.status==="draft"?"border-l-yellow-500":"border-l-red-600"} border border-gray-800/50 hover:border-gray-700 cursor-pointer transition-all hover:bg-[#1f1f35] group`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-red-400 transition-colors",children:t.org_name||"Untitled Contract"}),e.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-wider",children:"Promoter"}),e.jsx("div",{className:"text-gray-300",children:t.promoter_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-wider",children:"Event Date"}),e.jsx("div",{className:"text-gray-300",children:r})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-wider",children:"Created"}),e.jsx("div",{className:"text-gray-300",children:a})]})]})]}),e.jsxs("span",{className:`px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider ${M[t.status]||"bg-gray-700 text-gray-300"}`,children:[L(t.status)," ",t.status]})]})},t.id)})})]})}export{R as default};
