import{Y as b,Z as f,j as e,_ as p}from"./index-DHjbTfMz.js";import{f as j,b as a}from"./vendor-react-q0iRXJvs.js";import{g as y,c as v,a as N,h as w,b as S}from"./contractHelpers-DfGjr2hJ.js";import{S as C}from"./SignatureCanvas-DUbzNqGW.js";import"./vendor-supabase-DhDedaeW.js";function F(){const{shareToken:i}=j(),[s,n]=a.useState(null),[c,d]=a.useState(!0),[l,o]=a.useState(!1),[r,m]=a.useState(null);a.useEffect(()=>{g()},[i]);const g=async()=>{try{const t=await b(i);n(t),t.status==="sent"&&!t.viewed_at&&(await f(t.id),n({...t,status:"viewed",viewed_at:new Date().toISOString()}))}catch(t){console.error("Error loading contract:",t),alert("Contract not found")}finally{d(!1)}},u=async()=>{if(!r||!w(r)){alert("Please sign before submitting.");return}if(confirm("By signing, you agree to all terms and conditions in this agreement. This action cannot be undone.")){o(!0);try{const t=S(r),h=await p(s.id,t,!0);n(h),alert("Contract signed successfully! Both parties will receive confirmation.")}catch(t){console.error("Error submitting signature:",t),alert("Failed to submit signature: "+t.message)}finally{o(!1)}}};if(c)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-xl",children:"Loading contract..."})});if(!s)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"❌"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Contract Not Found"}),e.jsx("p",{className:"text-gray-400",children:"This contract link may be invalid or expired."})]})});const x=s.status!=="signed"&&!s.client_signature&&s.ffm_signature;return e.jsxs("div",{className:"min-h-screen bg-dark-950",children:[e.jsx("header",{className:"bg-dark-900 border-b border-gray-800 print:hidden",children:e.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:"Fit Focus Media"}),e.jsx("p",{className:"text-gray-400",children:"Event Media Coverage Agreement"})]}),e.jsxs("span",{className:v(s.status),children:[y(s.status)," ",s.status]})]})})}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-dark-900 rounded-lg p-8 border border-gray-800 mb-8",dangerouslySetInnerHTML:{__html:N(s)}}),x&&e.jsxs("div",{className:"bg-dark-900 rounded-lg p-8 border border-gray-800 print:hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Sign Agreement"}),e.jsx("div",{className:"bg-yellow-900/20 border border-yellow-600 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-yellow-200 text-sm",children:"⚠️ By signing this agreement, you acknowledge that you have read, understood, and agree to all terms and conditions outlined above. This signature is legally binding."})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Your Signature"}),e.jsx(C,{onSignatureChange:t=>m(t)})]}),e.jsx("button",{onClick:u,disabled:l,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition-colors",children:l?"Submitting...":"✓ Accept & Sign Contract"})]}),s.status==="signed"&&e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-6 text-center print:hidden",children:[e.jsx("div",{className:"text-5xl mb-3",children:"✅"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Contract Fully Executed"}),e.jsx("p",{className:"text-gray-300",children:"This contract has been signed by both parties. Both parties will receive confirmation."})]})]})]})}export{F as default};
