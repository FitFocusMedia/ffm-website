import{s as l,j as e,h as je}from"./index-D_mla4Gm.js";import{b as n}from"./vendor-react-q0iRXJvs.js";import"./vendor-supabase-DhDedaeW.js";function fe({event:k,organization:H,onBack:o,onEventUpdate:L}){const[C,ne]=n.useState("details"),[I,K]=n.useState(!0),[u,X]=n.useState(k),[E,Z]=n.useState([]),[M,de]=n.useState([]),[U,ue]=n.useState([]),[j,F]=n.useState([]),[G,T]=n.useState(""),[ee,R]=n.useState(!1),[f,te]=n.useState(""),[q,se]=n.useState("all"),[m,ce]=n.useState("all"),[w,B]=n.useState(!1),[a,d]=n.useState({});n.useEffect(()=>{S()},[k.id]);async function S(){K(!0);const[s,i,x]=await Promise.all([l.from("content_orders").select("*, packages(name)").eq("event_id",k.id).order("created_at",{ascending:!1}),l.from("galleries").select("*, gallery_photos(count)").eq("event_id",k.id),l.from("event_athletes").select("*").eq("event_id",k.id).order("competition_time",{ascending:!0})]);Z(s.data||[]),de(i.data||[]),F(x.data||[]),K(!1)}function ae(s){const i=s.trim().split(`
`).filter(y=>y.trim()),x=[];for(const y of i){const h=y.split("|").map(V=>V.trim());h.length>=1&&x.push({name:h[0]||"",division:h[1]||"",mat:h[2]||"",competition_time:h[3]||"",academy:h[4]||"",event_id:k.id,status:"pending",captured:!1})}return x}async function re(){const s=ae(G);if(s.length===0){alert("No valid athlete data found");return}const{error:i}=await l.from("event_athletes").insert(s);i?alert("Error importing athletes: "+i.message):(R(!1),T(""),S())}async function le(s,i){const{error:x}=await l.from("event_athletes").update({captured:!i,captured_at:i?null:new Date().toISOString()}).eq("id",s);x||F(y=>y.map(h=>h.id===s?{...h,captured:!i}:h))}async function oe(s){if(!confirm("Delete this athlete?"))return;const{error:i}=await l.from("event_athletes").delete().eq("id",s);i||F(x=>x.filter(y=>y.id!==s))}async function W(){if(!confirm("Delete ALL athletes for this event? This cannot be undone."))return;const{error:s}=await l.from("event_athletes").delete().eq("event_id",k.id);s||F([])}async function J(){const{error:s}=await l.from("events").update(a).eq("id",k.id);s?alert("Error saving: "+s.message):(X({...u,...a}),B(!1),L&&L())}const xe=j.filter(s=>{const i=!f||s.name?.toLowerCase().includes(f.toLowerCase())||s.academy?.toLowerCase().includes(f.toLowerCase())||s.division?.toLowerCase().includes(f.toLowerCase()),x=q==="all"||q==="captured"&&s.captured||q==="pending"&&!s.captured||q==="paid"&&E.some(h=>`${h.first_name} ${h.last_name}`.toLowerCase()===s.name?.toLowerCase()||h.email?.toLowerCase()===s.email?.toLowerCase()),y=m==="all"||s.mat===m;return i&&x&&y}),P=[...new Set(j.map(s=>s.mat).filter(Boolean))],O=new Set(E.map(s=>`${s.first_name||""} ${s.last_name||""}`.toLowerCase().trim()).filter(Boolean)),Q=j.filter(s=>O.has(s.name?.toLowerCase())&&!s.captured).sort((s,i)=>s.competition_time&&i.competition_time?s.competition_time.localeCompare(i.competition_time):0),ie=[{id:"details",label:"Details"},{id:"athletes",label:`Athletes (${j.length})`},{id:"runsheet",label:"Run Sheet"},{id:"gallery",label:`Gallery (${M.length})`},{id:"orders",label:`Orders (${E.length})`}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Events"]})}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`px-3 py-1 rounded text-sm ${u.status==="upcoming"?"bg-blue-600":u.status==="active"?"bg-green-600":"bg-gray-600"}`,children:u.status})})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:u.name}),e.jsxs("p",{className:"text-gray-400 mt-1",children:[u.date&&new Date(u.date).toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),u.location&&` â€¢ ${u.location}`]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:H?.name})]}),e.jsx("div",{className:"flex gap-2 border-b border-gray-700 pb-2",children:ie.map(s=>e.jsx("button",{onClick:()=>ne(s.id),className:`px-4 py-2 rounded-t-lg transition-colors ${C===s.id?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:s.label},s.id))}),I?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading..."}):e.jsxs(e.Fragment,{children:[C==="details"&&e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6 space-y-4",children:w?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>d({...a,name:s.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:a.date?.split("T")[0]||"",onChange:s=>d({...a,date:s.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:a.location||"",onChange:s=>d({...a,location:s.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:a.status||"upcoming",onChange:s=>d({...a,status:s.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Active"}),e.jsxs("select",{value:a.active?"true":"false",onChange:s=>d({...a,active:s.target.value==="true"}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{onClick:J,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg",children:"Save Changes"}),e.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Event Name"}),e.jsx("p",{className:"font-medium",children:u.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Date"}),e.jsx("p",{className:"font-medium",children:u.date&&new Date(u.date).toLocaleDateString("en-AU")})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Location"}),e.jsx("p",{className:"font-medium",children:u.location||"Not set"})]})]}),e.jsx("button",{onClick:()=>{d(u),B(!0)},className:"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg",children:"Edit Details"})]})}),C==="athletes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search athletes...",value:f,onChange:s=>te(s.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg w-64"}),e.jsxs("select",{value:m,onChange:s=>ce(s.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"all",children:"All Mats"}),P.map(s=>e.jsxs("option",{value:s,children:["Mat ",s]},s))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R(!0),className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg",children:"Import from Smoothcomp"}),j.length>0&&e.jsx("button",{onClick:W,className:"px-4 py-2 bg-red-900 hover:bg-red-800 rounded-lg text-sm",children:"Clear All"})]})]}),j.length===0?e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:[e.jsx("p",{children:"No athletes imported yet."}),e.jsx("p",{className:"text-sm mt-2",children:"Import from Smoothcomp to get started."})]}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Division"}),e.jsx("th",{className:"text-center p-3",children:"Mat"}),e.jsx("th",{className:"text-center p-3",children:"Time"}),e.jsx("th",{className:"text-left p-3",children:"Academy"}),e.jsx("th",{className:"text-center p-3",children:"Paid"}),e.jsx("th",{className:"text-center p-3",children:"Captured"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:xe.map(s=>{const i=O.has(s.name?.toLowerCase());return e.jsxs("tr",{className:`border-t border-gray-800 ${i&&!s.captured?"bg-yellow-900/20":""}`,children:[e.jsx("td",{className:"p-3 font-medium",children:s.name}),e.jsx("td",{className:"p-3 text-gray-400",children:s.division}),e.jsx("td",{className:"p-3 text-center",children:s.mat}),e.jsx("td",{className:"p-3 text-center text-gray-400",children:s.competition_time}),e.jsx("td",{className:"p-3 text-gray-400",children:s.academy}),e.jsx("td",{className:"p-3 text-center",children:i?e.jsx("span",{className:"text-green-400",children:"ðŸ’°"}):e.jsx("span",{className:"text-gray-600",children:"-"})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>le(s.id,s.captured),className:`px-2 py-1 rounded text-xs ${s.captured?"bg-green-600":"bg-gray-600 hover:bg-gray-500"}`,children:s.captured?"âœ“":"â—‹"})}),e.jsx("td",{className:"p-3 text-right",children:e.jsx("button",{onClick:()=>oe(s.id),className:"text-red-400 hover:text-red-300",children:"Delete"})})]},s.id)})})]})})]}),C==="runsheet"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-yellow-400 mb-4",children:["ðŸ”¥ Priority Queue (",Q.length,")"]}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Athletes who have PAID but not yet been photographed. Capture these first!"}),Q.length===0?e.jsx("p",{className:"text-gray-500 italic",children:"No pending captures. All paid athletes have been photographed!"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Q.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-yellow-700",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400",children:s.division}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Mat ",s.mat," â€¢ ",s.competition_time]})]}),e.jsx("button",{onClick:()=>le(s.id,!1),className:"px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm",children:"Mark Captured"})]})},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold",children:j.length}),e.jsx("p",{className:"text-sm text-gray-400",children:"Total Athletes"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-400",children:E.length}),e.jsx("p",{className:"text-sm text-gray-400",children:"Orders"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:Q.length}),e.jsx("p",{className:"text-sm text-gray-400",children:"Pending Captures"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-400",children:j.filter(s=>s.captured).length}),e.jsx("p",{className:"text-sm text-gray-400",children:"Captured"})]})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Timeline View"}),j.length===0?e.jsx("p",{className:"text-gray-500 italic",children:"Import athletes to see the timeline."}):e.jsx("div",{className:"space-y-2",children:Object.entries(j.reduce((s,i)=>{const x=i.competition_time||"No Time Set";return s[x]||(s[x]=[]),s[x].push(i),s},{})).sort(([s],[i])=>s.localeCompare(i)).map(([s,i])=>e.jsxs("div",{className:"border-l-2 border-gray-700 pl-4 py-2",children:[e.jsx("p",{className:"font-semibold text-gray-300",children:s}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map(x=>{const y=O.has(x.name?.toLowerCase());return e.jsxs("span",{className:`px-3 py-1 rounded text-sm ${x.captured?"bg-green-900/50 text-green-400 line-through":y?"bg-yellow-900/50 text-yellow-400 font-semibold":"bg-gray-800 text-gray-400"}`,children:[x.name,y&&!x.captured&&" ðŸ’°"]},x.id)})})]},s))})]})]}),C==="gallery"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Event Galleries"}),e.jsx("a",{href:`#/portal/galleries?event=${k.id}&org=${H?.id}`,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg",children:"Manage Galleries"})]}),M.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No galleries for this event yet."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:M.map(s=>e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-4",children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:s.description}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm text-gray-500",children:[e.jsxs("span",{children:[s.gallery_photos?.[0]?.count||0," photos"]}),e.jsx("span",{children:s.access_type})]}),e.jsx("a",{href:`#/gallery/${s.slug}`,target:"_blank",className:"inline-block mt-3 text-sm text-blue-400 hover:text-blue-300",children:"View Gallery â†’"})]},s.id))})]}),C==="orders"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Event Orders"}),E.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No orders for this event yet."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Customer"}),e.jsx("th",{className:"text-left p-3",children:"Package"}),e.jsx("th",{className:"text-right p-3",children:"Amount"}),e.jsx("th",{className:"text-center p-3",children:"Status"})]})}),e.jsx("tbody",{children:E.map(s=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 text-gray-400",children:new Date(s.created_at).toLocaleDateString("en-AU")}),e.jsxs("td",{className:"p-3",children:[e.jsxs("p",{className:"font-medium",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]}),e.jsx("td",{className:"p-3 text-gray-400",children:s.packages?.name}),e.jsxs("td",{className:"p-3 text-right",children:["$",s.amount]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="paid"?"bg-green-600":s.status==="pending"?"bg-yellow-600":"bg-gray-600"}`,children:s.status})})]},s.id))})]})})]})]}),ee&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Import Athletes from Smoothcomp"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Paste athlete data in this format (one per line):",e.jsx("br",{}),e.jsx("code",{className:"bg-gray-800 px-2 py-1 rounded text-xs",children:"Name | Division | Mat | Time | Academy"})]}),e.jsx("textarea",{value:G,onChange:s=>T(s.target.value),placeholder:"John Smith | Adult Blue Belt | 1 | 09:30 | Gracie Barra...",className:"w-full h-64 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg font-mono text-sm"}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{onClick:()=>{R(!1),T("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:re,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg",children:["Import ",ae(G).length," Athletes"]})]})]})})]})}function Ce(){const[k,H]=n.useState([]),[o,L]=n.useState(null),[C,ne]=n.useState([]),[I,K]=n.useState([]),[u,X]=n.useState([]),[E,Z]=n.useState([]),[M,de]=n.useState([]),[U,ue]=n.useState([]),[j,F]=n.useState([]),[G,T]=n.useState(!0),[ee,R]=n.useState(null),[f,te]=n.useState("events"),[q,se]=n.useState(!1),[m,ce]=n.useState(null),[w,B]=n.useState(null),[a,d]=n.useState({}),[S,ae]=n.useState(null),[re,le]=n.useState([]),[oe,W]=n.useState(!1),[J,xe]=n.useState([]),[P,O]=n.useState([]),ie=new URLSearchParams(window.location.hash.split("?")[1]||"").get("org");n.useEffect(()=>{s()},[]),n.useEffect(()=>{o&&i(o.id)},[o]);async function s(){T(!0);const{data:t}=await l.from("organizations").select("*").order("name");if(H(t||[]),ie&&t){const r=t.find(c=>c.id===ie);r&&(L(r),window.location.hash.includes("galleries")&&te("galleries"))}T(!1)}async function i(t){const[r,c,p,$,z]=await Promise.all([l.from("events").select("*").eq("organization_id",t).order("date",{ascending:!0}),l.from("packages").select("*").eq("organization_id",t).order("sort_order"),l.from("content_orders").select("*, events(name), packages(name)").eq("organization_id",t).order("created_at",{ascending:!1}).limit(50),l.from("galleries").select("*, events(name), gallery_photos(count)").eq("organization_id",t).order("created_at",{ascending:!1}),l.from("gallery_purchases").select("*, galleries(title, slug, events(name))").eq("organization_id",t).order("created_at",{ascending:!1}).limit(100)]);ne(r.data||[]),K(c.data||[]),de(p.data||[]),ue($.data||[]),F(z.data||[]);const N=(r.data||[]).map(v=>v.id);if(N.length>0){const[v,D]=await Promise.all([l.from("division_categories").select("*").in("event_id",N).order("sort_order"),l.from("division_subdivisions").select("*").order("sort_order")]);X(v.data||[]);const _=(v.data||[]).map(g=>g.id);Z((D.data||[]).filter(g=>_.includes(g.category_id)))}else X([]),Z([])}async function x(){const{data:t,error:r}=await l.from("packages").select("*, organizations(name, display_name)").neq("organization_id",o?.id).order("name");!r&&t&&xe(t)}async function y(){if(P.length===0||!o)return;const r=J.filter(p=>P.includes(p.id)).map(p=>({name:p.name,description:p.description,price:p.price,sort_order:p.sort_order,active:p.active,organization_id:o.id})),{error:c}=await l.from("packages").insert(r);c?alert("Failed to import packages: "+c.message):(W(!1),O([]),i(o.id))}function h(t){return u.filter(r=>r.event_id===t)}function V(t){return E.filter(r=>r.category_id===t)}function A(t,r=null,c=null){ce(t),B(r),t==="org"?d(r||{name:"",display_name:"",legal_name:"",slug:"",description:"",logo_url:"",active:!0}):t==="event"?d(r||{organization_id:o?.id,name:"",date:"",location:"",status:"upcoming",active:!0,divisions_required:!1}):t==="package"?d(r||{organization_id:o?.id,name:"",description:"",price:"",sort_order:0,active:!0}):t==="division-cat"?d(r||{event_id:c||S,name:"",sort_order:0,active:!0}):t==="division-sub"&&d(r||{category_id:c,name:"",sort_order:0,active:!0}),se(!0)}async function ve(){try{if(m==="org")w?.id?await l.from("organizations").update(a).eq("id",w.id):await l.from("organizations").insert(a),s();else if(m==="event"){const t={...a,organization_id:o.id};w?.id?await l.from("events").update(t).eq("id",w.id):await l.from("events").insert(t),i(o.id)}else if(m==="package"){const t={...a,organization_id:o.id,price:parseFloat(a.price)};w?.id?await l.from("packages").update(t).eq("id",w.id):await l.from("packages").insert(t),i(o.id)}else m==="division-cat"?(w?.id?await l.from("division_categories").update(a).eq("id",w.id):await l.from("division_categories").insert(a),i(o.id)):m==="division-sub"&&(w?.id?await l.from("division_subdivisions").update(a).eq("id",w.id):await l.from("division_subdivisions").insert(a),i(o.id));se(!1)}catch(t){console.error("Save error:",t),alert("Error saving. Check console.")}}async function Y(t,r){if(t==="organizations"){await ye(r);return}if(!confirm("Are you sure you want to delete this item?"))return;const{error:c}=await l.from(t).delete().eq("id",r);if(c){console.error("Delete error:",c),alert(`Failed to delete: ${c.message}`);return}i(o.id)}async function ye(t){const r=k.find(b=>b.id===t);if(!r)return;const[c,p,$,z]=await Promise.all([l.from("events").select("id, name").eq("organization_id",t),l.from("packages").select("id, name").eq("organization_id",t),l.from("content_orders").select("id").eq("organization_id",t),l.from("livestream_events").select("id, title").eq("organization_id",t)]),N=c.data||[],v=p.data||[],D=$.data||[],_=z.data||[];let g=`âš ï¸ DELETE "${r.display_name||r.name}"?

This will also delete:
`;if(N.length>0&&(g+=`
ðŸ“… ${N.length} event${N.length>1?"s":""}`,N.slice(0,3).forEach(b=>{g+=`
   â€¢ ${b.name}`}),N.length>3&&(g+=`
   â€¢ ...and ${N.length-3} more`)),v.length>0&&(g+=`

ðŸ“¦ ${v.length} package${v.length>1?"s":""}`,v.slice(0,3).forEach(b=>{g+=`
   â€¢ ${b.name}`}),v.length>3&&(g+=`
   â€¢ ...and ${v.length-3} more`)),_.length>0&&(g+=`

ðŸŽ¬ ${_.length} livestream event${_.length>1?"s":""}`,_.slice(0,3).forEach(b=>{g+=`
   â€¢ ${b.title}`}),_.length>3&&(g+=`
   â€¢ ...and ${_.length-3} more`)),D.length>0&&(g+=`

ðŸ§¾ ${D.length} order${D.length>1?"s":""}`),N.length+v.length+D.length+_.length===0?g=`Delete "${r.display_name||r.name}"?

No related items will be affected.`:g+=`

âš ï¸ THIS CANNOT BE UNDONE!`,!!confirm(g))try{D.length>0&&await l.from("content_orders").delete().eq("organization_id",t),v.length>0&&await l.from("packages").delete().eq("organization_id",t);for(const he of N){const{data:pe}=await l.from("division_categories").select("id").eq("event_id",he.id);if(pe&&pe.length>0){for(const Ne of pe)await l.from("division_subdivisions").delete().eq("category_id",Ne.id);await l.from("division_categories").delete().eq("event_id",he.id)}await l.from("events").delete().eq("id",he.id)}_.length>0&&await l.from("livestream_events").update({organization_id:null}).eq("organization_id",t);const{error:b}=await l.from("organizations").delete().eq("id",t);if(b)throw b;s(),o?.id===t&&L(null)}catch(b){console.error("Cascade delete error:",b),alert(`Failed to delete: ${b.message}`)}}async function me(t,r,c){await l.from(t).update({active:!c}).eq("id",r),t==="organizations"?s():i(o.id)}if(G)return e.jsx("div",{className:"p-8 text-gray-400",children:"Loading..."});if(!o)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Content Management"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select an organization to manage its events, packages, and divisions"})]}),e.jsx("button",{onClick:()=>A("org"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm font-medium",children:"+ Add Organization"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(t=>e.jsxs("div",{onClick:()=>L(t),className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6 cursor-pointer hover:border-red-500/50 hover:bg-gray-900/80 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.logo_url?e.jsx("img",{src:je(t.logo_url),alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center text-xl font-bold",children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg group-hover:text-red-400 transition-colors",children:t.display_name||t.name}),t.display_name&&t.display_name!==t.name&&e.jsx("p",{className:"text-xs text-gray-400",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",t.slug]})]})]}),!t.active&&e.jsx("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded",children:"Inactive"})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:t.description}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),A("org",t)},className:"text-xs text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:r=>{r.stopPropagation(),me("organizations",t.id,t.active)},className:"text-xs text-gray-400 hover:text-white",children:t.active?"Deactivate":"Activate"}),e.jsx("button",{onClick:r=>{r.stopPropagation(),Y("organizations",t.id)},className:"text-xs text-red-400 hover:text-red-300",children:"Delete"})]})]},t.id))}),q&&be()]});if(ee)return e.jsx("div",{className:"p-6",children:e.jsx(fe,{event:ee,organization:o,onBack:()=>R(null),onEventUpdate:()=>i(o.id)})});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>L(null),className:"text-gray-400 hover:text-white transition-colors",children:"â† Back"}),e.jsxs("div",{className:"flex items-center gap-3",children:[o.logo_url?e.jsx("img",{src:je(o.logo_url),alt:o.name,className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center text-lg font-bold",children:o.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:o.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",o.slug]})]})]})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-gray-700 pb-2 overflow-x-auto",children:["events","packages","divisions","galleries","gallery-orders","orders"].map(t=>e.jsxs("button",{onClick:()=>te(t),className:`px-4 py-2 rounded-t-lg capitalize transition-colors whitespace-nowrap ${f===t?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:[t==="gallery-orders"?"Gallery Orders":t," ",t==="events"&&`(${C.length})`,t==="packages"&&`(${I.length})`,t==="galleries"&&`(${U.length})`,t==="gallery-orders"&&`(${j.length})`,t==="orders"&&`(${M.length})`]},t))}),f==="events"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Upcoming Events"}),e.jsx("button",{onClick:()=>A("event"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Event"})]}),C.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No events yet. Add one to get started."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Event Name"}),e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Location"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-center p-3",children:"Active"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:C.map(t=>e.jsxs("tr",{className:"border-t border-gray-800 hover:bg-gray-800/50 cursor-pointer transition-colors",onClick:()=>R(t),children:[e.jsx("td",{className:"p-3 font-medium text-blue-400 hover:text-blue-300",children:t.name}),e.jsx("td",{className:"p-3 text-gray-400",children:t.date&&new Date(t.date).toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{className:"p-3 text-gray-400",children:t.location}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="upcoming"?"bg-blue-600":t.status==="active"?"bg-green-600":"bg-gray-600"}`,children:t.status})}),e.jsx("td",{className:"p-3 text-center",onClick:r=>r.stopPropagation(),children:e.jsx("button",{onClick:()=>me("events",t.id,t.active),className:`px-2 py-1 rounded text-xs ${t.active?"bg-green-600":"bg-gray-600"}`,children:t.active?"Yes":"No"})}),e.jsxs("td",{className:"p-3 text-right space-x-2",onClick:r=>r.stopPropagation(),children:[e.jsx("button",{onClick:()=>A("event",t),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>Y("events",t.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},t.id))})]})})]}),f==="packages"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Content Packages"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{x(),W(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm",children:"Import from..."}),e.jsx("button",{onClick:()=>A("package"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Package"})]})]}),I.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No packages yet. Add one to get started, or import from another organization."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Package Name"}),e.jsx("th",{className:"text-left p-3",children:"Description"}),e.jsx("th",{className:"text-right p-3",children:"Price"}),e.jsx("th",{className:"text-center p-3",children:"Active"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:I.map(t=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:t.name}),e.jsx("td",{className:"p-3 text-gray-400 truncate max-w-xs",children:t.description}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",t.price]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>me("packages",t.id,t.active),className:`px-2 py-1 rounded text-xs ${t.active?"bg-green-600":"bg-gray-600"}`,children:t.active?"Yes":"No"})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>A("package",t),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>Y("packages",t.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},t.id))})]})})]}),f==="divisions"&&e.jsx("div",{children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Divisions by Event"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Select an event to manage its division categories and subdivisions"}),C.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"Add events first, then you can manage their divisions."}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:S||"",onChange:t=>ae(t.target.value),className:"w-full max-w-md px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"",children:"Select an event..."}),C.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.date&&new Date(t.date).toLocaleDateString("en-AU"),")"]},t.id))]}),S&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Division Categories (",h(S).length,")"]}),e.jsx("button",{onClick:()=>A("division-cat",null,S),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Category"})]}),h(S).length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No division categories for this event yet."}):e.jsx("div",{className:"space-y-3",children:h(S).map(t=>e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>le(r=>r.includes(t.id)?r.filter(c=>c!==t.id):[...r,t.id]),className:"text-gray-400 hover:text-white",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${re.includes(t.id)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("span",{className:"font-semibold",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",V(t.id).length," subdivisions)"]}),!t.active&&e.jsx("span",{className:"text-xs bg-gray-600 px-2 py-0.5 rounded",children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>A("division-cat",t),className:"text-blue-400 hover:text-blue-300 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>Y("division_categories",t.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})]})]}),re.includes(t.id)&&e.jsxs("div",{className:"p-4 border-t border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Subdivisions:"}),e.jsx("button",{onClick:()=>A("division-sub",null,t.id),className:"text-sm text-green-400 hover:text-green-300",children:"+ Add Subdivision"})]}),V(t.id).length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No subdivisions yet"}):e.jsx("div",{className:"flex flex-wrap gap-2",children:V(t.id).map(r=>e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm ${r.active?"bg-gray-800 border-gray-600":"bg-gray-900 border-gray-700 opacity-50"}`,children:[e.jsx("span",{children:r.name}),e.jsx("button",{onClick:()=>A("division-sub",r,t.id),className:"text-blue-400 hover:text-blue-300",children:"âœŽ"}),e.jsx("button",{onClick:()=>Y("division_subdivisions",r.id),className:"text-red-400 hover:text-red-300",children:"Ã—"})]},r.id))})]})]},t.id))}),o.slug==="nba"&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-900/20 border border-blue-800 rounded-xl",children:[e.jsx("h4",{className:"font-semibold text-blue-400 mb-2",children:"Quick Add: Standard NBA Divisions"}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Add all standard NBA bodybuilding divisions for this event"}),e.jsx("button",{onClick:async t=>{const r=t.target,c=r.innerText;if(!S){alert("Please select an event first");return}if(window.confirm("Add all standard NBA divisions to this event?")){r.disabled=!0,r.innerText="Adding divisions...";try{const p={"Men's Physique":["Novice","Open","Masters 40+","Masters 50+","Junior"],"Classic Physique":["Novice","Open","Masters 40+","Masters 50+"],Bodybuilding:["Novice","Open","Masters 40+","Masters 50+","Junior"],Figure:["Novice","Open","Masters 35+","Masters 45+","Junior"],Bikini:["Novice","Open","Masters 35+","Masters 45+","Junior"],Wellness:["Novice","Open","Masters 35+","Masters 45+"],"Fitness Model":["Open","Masters"],"Sports Model":["Open","Masters"],Transformation:["Open"]};let $=0,z=0;for(const[N,v]of Object.entries(p)){const{data:D,error:_}=await l.from("division_categories").insert({event_id:S,name:N,sort_order:$++,active:!0}).select().single();if(_){console.error("Error adding category:",N,_);continue}if(D){z++;let g=0;for(const ge of v){const{error:b}=await l.from("division_subdivisions").insert({category_id:D.id,name:ge,sort_order:g++,active:!0});b&&console.error("Error adding subdivision:",ge,b)}}}alert(`Added ${z} division categories with subdivisions!`),await i(o.id)}catch(p){console.error("Error adding divisions:",p),alert("Error adding divisions: "+p.message)}finally{r.disabled=!1,r.innerText=c}}},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm disabled:opacity-50",children:"Add Standard NBA Divisions"})]})]})]})]})}),f==="galleries"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Photo Galleries"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`/#/portal/galleries?org=${o.id}&create=true`,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ New Gallery"}),U.length>0&&e.jsx("a",{href:`/#/portal/galleries?org=${o.id}`,className:"px-4 py-2 bg-dark-600 hover:bg-dark-500 rounded-lg text-sm",children:"Manage All"})]})]}),U.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No galleries yet. Create one to start selling event photos."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Gallery Name"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-center p-3",children:"Photos"}),e.jsx("th",{className:"text-right p-3",children:"Price/Photo"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:U.map(t=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:t.title}),e.jsx("td",{className:"p-3 text-gray-400",children:t.events?.name||"â€”"}),e.jsx("td",{className:"p-3 text-center",children:t.gallery_photos?.[0]?.count||0}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",(t.price_per_photo/100).toFixed(2)]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="published"?"bg-green-600":t.status==="draft"?"bg-yellow-600":"bg-gray-600"}`,children:t.status})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("a",{href:`/#/portal/galleries?edit=${t.id}`,className:"text-blue-400 hover:text-blue-300",children:"Edit"}),t.status==="published"&&e.jsx("a",{href:`/#/gallery/${t.slug}`,target:"_blank",className:"text-green-400 hover:text-green-300",children:"View"})]})]},t.id))})]})})]}),f==="gallery-orders"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Gallery Photo Orders"}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Total Revenue: ",e.jsxs("span",{className:"text-green-400 font-semibold",children:["$",j.reduce((t,r)=>t+(r.amount||0),0).toFixed(2)]})]})]}),j.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No gallery orders yet. Orders will appear here when customers purchase photos."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Customer"}),e.jsx("th",{className:"text-left p-3",children:"Gallery"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-center p-3",children:"Photos"}),e.jsx("th",{className:"text-right p-3",children:"Amount"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:j.map(t=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsxs("td",{className:"p-3 text-gray-400",children:[new Date(t.created_at).toLocaleDateString("en-AU"),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium",children:t.customer_name||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500",children:t.customer_email})]}),e.jsx("td",{className:"p-3 text-gray-400",children:t.galleries?.title||"N/A"}),e.jsx("td",{className:"p-3 text-gray-400",children:t.galleries?.events?.name||"â€”"}),e.jsx("td",{className:"p-3 text-center",children:t.photo_count||1}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",(t.amount||0).toFixed(2)]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="completed"||t.status==="paid"?"bg-green-600":t.status==="pending"?"bg-yellow-600":"bg-gray-600"}`,children:t.status||"pending"})}),e.jsx("td",{className:"p-3 text-right",children:t.galleries?.slug&&e.jsx("a",{href:`/#/gallery/${t.galleries.slug}`,target:"_blank",className:"text-blue-400 hover:text-blue-300 text-sm",children:"View Gallery"})})]},t.id))})]})})]}),f==="orders"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Orders"}),e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Athlete"}),e.jsx("th",{className:"text-left p-3",children:"Email"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-left p-3",children:"Package"}),e.jsx("th",{className:"text-right p-3",children:"Amount"}),e.jsx("th",{className:"text-center p-3",children:"Status"})]})}),e.jsx("tbody",{children:M.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-400",children:"No orders yet"})}):M.map(t=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 text-gray-400",children:new Date(t.created_at).toLocaleDateString("en-AU")}),e.jsxs("td",{className:"p-3 font-medium",children:[t.first_name," ",t.last_name]}),e.jsx("td",{className:"p-3 text-gray-400",children:t.email}),e.jsx("td",{className:"p-3 text-gray-400",children:t.events?.name}),e.jsx("td",{className:"p-3 text-gray-400",children:t.packages?.name}),e.jsxs("td",{className:"p-3 text-right font-semibold",children:["$",t.amount]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.status==="paid"?"bg-green-600":t.status==="delivered"?"bg-blue-600":t.status==="pending"?"bg-yellow-600":"bg-gray-600"}`,children:t.status})})]},t.id))})]})})]}),q&&be(),oe&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-lg max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Import Packages from Other Organizations"}),J.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No packages available to import from other organizations."}):e.jsx("div",{className:"flex-1 overflow-y-auto mb-4 space-y-2",children:Object.entries(J.reduce((t,r)=>{const c=r.organizations?.display_name||r.organizations?.name||"Unknown";return t[c]||(t[c]=[]),t[c].push(r),t},{})).map(([t,r])=>e.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-800 px-3 py-2 font-medium text-sm",children:t}),e.jsx("div",{className:"divide-y divide-gray-800",children:r.map(c=>e.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-800/50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:P.includes(c.id),onChange:p=>{p.target.checked?O($=>[...$,c.id]):O($=>$.filter(z=>z!==c.id))},className:"w-4 h-4 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:c.name}),c.description&&e.jsx("div",{className:"text-xs text-gray-400 truncate",children:c.description})]}),e.jsxs("div",{className:"text-green-400 font-semibold",children:["$",c.price]})]},c.id))})]},t))}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>{W(!1),O([])},className:"flex-1 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:y,disabled:P.length===0,className:"flex-1 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:["Import ",P.length>0&&`(${P.length})`]})]})]})})]});function be(){return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[w?"Edit":"Add"," ",m==="org"?"Organization":m==="event"?"Event":m==="package"?"Package":m==="division-cat"?"Division Category":m==="division-sub"?"Subdivision":""]}),e.jsxs("div",{className:"space-y-4",children:[m==="org"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization Name *"}),e.jsx("input",{type:"text",value:a.name||"",onChange:t=>d({...a,name:t.target.value}),placeholder:"e.g., World Ninja Games",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name (Short)"}),e.jsx("input",{type:"text",value:a.display_name||"",onChange:t=>d({...a,display_name:t.target.value}),placeholder:"e.g., WNG",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown on livestream cards & filters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Legal Name"}),e.jsx("input",{type:"text",value:a.legal_name||"",onChange:t=>d({...a,legal_name:t.target.value}),placeholder:"e.g., World Ninja Games Pty Ltd",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For contracts & invoices"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Slug (URL-friendly)"}),e.jsx("input",{type:"text",value:a.slug||"",onChange:t=>d({...a,slug:t.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Logo URL"}),e.jsx("input",{type:"text",value:a.logo_url||"",onChange:t=>d({...a,logo_url:t.target.value}),placeholder:"https://...",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:t=>d({...a,description:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",rows:3})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4 mt-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3 font-medium",children:"Contact / Organizer"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:a.contact_name||"",onChange:t=>d({...a,contact_name:t.target.value}),placeholder:"e.g., Phil Cassidy",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Email"}),e.jsx("input",{type:"email",value:a.contact_email||"",onChange:t=>d({...a,contact_email:t.target.value}),placeholder:"email@example.com",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:a.contact_phone||"",onChange:t=>d({...a,contact_phone:t.target.value}),placeholder:"+61 400 000 000",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]})]})]})]}),m==="event"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:t=>d({...a,name:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:a.date||"",onChange:t=>d({...a,date:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:a.location||"",onChange:t=>d({...a,location:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:a.status||"upcoming",onChange:t=>d({...a,status:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.divisions_required||!1,onChange:t=>d({...a,divisions_required:t.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-white",children:"Require Divisions"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Athletes must select a division when ordering"})]})]})]}),m==="package"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Package Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:t=>d({...a,name:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:a.description||"",onChange:t=>d({...a,description:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Price (AUD)"}),e.jsx("input",{type:"number",value:a.price||"",onChange:t=>d({...a,price:t.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:t=>d({...a,sort_order:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]})]}),m==="division-cat"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:t=>d({...a,name:t.target.value}),placeholder:"e.g., Men's Physique, Bikini, Figure",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:t=>d({...a,sort_order:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),m==="division-sub"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Subdivision Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:t=>d({...a,name:t.target.value}),placeholder:"e.g., Novice, Open, Masters 40+",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:t=>d({...a,sort_order:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:a.active??!0,onChange:t=>d({...a,active:t.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-400",children:"Active"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>se(!1),className:"flex-1 py-2 border border-gray-600 rounded-lg hover:bg-gray-800",children:"Cancel"}),e.jsx("button",{onClick:ve,className:"flex-1 py-2 bg-red-600 hover:bg-red-700 rounded-lg",children:"Save"})]})]})})}}export{Ce as default};
