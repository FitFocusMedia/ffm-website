import{a as i,j as e,S as Me,X as Ke,L as ae,T as we,C as Z,b as Q,P as q,c as Qe,M as H,d as se,G as Xe,Z as Le,U as ue,F as xe,e as ve,f as je,h as et,i as tt,k as $e,l as Se,m as Ae,n as We,o as st,p as at,q as rt,s as nt,t as lt,u as Ve,v as Pe,w as ye,x as Ue,N as it,z as ot,y as ct,A as dt,E as Be,B as mt,R as Ge,D as Fe,H as xt,I as ut,J as ht,K as gt,O as ft}from"./vendor-react-CBAhgyLg.js";import{c as pt}from"./vendor-supabase-CIrp0PiG.js";const bt="https://gonalgubgldgpkcekaxe.supabase.co",wt="sb_publishable_SB4LfH4EkuEyu5qeC_dffQ_G9cF8Fo_",x=pt(bt,wt);async function is({name:s,email:a,phone:t,orgName:r,formData:o=null}){const n=crypto.randomUUID(),{error:c}=await x.from("leads").insert([{id:n,name:s,email:a,phone:t,org_name:r,completed_form:!!o,form_data:o,source:"combat-sports-proposal"}]);if(c)throw c;return{id:n,name:s,email:a,phone:t,org_name:r}}async function os(s){if(!s)return null;let{data:a,error:t}=await x.from("crm_leads").select("*").ilike("org_name",s).limit(1).single();if(a)return a;const r=s.replace(/\s*(Pty|Ltd|Inc|LLC|Pty Ltd|PTY LTD|Corporation|Corp)\.?\s*/gi,"").trim(),o=await x.from("crm_leads").select("*").ilike("org_name",`%${r}%`).limit(1).single();if(o.data)return o.data;const n=r.split(/\s+/).filter(c=>c.length>3);if(n.length>0){const c=n[0],d=await x.from("crm_leads").select("*").ilike("org_name",`%${c}%BJJ%`).limit(1).single();if(d.data)return d.data}return null}async function cs(){const{data:s,error:a}=await x.from("contracts").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}async function ds(s){const{data:a,error:t}=await x.from("contracts").select("*").eq("id",s).single();if(t)throw t;return a}async function ms(s){const{data:a,error:t}=await x.from("contracts").select("*").eq("share_token",s).single();if(t)throw t;return a}async function xs(s){const a=Array.from({length:32},()=>Math.floor(Math.random()*16).toString(16)).join(""),{data:t,error:r}=await x.from("contracts").insert({...s,share_token:a}).select().single();if(r)throw r;return t}async function us(s,a){const{data:t,error:r}=await x.from("contracts").update({...a,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(r)throw r;return t}async function hs(s){const{error:a}=await x.from("contracts").delete().eq("id",s);if(a)throw a}async function gs(s){const{data:a,error:t}=await x.from("contracts").update({viewed_at:new Date().toISOString(),status:"viewed",updated_at:new Date().toISOString()}).eq("id",s).select().single();if(t)throw t;return a}async function fs(s){const{data:a,error:t}=await x.from("orders").insert([s]).select().single();if(t)throw t;return a}async function ps(s,a,t=!1){const r=t?{client_signature:a,client_signed_at:new Date().toISOString(),status:"signed",updated_at:new Date().toISOString()}:{ffm_signature:a,ffm_signed_at:new Date().toISOString(),status:"sent",updated_at:new Date().toISOString()},{data:o,error:n}=await x.from("contracts").update(r).eq("id",s).select().single();if(n)throw n;return o}const vt=()=>Array.from({length:24},()=>Math.floor(Math.random()*16).toString(16)).join("");async function bs(){const{data:s,error:a}=await x.from("onboarding_sessions").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}async function ws(s){const{data:a,error:t}=await x.from("onboarding_sessions").select("*").eq("share_token",s);if(t)throw t;if(!a||a.length===0)throw new Error("Onboarding session not found. Please check your link or contact Fit Focus Media.");const r=a[0];return r&&r.status==="pending"&&(await x.from("onboarding_sessions").update({status:"in_progress"}).eq("share_token",s),r.status="in_progress"),r}async function vs(s){const{data:a,error:t}=await x.from("onboarding_sessions").insert({...s,share_token:vt(),status:"pending"}).select().single();if(t)throw t;if(a&&a.org_name&&a.event_name)try{await jt(a.id,a.org_name,a.event_name)}catch(r){console.error("Failed to create Drive folders:",r)}return a}async function js(s,a){delete a.id,delete a.created_at,delete a.share_token,delete a.contract_id;const{data:t,error:r}=await x.from("onboarding_sessions").update({...a,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(r)throw r;return t}async function ys(s,a){delete a.id,delete a.created_at,delete a.share_token,delete a.contract_id;const{data:t,error:r}=await x.from("onboarding_sessions").update({...a,updated_at:new Date().toISOString()}).eq("share_token",s).select();if(r)throw r;if(!t||t.length===0)throw new Error("Failed to save changes - session not found");return t[0]}async function Ns(s){const a=typeof s=="string"?s:s?.share_token;if(!a)throw new Error("No share token provided for submission");const{data:t,error:r}=await x.from("onboarding_sessions").update({status:"submitted",submitted_at:new Date().toISOString()}).eq("share_token",a).select();if(r)throw r;if(!t||t.length===0)throw new Error("Session not found or update blocked by permissions");return t[0]}async function ks(s,a,t){const{data:r,error:o}=await x.from("onboarding_sessions").update({status:"reviewed",reviewed_at:new Date().toISOString(),reviewed_by:a,admin_notes:t}).eq("id",s).select();if(o)throw o;return r}async function _s(s){const{error:a}=await x.from("onboarding_files").delete().eq("session_id",s);a&&console.error("Error deleting files:",a);const{error:t}=await x.from("onboarding_sessions").delete().eq("id",s);if(t)throw t;return!0}const Ee="onboarding";async function Ss(s,a,t,r){const{data:o}=await x.from("onboarding_sessions").select("org_name, event_name").eq("id",s).single(),n=y=>y?.replace(/[^a-zA-Z0-9 -]/g,"").trim().substring(0,50)||"",c=n(o?.org_name)||s.substring(0,8),d=o?.event_name?n(o.event_name):null,m=Date.now(),p=r.name.replace(/[^a-zA-Z0-9.-]/g,"_"),u=d?`${c}/${d}/${a}/${m}_${p}`:`${c}/${a}/${m}_${p}`,{data:w,error:g}=await x.storage.from(Ee).upload(u,r,{cacheControl:"3600",upsert:!1});if(g)throw new Error(g.message||"Upload failed");const{data:v}=x.storage.from(Ee).getPublicUrl(u),k=v?.publicUrl||null,{data:j,error:f}=await x.from("onboarding_files").insert({session_id:s,category:a,file_type:t,file_name:r.name,file_size:r.size,mime_type:r.type,storage_path:u,public_url:k,synced_to_drive:!1}).select().single();if(f)throw await x.storage.from(Ee).remove([u]),new Error(f.message||"Failed to create file record");return{file:j,url:k,message:"File uploaded. Will sync to Google Drive automatically."}}async function jt(s,a,t){return console.log("Drive folders will be created automatically during sync"),{success:!0,message:"Folders created during sync"}}async function Es(s){const{data:a,error:t}=await x.from("onboarding_files").select("*").eq("session_id",s).order("created_at",{ascending:!1});if(t)throw t;return a}async function Cs(){const{data:s,error:a}=await x.from("events").select("*, organizations(id, name, display_name)").eq("active",!0).order("date",{ascending:!0});if(a)throw a;return(s||[]).map(t=>({...t,org_display_name:t.organizations?.display_name||t.organizations?.name||"Unknown"}))}async function yt(){const{data:s,error:a}=await x.from("livestream_events").select("*, organizations(id, name, display_name, logo_url)").in("status",["published","live","ended"]).order("start_time",{ascending:!0});if(a)throw a;return(s||[]).map(t=>({...t,org_display_name:t.organizations?.display_name||t.organizations?.name||t.organization}))}async function Te(s){const{data:a,error:t}=await x.from("livestream_events").select("*, organizations(id, name, display_name, logo_url)").eq("id",s).single();if(t)throw t;return a?{...a,org_display_name:a.organizations?.display_name||a.organizations?.name||a.organization}:null}async function Ds(){const{data:s,error:a}=await x.from("livestream_events").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}async function Ls(s){const{data:a,error:t}=await x.from("livestream_events").insert([s]).select().single();if(t)throw t;return a}async function $s(s,a){const{data:t,error:r}=await x.from("livestream_events").update({...a,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(r)throw r;return t}async function Ts(s){const{error:a}=await x.from("livestream_events").delete().eq("id",s);if(a)throw a}async function Nt(){const{data:s,error:a}=await x.from("livestream_settings").select("*").eq("id",1).single();if(a&&a.code!=="PGRST116")throw a;return s||{demo_mode:!1}}async function Is(s){const{data:a,error:t}=await x.from("livestream_settings").upsert({id:1,...s,updated_at:new Date().toISOString()}).select().single();if(t)throw t;return a}async function ze(s,a){const{data:t,error:r}=await x.from("livestream_orders").select("*").eq("event_id",s).eq("email",a.toLowerCase()).eq("status","completed").order("created_at",{ascending:!1}).limit(1);if(r)throw r;return t?.[0]||null}async function As(s){let a=x.from("livestream_orders").select("*, event:livestream_events(*)").order("created_at",{ascending:!1});const{data:t,error:r}=await a;if(r)throw r;return t}async function kt(s){const{data:a,error:t}=await x.from("livestream_sessions").insert([s]).select().single();if(t)throw t;return a}async function _t(s){const{data:a,error:t}=await x.from("livestream_sessions").update({last_seen:new Date().toISOString()}).eq("token",s).eq("active",!0).select().single();if(t)throw t;return a}async function St(s){const{data:a,error:t}=await x.from("livestream_streams").select("*").eq("event_id",s).order("display_order",{ascending:!0});if(t)throw t;return a||[]}async function Ps(s){const{data:a,error:t}=await x.from("livestream_streams").insert([s]).select().single();if(t)throw t;return a}async function Os(s,a){const{data:t,error:r}=await x.from("livestream_streams").update(a).eq("id",s).select().single();if(r)throw r;return t}async function Ms(s){const{error:a}=await x.from("livestream_streams").delete().eq("id",s);if(a)throw a}async function Us(s,a){const{error:t}=await x.from("livestream_events").update({is_multi_stream:a}).eq("id",s);if(t)throw t}async function Et(s,a){const{data:t,error:r}=await x.auth.signInWithOtp({email:s.toLowerCase(),options:{emailRedirectTo:a||window.location.origin}});if(r)throw r;return t}async function Ct(){const{data:{session:s},error:a}=await x.auth.getSession();if(a)throw a;return s}async function Dt(){const{error:s}=await x.auth.signOut();if(s)throw s}function Lt(s){return x.auth.onAuthStateChange(s)}async function Re(s,a){const t=a.toLowerCase(),{data:r}=await x.from("user_profiles").select("*").eq("email",t).single();if(r){const{data:c,error:d}=await x.from("user_profiles").update({auth_id:s,last_login_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(d)throw d;return c}const{data:o,error:n}=await x.from("user_profiles").insert({email:t,auth_id:s,last_login_at:new Date().toISOString()}).select().single();if(n)throw n;return await x.from("livestream_orders").update({user_id:o.id}).eq("email",t).is("user_id",null),o}async function $t(s){const{data:a,error:t}=await x.from("livestream_orders").select("*, event:livestream_events(*)").eq("email",s.toLowerCase()).eq("status","completed").order("created_at",{ascending:!1});if(t)throw t;return a}function Tt(s,a){return(a?`${s}-${a}`:s).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"").substring(0,60)}async function Fs(){const{data:s,error:a}=await x.from("proposals").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}async function It(s){const{data:a,error:t}=await x.from("proposals").select("*").eq("id",s).single();if(t)throw t;return a}async function zs(s){const{data:a,error:t}=await x.from("proposals").select("*").eq("slug",s).single();if(t)throw t;return a}async function Rs(s){const t=`${s.slug||Tt(s.org_name,s.event_name)}-${Date.now().toString(36)}`,{data:r,error:o}=await x.from("proposals").insert([{...s,slug:t,status:s.status||"draft"}]).select().single();if(o)throw o;return r}async function He(s,a){const{data:t,error:r}=await x.from("proposals").update({...a,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(r)throw r;return t}async function qs(s){const{error:a}=await x.from("proposals").delete().eq("id",s);if(a)throw a}async function Ws(s){const{data:a,error:t}=await x.from("proposals").select("id, views").eq("slug",s).single();if(t)throw t;const{error:r}=await x.from("proposals").update({views:(a.views||0)+1,last_viewed_at:new Date().toISOString()}).eq("id",a.id);if(r)throw r}async function Vs(s,a){return He(s,{status:a})}async function Bs(s,a=null,t=""){const r=await It(s);if(!r)throw new Error("Proposal not found");const o=a||r.contact_email;if(!o)throw new Error("No email address provided");const n=`https://fitfocusmedia.com.au/#/proposals/${r.slug}`,c=await fetch("https://gonalgubgldgpkcekaxe.supabase.co/functions/v1/send-proposal-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:o,proposal_id:s,proposal_url:n,org_name:r.org_name,contact_name:r.contact_name,event_name:r.event_name,price:r.price,custom_message:t})});if(!c.ok){const d=await c.json().catch(()=>({}));throw new Error(d.error||"Failed to send email")}return await He(s,{status:"sent",sent_at:new Date().toISOString(),sent_to:o}),{success:!0,sentTo:o}}function G(s){if(!s||!s.includes("drive.google.com"))return s;let a=null;const t=s.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);if(t&&(a=t[1]),!a){const r=s.match(/[?&]id=([a-zA-Z0-9_-]+)/);r&&(a=r[1])}return a?`https://lh3.googleusercontent.com/d/${a}`:s}function Ze({targetDate:s,large:a=!1}){const[t,r]=i.useState(o(s));i.useEffect(()=>{const n=setInterval(()=>{r(o(s))},1e3);return()=>clearInterval(n)},[s]);function o(n){const c=new Date(n)-new Date;return c<=0?null:{days:Math.floor(c/(1e3*60*60*24)),hours:Math.floor(c/(1e3*60*60)%24),minutes:Math.floor(c/1e3/60%60),seconds:Math.floor(c/1e3%60)}}return t?a?e.jsx("div",{className:"flex gap-4 md:gap-6",children:[{value:t.days,label:"DAYS"},{value:t.hours,label:"HOURS"},{value:t.minutes,label:"MINS"},{value:t.seconds,label:"SECS"}].map((n,c)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-black/50 backdrop-blur-md rounded-xl px-4 py-3 md:px-6 md:py-4 min-w-[70px] md:min-w-[90px] border border-white/10",children:e.jsx("span",{className:"text-3xl md:text-5xl lg:text-6xl font-bold text-white tabular-nums",children:String(n.value).padStart(2,"0")})}),e.jsx("span",{className:"text-xs md:text-sm text-gray-400 mt-2 block font-medium tracking-wider",children:n.label})]},c))}):e.jsx("div",{className:"flex gap-3 md:gap-4",children:[{value:t.days,label:"DAYS"},{value:t.hours,label:"HRS"},{value:t.minutes,label:"MIN"},{value:t.seconds,label:"SEC"}].map((n,c)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-dark-800/80 backdrop-blur-sm rounded-lg px-3 py-2 md:px-4 md:py-3 min-w-[50px] md:min-w-[70px]",children:e.jsx("span",{className:"text-2xl md:text-4xl font-bold text-white tabular-nums",children:String(n.value).padStart(2,"0")})}),e.jsx("span",{className:"text-[10px] md:text-xs text-gray-400 mt-1 block",children:n.label})]},c))}):e.jsx("span",{className:"text-green-400 font-bold text-2xl",children:"Starting Soon!"})}function Ce({title:s,events:a,icon:t,accentColor:r="red"}){const o=i.useState(null);return!a||a.length===0?null:e.jsxs("section",{className:"mb-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-white flex items-center gap-2",children:[t,s]}),a.length>3&&e.jsxs("span",{className:"text-sm text-gray-500",children:[a.length," events"]})]}),e.jsx("div",{className:"relative group",children:e.jsx("div",{ref:o,className:"flex gap-4 overflow-x-auto pb-4 snap-x snap-mandatory scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:a.map(n=>e.jsx("div",{className:"flex-shrink-0 w-[280px] md:w-[320px] snap-start",children:e.jsx(Ie,{event:n,compact:!0})},n.id))})})]})}function Ie({event:s,featured:a=!1,compact:t=!1}){const[r,o]=i.useState(!1),n=new Date(s.start_time),c=new Date,d=s.status==="live"||s.is_live,m=s.status==="ended"||new Date(s.end_time)<c,p=!d&&!m,u=n.toDateString()===c.toDateString(),w=n.toDateString()===new Date(c.getTime()+864e5).toDateString();return a?e.jsx(ae,{to:`/live/${s.id}`,className:"block group",children:e.jsxs("div",{className:"relative rounded-2xl overflow-hidden aspect-[21/9] md:aspect-[21/8]",children:[e.jsxs("div",{className:"absolute inset-0",children:[s.thumbnail_url&&!r?e.jsx("img",{src:G(s.thumbnail_url),alt:s.title,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",onError:()=>o(!0)}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-red-900 to-dark-900"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/80 via-transparent to-transparent"})]}),e.jsxs("div",{className:"absolute inset-0 p-6 md:p-10 flex flex-col justify-end",children:[e.jsxs("div",{className:"mb-3",children:[d&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-500 text-white text-sm font-bold rounded-full",children:[e.jsx("span",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"LIVE NOW"]}),p&&u&&e.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-500 text-black text-sm font-bold rounded-full",children:"TODAY"}),p&&w&&e.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-blue-500 text-white text-sm font-bold rounded-full",children:"TOMORROW"})]}),e.jsx("p",{className:"text-red-400 font-semibold text-sm md:text-base mb-1",children:s.org_display_name||s.organization}),e.jsx("h2",{className:"text-2xl md:text-4xl lg:text-5xl font-bold text-white mb-3 group-hover:text-red-400 transition-colors",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm md:text-base text-gray-300 mb-4",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Z,{className:"w-4 h-4"}),n.toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short",timeZone:"UTC"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Q,{className:"w-4 h-4"}),n.toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit",timeZone:"UTC"})]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(H,{className:"w-4 h-4"}),s.venue]})]}),e.jsxs("div",{className:"flex items-end justify-between gap-4",children:[p&&e.jsx(Ze,{targetDate:s.start_time}),d&&e.jsxs("span",{className:"px-6 py-3 bg-red-500 hover:bg-red-600 text-white font-bold rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 fill-current"}),"Watch Now"]}),e.jsxs("div",{className:"ml-auto",children:[e.jsxs("span",{className:"text-3xl md:text-4xl font-bold text-white",children:["$",s.price]}),e.jsx("span",{className:"text-gray-400 ml-1",children:"AUD"})]})]})]})]})}):e.jsxs(ae,{to:`/live/${s.id}`,className:"group bg-dark-900 rounded-xl overflow-hidden border border-dark-800 hover:border-red-500/50 hover:shadow-lg hover:shadow-red-500/10 transition-all duration-300 ",children:[e.jsxs("div",{className:"relative aspect-video bg-dark-800 overflow-hidden",children:[s.thumbnail_url&&!r?e.jsx("img",{src:G(s.thumbnail_url),alt:s.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:()=>o(!0)}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-dark-800 to-dark-900",children:e.jsx(q,{className:"w-12 h-12 text-dark-600"})}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity transform scale-90 group-hover:scale-100",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-red-500/90 flex items-center justify-center",children:e.jsx(q,{className:"w-6 h-6 text-white fill-current ml-1"})})})}),d&&e.jsxs("div",{className:"absolute top-3 left-3 px-2.5 py-1 bg-red-500 text-white text-xs font-bold rounded-full flex items-center gap-1.5 shadow-lg",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),"LIVE"]}),m&&s.mux_playback_id&&e.jsx("div",{className:"absolute top-3 left-3 px-2.5 py-1 bg-green-600 text-white text-xs font-medium rounded-full shadow-lg",children:"Replay"}),p&&u&&e.jsx("div",{className:"absolute top-3 left-3 px-2.5 py-1 bg-amber-500 text-black text-xs font-bold rounded-full shadow-lg",children:"TODAY"}),p&&w&&e.jsx("div",{className:"absolute top-3 left-3 px-2.5 py-1 bg-blue-500 text-white text-xs font-bold rounded-full shadow-lg",children:"TOMORROW"}),e.jsxs("div",{className:"absolute bottom-3 right-3 px-2.5 py-1 bg-black/80 backdrop-blur-sm text-white font-bold text-sm rounded-lg",children:["$",s.price]}),e.jsx("div",{className:"absolute bottom-3 left-3 px-2.5 py-1 bg-dark-900/80 backdrop-blur-sm text-gray-300 text-xs font-medium rounded-lg truncate max-w-[60%]",children:s.org_display_name||s.organization})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2 group-hover:text-red-400 transition-colors line-clamp-1",children:s.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3.5 h-3.5"}),n.toLocaleDateString("en-AU",{day:"numeric",month:"short",timeZone:"UTC"})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-3.5 h-3.5"}),n.toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit",timeZone:"UTC"})]})]})]})]})}function At({event:s}){const[a,t]=i.useState(!1),r=new Date(s.start_time),o=s.status==="live"||s.is_live;return e.jsxs("section",{className:"relative min-h-[90vh] flex items-center justify-center overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[s.thumbnail_url&&!a?e.jsx("img",{src:G(s.thumbnail_url),alt:s.title,className:"w-full h-full object-cover scale-105",onError:()=>t(!0)}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-red-900 via-dark-900 to-black"}),e.jsx("div",{className:"absolute inset-0 bg-black/60"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/50"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/70 via-transparent to-black/70"})]}),e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-red-500/20 rounded-full blur-[150px] animate-pulse"})}),e.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto px-4 text-center",children:[o?e.jsxs("div",{className:"inline-flex items-center gap-2 px-6 py-2 bg-red-500 text-white font-bold rounded-full mb-6 animate-pulse",children:[e.jsx("span",{className:"w-3 h-3 bg-white rounded-full animate-ping"}),"LIVE NOW"]}):e.jsx("div",{className:"inline-flex items-center gap-2 px-6 py-2 bg-white/10 backdrop-blur-sm text-white font-semibold rounded-full mb-6 border border-white/20",children:e.jsx("span",{className:"text-red-400",children:"NEXT EVENT"})}),e.jsx("p",{className:"text-red-400 font-bold text-lg md:text-xl mb-4 tracking-wide",children:s.org_display_name||s.organization}),e.jsx("h1",{className:"text-4xl md:text-6xl lg:text-7xl xl:text-8xl font-black text-white mb-6 leading-tight",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 md:gap-8 text-gray-300 mb-10",children:[e.jsxs("span",{className:"flex items-center gap-2 text-lg",children:[e.jsx(Z,{className:"w-5 h-5 text-red-400"}),r.toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",timeZone:"UTC"})]}),e.jsxs("span",{className:"flex items-center gap-2 text-lg",children:[e.jsx(Q,{className:"w-5 h-5 text-red-400"}),r.toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit",timeZone:"UTC"})]}),e.jsxs("span",{className:"flex items-center gap-2 text-lg",children:[e.jsx(H,{className:"w-5 h-5 text-red-400"}),s.venue]})]}),!o&&e.jsx("div",{className:"mb-10",children:e.jsx(Ze,{targetDate:s.start_time,large:!0})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsx(ae,{to:`/live/${s.id}`,className:"group px-10 py-4 bg-red-500 hover:bg-red-600 text-white font-bold text-xl rounded-xl transition-all hover:scale-105 hover:shadow-xl hover:shadow-red-500/30 flex items-center gap-3",children:o?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-6 h-6 fill-current"}),"Watch Live"]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-6 h-6"}),"Get Tickets â€” $",s.price]})}),e.jsx("button",{onClick:()=>document.getElementById("upcoming-events")?.scrollIntoView({behavior:"smooth"}),className:"px-10 py-4 bg-white/10 hover:bg-white/20 backdrop-blur-sm text-white font-bold text-xl rounded-xl transition-all border border-white/20 hover:border-white/40",children:"View All Events"})]})]}),e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 animate-bounce",children:e.jsx("div",{className:"w-8 h-12 rounded-full border-2 border-white/30 flex items-start justify-center p-2",children:e.jsx("div",{className:"w-1.5 h-3 bg-white/50 rounded-full animate-pulse"})})})]})}function Pt(){const s=[{icon:e.jsx(se,{className:"w-8 h-8"}),title:"Multi-Camera Production",description:"Professional broadcast quality with multiple angles"},{icon:e.jsx(Xe,{className:"w-8 h-8"}),title:"Watch Anywhere",description:"Stream on any device, anywhere in the world"},{icon:e.jsx(Le,{className:"w-8 h-8"}),title:"Instant Replays",description:"Never miss a moment with on-demand access"},{icon:e.jsx(ue,{className:"w-8 h-8"}),title:"Premium Experience",description:"Commentary, graphics, and cinematic quality"}];return e.jsx("section",{className:"py-16 bg-gradient-to-b from-black to-dark-950",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:s.map((a,t)=>e.jsxs("div",{className:"text-center group",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-red-500/10 flex items-center justify-center text-red-400 group-hover:bg-red-500/20 group-hover:scale-110 transition-all",children:a.icon}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:a.title}),e.jsx("p",{className:"text-sm text-gray-500",children:a.description})]},t))})})})}function Ot({organizations:s}){return!s||s.length===0?null:e.jsx("section",{className:"py-12 bg-dark-950 border-y border-dark-800",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsx("p",{className:"text-center text-gray-500 text-sm font-medium mb-8 tracking-wider uppercase",children:"Trusted by Leading Organizations"}),e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-8 md:gap-12",children:s.map((a,t)=>e.jsx("div",{className:"flex items-center justify-center h-12 px-4 opacity-60 hover:opacity-100 transition-opacity grayscale hover:grayscale-0",children:a.logo_url?e.jsx("img",{src:G(a.logo_url),alt:a.name,className:"h-full w-auto object-contain"}):e.jsx("span",{className:"text-xl font-bold text-gray-400",children:a.name})},t))})]})})}function Mt(){const[s,a]=i.useState([]),[t,r]=i.useState([]),[o,n]=i.useState(!0),[c,d]=i.useState(null),[m,p]=i.useState(""),[u,w]=i.useState("all");i.useEffect(()=>{g(),v()},[]);const g=async()=>{try{const l=await yt();a(l||[])}catch(l){d("Failed to load events"),console.error(l)}finally{n(!1)}},v=async()=>{try{const{data:l}=await x.from("organizations").select("id, name, display_name, logo_url").eq("active",!0).order("name");r(l||[])}catch(l){console.error("Failed to load organizations:",l)}},k=i.useMemo(()=>{const l=new Map;return s.forEach(h=>{const C=h.org_display_name||h.organization;C&&!l.has(C)&&l.set(C,{display:C,original:h.organization})}),Array.from(l.keys()).sort()},[s]),j=i.useMemo(()=>{let l=s;if(u!=="all"&&(l=l.filter(h=>(h.org_display_name||h.organization)===u)),m.trim()){const h=m.toLowerCase();l=l.filter(C=>C.title?.toLowerCase().includes(h)||C.organization?.toLowerCase().includes(h)||C.org_display_name?.toLowerCase().includes(h)||C.venue?.toLowerCase().includes(h))}return l},[s,u,m]),f=new Date,y=j.filter(l=>l.status==="live"||l.is_live),$=j.filter(l=>new Date(l.start_time)>f&&l.status!=="ended"&&l.status!=="live"&&!l.is_live).sort((l,h)=>new Date(l.start_time)-new Date(h.start_time)),_=$.filter(l=>(new Date(l.start_time)-f)/36e5<=168),N=$.filter(l=>(new Date(l.start_time)-f)/36e5>168),E=j.filter(l=>l.status==="ended"||new Date(l.end_time)<f).sort((l,h)=>new Date(h.start_time)-new Date(l.start_time)),P=y[0]||$[0],S=m||u!=="all";return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-red-500 mx-auto mb-6"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Loading events..."})]})}):c?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4 text-lg",children:c}),e.jsx("button",{onClick:g,className:"px-6 py-3 bg-red-500 hover:bg-red-600 text-white font-bold rounded-lg transition-colors",children:"Try Again"})]})}):e.jsxs("div",{className:"min-h-screen bg-black",children:[P&&!S&&e.jsx(At,{event:P}),!S&&e.jsx(Pt,{}),!S&&e.jsx(Ot,{organizations:t}),e.jsxs("div",{id:"upcoming-events",className:"bg-dark-950",children:[e.jsx("div",{className:"sticky top-16 sm:top-20 z-20 bg-dark-950/95 backdrop-blur-md border-b border-dark-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search events, organizations, venues...",value:m,onChange:l=>p(l.target.value),className:"w-full pl-10 pr-10 py-2.5 bg-dark-800 border border-dark-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"}),m&&e.jsx("button",{onClick:()=>p(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-white transition-colors",children:e.jsx(Ke,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[e.jsx("button",{onClick:()=>w("all"),className:`flex-shrink-0 px-4 py-2 rounded-lg font-medium transition-all ${u==="all"?"bg-red-500 text-white":"bg-dark-800 text-gray-400 hover:bg-dark-700 hover:text-white"}`,children:"All Events"}),k.map(l=>e.jsx("button",{onClick:()=>w(l),className:`flex-shrink-0 px-4 py-2 rounded-lg font-medium transition-all ${u===l?"bg-red-500 text-white":"bg-dark-800 text-gray-400 hover:bg-dark-700 hover:text-white"}`,children:l},l))]}),e.jsxs(ae,{to:"/my-purchases",className:"flex-shrink-0 flex items-center justify-center gap-2 px-4 py-2 bg-dark-800 hover:bg-dark-700 text-white rounded-lg transition-colors",children:[e.jsx(we,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"My Purchases"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[!S&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white",children:"Upcoming Events"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Don't miss the action â€” secure your tickets now"})]}),S&&e.jsx("div",{className:"mb-6",children:e.jsxs("p",{className:"text-gray-400",children:[j.length," ",j.length===1?"event":"events"," found",m&&e.jsxs("span",{children:[' for "',m,'"']}),u!=="all"&&e.jsxs("span",{children:[" in ",u]})]})}),y.length>0&&e.jsxs("section",{className:"mb-10",children:[e.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),"Live Now"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:y.map(l=>e.jsx(Ie,{event:l},l.id))})]}),_.length>0&&!S&&e.jsx(Ce,{title:"This Week",events:_,icon:e.jsx(Z,{className:"w-5 h-5 text-amber-500"})}),N.length>0&&!S&&e.jsx(Ce,{title:"Coming Soon",events:N,icon:e.jsx(Q,{className:"w-5 h-5 text-blue-500"})}),S&&$.length>0&&e.jsxs("section",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white mb-4",children:"Upcoming Events"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map(l=>e.jsx(Ie,{event:l},l.id))})]}),E.filter(l=>l.mux_playback_id).length>0&&e.jsx(Ce,{title:"Replays Available",events:E.filter(l=>l.mux_playback_id),icon:e.jsx(q,{className:"w-5 h-5 text-green-500"})}),j.length===0&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-dark-800 flex items-center justify-center mx-auto mb-4",children:e.jsx(Me,{className:"w-8 h-8 text-gray-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No events found"}),e.jsx("p",{className:"text-gray-400 mb-6",children:m?`No events match "${m}"`:u!=="all"?`No events from ${u}`:"No events scheduled yet. Check back soon!"}),S&&e.jsx("button",{onClick:()=>{p(""),w("all")},className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:"Clear Filters"})]})]})]}),!S&&e.jsx("section",{className:"py-20 bg-gradient-to-b from-dark-950 to-black",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Want Your Event Livestreamed?"}),e.jsx("p",{className:"text-xl text-gray-400 mb-8",children:"Professional multi-camera production with global reach. Let's talk."}),e.jsxs(ae,{to:"/work-with-us",className:"inline-flex items-center gap-2 px-8 py-4 bg-white text-black font-bold text-lg rounded-xl hover:bg-gray-100 transition-all hover:scale-105",children:["Work With Us",e.jsx(Qe,{className:"w-5 h-5"})]})]})})]})}const Gs=Object.freeze(Object.defineProperty({__proto__:null,default:Mt},Symbol.toStringTag,{value:"Module"})),Ut=()=>{let s=localStorage.getItem("ffm_session_id");return s||(s="sess_"+Math.random().toString(36).substring(2)+Date.now().toString(36),localStorage.setItem("ffm_session_id",s)),s},re=async(s,a=null,t={})=>{try{await x.from("livestream_analytics").insert({event_type:s,event_id:a,session_id:Ut(),device_type:/mobile/i.test(navigator.userAgent)?"mobile":/tablet|ipad/i.test(navigator.userAgent)?"tablet":"desktop",user_agent:navigator.userAgent?.substring(0,500),...t,created_at:new Date().toISOString()})}catch(r){console.warn("Analytics tracking failed:",r.message)}},Ft=s=>re("page_view",s),zt=s=>re("geo_check",s),Rt=(s,a,t,r,o,n,c,d)=>re("geo_blocked",s,{blocked_distance_km:a,venue_lat:t,venue_lng:r,block_radius_km:o,latitude:n,longitude:c,accuracy_meters:d}),qt=(s,a,t,r)=>re("geo_passed",s,{latitude:a,longitude:t,accuracy_meters:r}),qe=s=>re("purchase_view",s),Wt=(s,a)=>re("checkout_start",s,{customer_email:a}),Vt=(s,a,t)=>re("purchase_complete",s,{customer_email:a,customer_id:t});function Bt(s){if(!s||typeof s!="string")return null;const a=s.toLowerCase().trim();return a.length<5||a.length>254||!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)||/<[^>]*>/.test(a)?null:a}const De=new Map;function Gt(s,a=5,t=6e4){const r=Date.now(),o=De.get(s);return o?r-o.start>t?(De.set(s,{count:1,start:r}),{allowed:!0,remaining:a-1}):o.count>=a?{allowed:!1,remaining:0,waitSeconds:Math.ceil((o.start+t-r)/1e3)}:(o.count++,{allowed:!0,remaining:a-o.count}):(De.set(s,{count:1,start:r}),{allowed:!0,remaining:a-1})}function Ye({targetDate:s,onComplete:a,className:t=""}){const r=g=>{if(!g)return new Date;const v=g.replace(/[Z+].*$/,"").replace(/\.000$/,"");return new Date(v)},o=()=>{const g=r(s)-new Date;return g<=0?null:{days:Math.floor(g/864e5),hours:Math.floor(g/36e5%24),minutes:Math.floor(g/1e3/60%60),seconds:Math.floor(g/1e3%60)}},[n,c]=i.useState(o()),[d,m]=i.useState(null),p=i.useRef(!1);if(i.useEffect(()=>{p.current=!1;const g=setInterval(()=>{const v=o();m(n),c(v),!v&&a&&!p.current&&(p.current=!0,a())},1e3);return()=>clearInterval(g)},[s]),!n)return e.jsx("div",{className:`text-center ${t}`,children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white font-bold rounded-full animate-pulse",children:[e.jsx("span",{className:"w-3 h-3 bg-white rounded-full animate-ping"}),"Event Starting Now"]})});const u=({value:g,label:v,prevValue:k})=>{const j=k!==void 0&&k!==g;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"relative w-12 h-14 sm:w-16 sm:h-20 md:w-24 md:h-28 perspective-1000",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-dark-700 to-dark-800 rounded-lg shadow-xl border border-dark-600",children:e.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-px bg-dark-900/50"})}),e.jsx("div",{className:`relative z-10 w-full h-full flex items-center justify-center ${j?"animate-flip":""}`,children:e.jsx("span",{className:"text-xl sm:text-3xl md:text-5xl font-bold text-white tabular-nums tracking-tight",children:String(g).padStart(2,"0")})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/5 to-transparent rounded-lg pointer-events-none"})]})}),e.jsx("span",{className:"text-[9px] sm:text-xs md:text-sm text-gray-500 mt-1 sm:mt-2 uppercase tracking-normal sm:tracking-widest font-medium",children:v})]})},w=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 sm:gap-2 px-0.5 sm:px-1 md:px-3 h-14 sm:h-20 md:h-28",children:[e.jsx("div",{className:"w-1 h-1 sm:w-2 sm:h-2 rounded-full bg-red-500 animate-pulse"}),e.jsx("div",{className:"w-1 h-1 sm:w-2 sm:h-2 rounded-full bg-red-500 animate-pulse",style:{animationDelay:"0.5s"}})]});return e.jsxs("div",{className:`${t} overflow-x-hidden`,children:[e.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm uppercase tracking-widest font-medium",children:"â±ï¸ Event Starts In"}),e.jsxs("div",{className:"flex items-start justify-center overflow-x-hidden",children:[n.days>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{value:n.days,label:"Days",prevValue:d?.days}),e.jsx(w,{})]}),e.jsx(u,{value:n.hours,label:"Hours",prevValue:d?.hours}),e.jsx(w,{}),e.jsx(u,{value:n.minutes,label:"Mins",prevValue:d?.minutes}),e.jsx(w,{}),e.jsx(u,{value:n.seconds,label:"Secs",prevValue:d?.seconds})]}),n.days===0&&n.hours<2&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-500/10 border border-red-500/20 rounded-full text-red-400 text-sm",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"Starting soon â€” Don't miss it!"]})})]})}function Ht({price:s,originalPrice:a=null,currency:t="AUD",email:r,onEmailChange:o,onPurchase:n,purchasing:c=!1,error:d=null,demoMode:m=!1,isLive:p=!1,isPast:u=!1,isVod:w=!1,vodExpired:g=!1,className:v=""}){const[k,j]=i.useState(!1),f=a?Math.round((1-s/a)*100):null,_=w?[{icon:tt,text:"Instant access to full replay",highlight:!0},{icon:xe,text:"Watch anytime, any device",highlight:!0},{icon:$e,text:"HD quality streaming",highlight:!0},{icon:Se,text:"Secure payment via Stripe",highlight:!0}]:[{icon:Le,text:"Instant access after payment",highlight:!0},{icon:q,text:"Watch live + replay for 7 days",highlight:!0},{icon:$e,text:"HD quality streaming",highlight:!0},{icon:Se,text:"Secure payment via Stripe",highlight:!0}];return g?e.jsxs("div",{className:`relative ${v}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-500/10 to-gray-500/10 blur-xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/90 backdrop-blur-xl border border-dark-700/50 rounded-2xl overflow-hidden p-8 text-center",children:[e.jsx(xe,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Replay No Longer Available"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"The VOD replay for this event has expired."})]})]}):u&&!w?e.jsxs("div",{className:`relative ${v}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-500/10 to-gray-500/10 blur-xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/90 backdrop-blur-xl border border-dark-700/50 rounded-2xl overflow-hidden p-8 text-center",children:[e.jsx(q,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Event Has Ended"}),e.jsx("p",{className:"text-gray-400",children:"This event has concluded and replay is not available."})]})]}):e.jsxs("div",{className:`relative ${v}`,children:[e.jsx("div",{className:`absolute inset-0 blur-xl rounded-3xl ${w?"bg-gradient-to-r from-blue-500/20 to-purple-500/20":"bg-gradient-to-r from-red-500/20 to-orange-500/20"}`}),e.jsxs("div",{className:"relative bg-dark-900/90 backdrop-blur-xl border border-dark-700/50 rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-dark-800 to-dark-800/50 px-6 py-4 border-b border-dark-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 font-medium flex items-center gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4 text-blue-400"}),"VOD Replay"]}):"Stream Access"}),w&&e.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs font-bold rounded-full",children:"REPLAY"}),f&&!w&&e.jsxs("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs font-bold rounded-full",children:[f,"% OFF"]})]}),e.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-4xl font-bold text-white",children:["$",s]}),e.jsx("span",{className:"text-lg text-gray-500",children:t}),a&&e.jsxs("span",{className:"text-lg text-gray-600 line-through",children:["$",a]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Email Address"}),e.jsxs("div",{className:`relative transition-all duration-300 ${k?"scale-[1.02]":""}`,children:[e.jsx(ve,{className:`absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 transition-colors ${k?"text-red-500":"text-gray-500"}`}),e.jsx("input",{type:"email",value:r,onChange:N=>o(N.target.value),onFocus:()=>j(!0),onBlur:()=>j(!1),placeholder:"your@email.com",className:`w-full pl-12 pr-4 py-4 bg-dark-800/50 border rounded-xl text-white placeholder-gray-500 outline-none transition-all duration-300 ${k?"border-red-500 ring-2 ring-red-500/20":"border-dark-700 hover:border-dark-600"}`,required:!0})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),"Your access link will be sent here"]})]}),d&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-red-400 text-sm",children:d})}),e.jsx("button",{onClick:n,disabled:c||!r,className:`w-full py-4 rounded-xl font-bold text-lg transition-all duration-300 flex items-center justify-center gap-3 ${c||!r?"bg-dark-700 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-lg shadow-red-500/25 hover:shadow-red-500/40 hover:scale-[1.02] active:scale-[0.98]"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[w?e.jsx(xe,{className:"w-5 h-5"}):e.jsx(et,{className:"w-5 h-5"}),w?"Buy Replay Access":u?"Event Ended":p?"Watch Now":"Buy Access"]})}),e.jsx("div",{className:"mt-6 space-y-3",children:_.map((N,E)=>e.jsxs("div",{className:`flex items-center gap-3 text-sm ${N.highlight?"text-white":"text-gray-400"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${N.highlight?"bg-green-500/20 text-green-400":"bg-dark-700 text-gray-500"}`,children:e.jsx(Ae,{className:"w-3 h-3"})}),N.text]},E))}),m&&e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:n,disabled:c||!r,className:"w-full py-3 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border border-yellow-500/30 text-yellow-400 font-semibold rounded-xl hover:from-yellow-500/30 hover:to-orange-500/30 transition-all duration-300 flex items-center justify-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"}),"Demo Mode â€” No payment required"]})})]}),e.jsx("div",{className:"px-6 py-4 bg-dark-800/30 border-t border-dark-700/30",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),"SSL Secured"]}),e.jsx("div",{className:"w-1 h-1 bg-gray-600 rounded-full"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Se,{className:"w-3 h-3"}),"Stripe Payments"]}),e.jsx("div",{className:"w-1 h-1 bg-gray-600 rounded-full"}),e.jsx("span",{children:"ðŸ‡¦ðŸ‡º Australian Business"})]})})]})]})}function Zt({url:s,title:a,description:t,className:r=""}){const[o,n]=i.useState(!1),[c,d]=i.useState(!1),m=s||window.location.href,p=a||document.title,u=t||"",w={twitter:`https://twitter.com/intent/tweet?text=${encodeURIComponent(p)}&url=${encodeURIComponent(m)}`,facebook:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(m)}`,whatsapp:`https://wa.me/?text=${encodeURIComponent(p+" "+m)}`},g=async()=>{try{await navigator.clipboard.writeText(m),n(!0),setTimeout(()=>n(!1),2e3)}catch(k){console.error("Failed to copy:",k)}},v=async()=>{if(navigator.share)try{await navigator.share({title:p,text:u,url:m})}catch{d(!0)}else d(!c)};return e.jsxs("div",{className:`relative ${r}`,children:[e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-dark-800 hover:bg-dark-700 border border-dark-700 rounded-lg text-gray-300 hover:text-white transition-colors",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Share Event"})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-dark-800 border border-dark-700 rounded-lg shadow-xl z-50 overflow-hidden",children:[e.jsxs("a",{href:w.twitter,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors",onClick:()=>d(!1),children:[e.jsx(st,{className:"w-4 h-4 text-[#1DA1F2]"}),e.jsx("span",{className:"text-sm",children:"Twitter"})]}),e.jsxs("a",{href:w.facebook,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors",onClick:()=>d(!1),children:[e.jsx(at,{className:"w-4 h-4 text-[#4267B2]"}),e.jsx("span",{className:"text-sm",children:"Facebook"})]}),e.jsxs("a",{href:w.whatsapp,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors",onClick:()=>d(!1),children:[e.jsx(rt,{className:"w-4 h-4 text-[#25D366]"}),e.jsx("span",{className:"text-sm",children:"WhatsApp"})]}),e.jsxs("button",{onClick:()=>{g(),d(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors w-full border-t border-dark-700",children:[e.jsx(nt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:o?"Copied!":"Copy Link"})]})]})]})]})}function Yt({title:s,description:a,image:t,url:r,type:o="website"}){return i.useEffect(()=>{s&&(document.title=`${s} | Fit Focus Media`);const n=(c,d)=>{if(!d)return;let m=document.querySelector(`meta[property="${c}"]`)||document.querySelector(`meta[name="${c}"]`);m||(m=document.createElement("meta"),c.startsWith("og:")||c.startsWith("twitter:")?m.setAttribute("property",c):m.setAttribute("name",c),document.head.appendChild(m)),m.setAttribute("content",d)};return n("og:title",s),n("og:description",a),n("og:image",t),n("og:url",r||window.location.href),n("og:type",o),n("twitter:card","summary_large_image"),n("twitter:title",s),n("twitter:description",a),n("twitter:image",t),n("description",a),()=>{document.title="Fit Focus Media"}},[s,a,t,r,o]),null}function Jt({event:s,className:a=""}){const[t,r]=i.useState(!1);if(!s)return null;const o=f=>{if(!f)return new Date;const y=f.replace(/[Z+].*$/,"").replace(/\.000$/,"");return new Date(y)},n=o(s.start_time),c=s.end_time?o(s.end_time):new Date(n.getTime()+10800*1e3),d=f=>{const y=l=>String(l).padStart(2,"0"),$=f.getFullYear(),_=y(f.getMonth()+1),N=y(f.getDate()),E=y(f.getHours()),P=y(f.getMinutes()),S=y(f.getSeconds());return`${$}${_}${N}T${E}${P}${S}`},m=f=>{const y=l=>String(l).padStart(2,"0"),$=f.getFullYear(),_=y(f.getMonth()+1),N=y(f.getDate()),E=y(f.getHours()),P=y(f.getMinutes()),S=y(f.getSeconds());return`${$}${_}${N}T${E}${P}${S}`},p=encodeURIComponent(s.title),u=encodeURIComponent(`${s.org_display_name||s.organization}

Watch live at: https://fitfocusmedia.com.au/#/live/${s.id}`),w=encodeURIComponent(s.venue||"Online"),g=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${p}&dates=${d(n)}/${d(c)}&details=${u}&location=${w}`,v=f=>{const y=l=>String(l).padStart(2,"0"),$=f.getFullYear(),_=y(f.getMonth()+1),N=y(f.getDate()),E=y(f.getHours()),P=y(f.getMinutes()),S=y(f.getSeconds());return`${$}-${_}-${N}T${E}:${P}:${S}`},k=`https://outlook.live.com/calendar/0/deeplink/compose?subject=${p}&startdt=${encodeURIComponent(v(n))}&enddt=${encodeURIComponent(v(c))}&body=${u}&location=${w}`,j=()=>{const f=`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Fit Focus Media//Livestream//EN
BEGIN:VEVENT
UID:${s.id}@fitfocusmedia.com.au
DTSTAMP:${m(new Date)}
DTSTART:${m(n)}
DTEND:${m(c)}
SUMMARY:${s.title}
DESCRIPTION:${s.org_display_name||s.organization}\\n\\nWatch live at: https://fitfocusmedia.com.au/#/live/${s.id}
LOCATION:${s.venue||"Online"}
END:VEVENT
END:VCALENDAR`,y=new Blob([f],{type:"text/calendar;charset=utf-8"}),$=URL.createObjectURL(y),_=document.createElement("a");_.href=$,_.download=`${s.title.replace(/[^a-z0-9]/gi,"_")}.ics`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL($),r(!1)};return e.jsxs("div",{className:`relative ${a}`,children:[e.jsxs("button",{onClick:()=>r(!t),className:"flex items-center gap-2 px-3 sm:px-4 py-2 bg-dark-800 hover:bg-dark-700 border border-dark-700 rounded-lg text-gray-300 hover:text-white transition-colors",title:"Add to Calendar",children:[e.jsx(Z,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:"Add to Calendar"}),e.jsx(lt,{className:`w-4 h-4 flex-shrink-0 transition-transform ${t?"rotate-180":""}`})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>r(!1)}),e.jsxs("div",{className:"absolute left-0 sm:right-0 sm:left-auto mt-2 w-48 bg-dark-800 border border-dark-700 rounded-lg shadow-xl z-50 overflow-hidden",children:[e.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors",onClick:()=>r(!1),children:[e.jsx("span",{className:"text-lg",children:"ðŸ“…"}),e.jsx("span",{className:"text-sm",children:"Google Calendar"})]}),e.jsxs("button",{onClick:j,className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors w-full",children:[e.jsx("span",{className:"text-lg",children:"ðŸŽ"}),e.jsx("span",{className:"text-sm",children:"Apple Calendar"})]}),e.jsxs("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-4 py-3 hover:bg-dark-700 text-gray-300 hover:text-white transition-colors",onClick:()=>r(!1),children:[e.jsx("span",{className:"text-lg",children:"ðŸ“§"}),e.jsx("span",{className:"text-sm",children:"Outlook"})]})]})]})]})}function Kt(){const{eventId:s}=Ve(),[a]=Pe(),[t,r]=i.useState(null),[o,n]=i.useState({demo_mode:!1}),[c,d]=i.useState(""),[m,p]=i.useState(!0),[u,w]=i.useState(!1),[g,v]=i.useState(null),[k,j]=i.useState(null),[f,y]=i.useState(null),[$,_]=i.useState(!1),[N,E]=i.useState(!1),[P,S]=i.useState(!1),[l,h]=i.useState(!1),[C,V]=i.useState(null),[z,ne]=i.useState(!1),I=i.useRef({pageView:!1,geoCheck:!1,purchaseView:!1});i.useEffect(()=>{he(),I.current.pageView||(Ft(s),I.current.pageView=!0)},[s]),i.useEffect(()=>{t&&t.geo_blocking_enabled?Ne():t&&!t.geo_blocking_enabled&&(h(!0),I.current.purchaseView||(qe(s),I.current.purchaseView=!0))},[t]);const Ne=async()=>{try{const L=await navigator.permissions.query({name:"geolocation"});L.state==="granted"?W():L.state==="denied"?(S(!0),h(!0)):E(!0)}catch{E(!0)}},W=()=>{_(!0),E(!1),I.current.geoCheck||(zt(s),I.current.geoCheck=!0),navigator.geolocation.getCurrentPosition(async L=>{const O=L.coords.latitude,F=L.coords.longitude,M=L.coords.accuracy;try{const Y=a.get("bypass"),R=await(await fetch("https://gonalgubgldgpkcekaxe.supabase.co/functions/v1/geo-check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({venue_lat:t.geo_lat,venue_lng:t.geo_lng,radius_km:t.geo_radius_km||50,user_lat:O,user_lng:F,event_id:s,bypass_token:Y})})).json();R.bypass?(j(!1),y({...R,crew_bypass:!0})):(j(R.blocked),y(R)),V({lat:O,lng:F,distance_km:R.distance_km,accuracy_meters:M}),R.blocked?Rt(s,R.distance_km,t.geo_lat,t.geo_lng,t.geo_radius_km,O,F,M):(qt(s,O,F,M),I.current.purchaseView||(qe(s),I.current.purchaseView=!0))}catch(Y){console.error("Geo check failed:",Y),j(!1),V({lat:O,lng:F})}finally{_(!1),h(!0)}},L=>{console.error("Geolocation error:",L),L.code===L.PERMISSION_DENIED&&S(!0),_(!1),h(!0)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},X=()=>{W()},he=async()=>{try{const[L,O]=await Promise.all([Te(s),Nt()]);r(L),n(O||{demo_mode:!1})}catch(L){v("Event not found"),console.error(L)}finally{p(!1)}},le=async L=>{L&&L.preventDefault();const O=Bt(c);if(!O){v("Please enter a valid email address");return}const F=Gt(`checkout:${O}`,3,6e4);if(!F.allowed){v(`Too many attempts. Please wait ${F.waitSeconds} seconds.`);return}w(!0),v(null),Wt(s,O);try{const M="https://gonalgubgldgpkcekaxe.supabase.co/functions/v1/livestream_checkout",Y=t.end_time?new Date(t.end_time):null,K=new Date(t.start_time),R=new Date(K.getTime()+480*60*1e3),_e=(Y?new Date>Y:new Date>R)&&t.vod_enabled&&t.vod_playback_id,be=await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:s,email:O,buyer_lat:C?.lat,buyer_lng:C?.lng,distance_from_venue_km:C?.distance_km,is_vod_purchase:_e})}),J=await be.json();if(!be.ok)throw new Error(J.error||`Checkout failed (${be.status})`);if(J.demo&&J.redirect)window.location.href=J.redirect;else if(J.url)window.location.href=J.url;else throw new Error(J.error||"Checkout failed")}catch(M){console.error("Checkout error:",M),v("Unable to process your request. Please try again or contact support.")}finally{w(!1)}};if(m)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-dark-700 border-t-red-500 mx-auto"}),e.jsx(ye,{className:"absolute inset-0 m-auto w-6 h-6 text-red-500 animate-pulse"})]}),e.jsx("p",{className:"text-gray-400 mt-4",children:"Loading event..."})]})});if(g&&!t)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ue,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Event Not Found"}),e.jsx("p",{className:"text-gray-400",children:g})]})});if(N&&t?.geo_blocking_enabled)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500/20 to-orange-500/20 blur-2xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-red-500/20 to-orange-500/20 flex items-center justify-center",children:e.jsx(it,{className:"w-10 h-10 text-red-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Location Verification"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"To protect ticket sales at the venue, we verify your location before streaming."}),e.jsxs("p",{className:"text-gray-500 text-sm mb-6",children:["Online streaming is restricted within ",t.geo_radius_km||50,"km of ",t.venue,"."]}),e.jsxs("label",{className:"flex items-start gap-3 text-left mb-6 cursor-pointer group",children:[e.jsx("div",{className:"relative mt-1",children:e.jsx("input",{type:"checkbox",checked:z,onChange:L=>ne(L.target.checked),className:"w-5 h-5 rounded border-dark-600 bg-dark-800 text-red-500 focus:ring-red-500 focus:ring-offset-dark-900 cursor-pointer"})}),e.jsxs("span",{className:"text-gray-400 text-sm group-hover:text-gray-300 transition-colors",children:["I agree to the"," ",e.jsx("a",{href:"/#/privacy",target:"_blank",className:"text-red-500 hover:text-red-400 underline",children:"Privacy Policy"})," ","and"," ",e.jsx("a",{href:"/#/terms",target:"_blank",className:"text-red-500 hover:text-red-400 underline",children:"Terms of Service"})]})]}),e.jsxs("button",{onClick:X,disabled:!z,className:"w-full py-4 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 disabled:from-dark-700 disabled:to-dark-700 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-2 shadow-lg shadow-red-500/25 disabled:shadow-none",children:[e.jsx(H,{className:"w-5 h-5"}),"Enable Location Access"]}),e.jsx("p",{className:"text-gray-600 text-xs mt-4",children:'Click "Allow" when your browser asks for permission'})]})]})});if(P&&t?.geo_blocking_enabled)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 p-8 text-center",children:[e.jsx(Ue,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Location Access Blocked"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Location access is required to verify you're not at the venue."}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-4 mb-6 text-left border border-dark-700/50",children:[e.jsx("p",{className:"text-white font-semibold mb-2",children:"To enable location:"}),e.jsxs("ol",{className:"text-gray-400 text-sm space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500 font-bold",children:"1."}),"Click the ðŸ”’ icon in your address bar"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500 font-bold",children:"2."}),'Find "Location" and change it to "Allow"']}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500 font-bold",children:"3."}),"Click the button below to try again"]})]})]}),e.jsx("button",{onClick:()=>{S(!1),E(!0)},className:"w-full py-4 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold rounded-xl transition-all duration-300 shadow-lg shadow-red-500/25",children:"Try Again"})]})});if($)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-dark-700 border-t-red-500 mx-auto"}),e.jsx(H,{className:"absolute inset-0 m-auto w-6 h-6 text-red-500"})]}),e.jsx("p",{className:"text-gray-400 mt-4",children:"Verifying your location..."}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"This only takes a moment"})]})});if(k)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 blur-2xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-yellow-500/20 to-orange-500/20 flex items-center justify-center",children:e.jsx(H,{className:"w-10 h-10 text-yellow-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"You're Close to the Venue!"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:["Online streaming is not available within ",t.geo_radius_km||50,"km of the venue."]}),f?.user_location&&e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:["Distance from venue: ",e.jsxs("span",{className:"text-white font-semibold",children:[f.distance_km,"km"]})]}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-4 mb-6 border border-dark-700/50",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Great news â€” watch live in person!"}),e.jsx("p",{className:"text-white font-semibold",children:t.venue})]}),t.ticket_url?e.jsxs("a",{href:t.ticket_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold rounded-xl transition-all duration-300 shadow-lg shadow-red-500/25",children:[e.jsx(q,{className:"w-5 h-5"}),"Get Tickets"]}):e.jsx("p",{className:"text-gray-500",children:"Contact the venue for ticket information."})]})]})});const oe=L=>{if(!L)return new Date;const O=L.replace(/[Z+].*$/,"").replace(/\.000$/,"");return new Date(O)},ee=oe(t.start_time),ie=t.is_live||t.status==="live",ge=t.end_time?oe(t.end_time):null,ke=new Date(ee.getTime()+480*60*1e3),ce=t.status==="ended"||(ge?ge<new Date:ke<new Date),de=ce&&t.vod_enabled&&t.vod_playback_id,fe=t.vod_available_until&&new Date(t.vod_available_until)<new Date,pe=t.vod_price||t.price;return e.jsxs(e.Fragment,{children:[e.jsx(Yt,{title:`${t.title} - ${t.org_display_name||t.organization}`,description:`Watch ${t.title} live! ${ee.toLocaleDateString("en-AU")} at ${t.venue}. Stream access $${t.price} AUD.`,image:G(t.thumbnail_url),type:"video.other"}),e.jsx("div",{className:"py-12 md:py-16 px-4",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6 lg:gap-12",children:[e.jsxs("div",{className:"col-span-1 lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"relative w-full aspect-video bg-dark-800 rounded-2xl overflow-hidden group",children:[t.thumbnail_url?e.jsx("img",{src:G(t.thumbnail_url),alt:t.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-dark-800 to-dark-900",children:e.jsx("span",{className:"text-8xl",children:"ðŸŽ¬"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-900 via-transparent to-transparent opacity-60"}),ie&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs("div",{className:"px-4 py-2 bg-red-500 text-white font-bold rounded-full flex items-center gap-2 shadow-lg shadow-red-500/50",children:[e.jsx("span",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"LIVE NOW"]})}),e.jsx("div",{className:"absolute bottom-4 left-4",children:e.jsx("span",{className:"px-3 py-1 bg-dark-900/80 backdrop-blur-sm text-white text-sm font-medium rounded-full border border-dark-700/50",children:t.org_display_name||t.organization})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-2",children:t.title}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[e.jsx(ue,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:t.org_display_name||t.organization}),f?.crew_bypass&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 text-xs font-medium rounded-full",children:"Crew Access"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Jt,{event:t}),e.jsx(Zt,{title:`Watch ${t.title} Live!`,description:`${t.org_display_name||t.organization} - ${ee.toLocaleDateString("en-AU")}`})]})]}),!ie&&!ce&&e.jsx("div",{className:"p-6 md:p-8 bg-dark-800/30 rounded-2xl border border-dark-700/50 backdrop-blur-sm",children:e.jsx(Ye,{targetDate:t.start_time,onComplete:()=>he()})}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-800/30 rounded-xl border border-dark-700/30",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500/10 flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Date"}),e.jsx("p",{className:"text-white font-medium",children:ee.toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short"})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-800/30 rounded-xl border border-dark-700/30",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500/10 flex items-center justify-center",children:e.jsx(Q,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Time"}),e.jsxs("p",{className:"text-white font-medium",children:[ee.toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})," AEST"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-800/30 rounded-xl border border-dark-700/30 sm:col-span-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500/10 flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Venue"}),e.jsx("p",{className:"text-white font-medium",children:t.venue})]})]})]}),t.description&&e.jsxs("div",{className:"p-6 bg-dark-800/20 rounded-2xl border border-dark-700/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($e,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"About This Event"})]}),e.jsx("p",{className:"text-gray-400 leading-relaxed",children:t.description})]})]}),e.jsx("div",{className:"col-span-1 lg:col-span-2",children:e.jsx("div",{className:"lg:sticky lg:top-24",children:e.jsx(Ht,{price:de?pe:t.price,currency:"AUD",email:c,onEmailChange:d,onPurchase:le,purchasing:u,error:g,demoMode:o.demo_mode,isLive:ie,isPast:ce,isVod:de&&!fe,vodExpired:fe})})})]})})})]})}const Hs=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"}));function Qt({playbackId:s,title:a,poster:t,isLive:r=!1,viewerEmail:o="",onShare:n,className:c=""}){const[d,m]=i.useState(!0),[p,u]=i.useState(!1),[w,g]=i.useState(!1),[v,k]=i.useState([]),j=i.useRef(null),f=i.useRef(null);i.useEffect(()=>{const N=()=>{m(!0),clearTimeout(f.current),f.current=setTimeout(()=>{m(!1)},3e3)},E=j.current;if(E)return E.addEventListener("mousemove",N),()=>E.removeEventListener("mousemove",N)},[]),i.useEffect(()=>{const N=()=>{u(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",N),()=>document.removeEventListener("fullscreenchange",N)},[]);const y=()=>{document.fullscreenElement?document.exitFullscreen():j.current?.requestFullscreen()},$=N=>{const E=Date.now(),P={id:E,emoji:N,x:Math.random()*80+10,delay:Math.random()*.5};k(S=>[...S,P]),setTimeout(()=>{k(S=>S.filter(l=>l.id!==E))},3e3)},_=["ðŸ”¥","ðŸ‘","â¤ï¸","ðŸ˜®","ðŸ’ª","ðŸŽ‰"];return e.jsxs("div",{ref:j,className:`relative bg-black group ${c}`,children:[e.jsx(ot,{playbackId:s||"demo-playback-id",metadata:{video_title:a,viewer_user_id:o},streamType:r?"live":"on-demand",autoPlay:!0,poster:t,className:"w-full aspect-video"}),r&&e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-red-500 text-white font-bold rounded-full animate-glow",children:[e.jsx("span",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"LIVE"]})}),e.jsx("div",{className:"absolute bottom-20 right-4 pointer-events-none overflow-hidden h-64 w-16",children:v.map(N=>e.jsx("div",{className:"absolute animate-float text-3xl",style:{left:`${N.x}%`,animationDelay:`${N.delay}s`,bottom:0},children:N.emoji},N.id))}),w&&e.jsx("div",{className:"absolute bottom-20 right-4 z-20 animate-scaleIn",children:e.jsx("div",{className:"bg-dark-900/90 backdrop-blur-sm rounded-2xl p-3 border border-dark-700",children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:_.map((N,E)=>e.jsx("button",{onClick:()=>$(N),className:"w-12 h-12 rounded-xl bg-dark-800 hover:bg-dark-700 flex items-center justify-center text-2xl transition-transform hover:scale-110 active:scale-95",children:N},N))})})}),e.jsx("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-4 transition-opacity duration-300 ${d?"opacity-100":"opacity-0"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:n,className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Share",children:e.jsx(We,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("button",{onClick:()=>g(!w),className:`p-2 rounded-lg transition-colors ${w?"bg-red-500 text-white":"bg-white/10 hover:bg-white/20 text-white"}`,title:"Reactions",children:e.jsx(ye,{className:"w-5 h-5"})}),e.jsx("button",{onClick:y,className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors",title:p?"Exit Fullscreen":"Fullscreen",children:p?e.jsx(ct,{className:"w-5 h-5"}):e.jsx(dt,{className:"w-5 h-5"})})]})]})}),e.jsx("div",{className:`absolute top-0 left-0 right-0 bg-gradient-to-b from-black/70 to-transparent p-4 transition-opacity duration-300 ${d?"opacity-100":"opacity-0"}`,children:e.jsx("h2",{className:"text-white font-semibold text-lg truncate pr-20",children:a})}),e.jsx("style",{jsx:!0,children:`
        @keyframes float {
          0% {
            transform: translateY(0) scale(1);
            opacity: 1;
          }
          100% {
            transform: translateY(-200px) scale(1.5);
            opacity: 0;
          }
        }
        .animate-float {
          animation: float 3s ease-out forwards;
        }
      `})]})}function Xt({isLive:s=!1,viewerCount:a=0,showViewers:t=!0,size:r="default",className:o=""}){const[n,c]=i.useState(a),[d,m]=i.useState(!1);i.useEffect(()=>{a>n&&(m(!0),setTimeout(()=>m(!1),1e3));const w=a-n;if(Math.abs(w)>10){const g=Math.ceil(w/10),v=setInterval(()=>{c(k=>{const j=k+g;return g>0&&j>=a||g<0&&j<=a?(clearInterval(v),a):j})},50);return()=>clearInterval(v)}else c(a)},[a]);const u={small:{container:"px-2 py-1 text-xs gap-1.5",dot:"w-1.5 h-1.5",icon:"w-3 h-3"},default:{container:"px-3 py-1.5 text-sm gap-2",dot:"w-2 h-2",icon:"w-4 h-4"},large:{container:"px-4 py-2 text-base gap-2.5",dot:"w-2.5 h-2.5",icon:"w-5 h-5"}}[r];return s?e.jsxs("div",{className:`flex items-center gap-3 ${o}`,children:[e.jsxs("div",{className:`inline-flex items-center ${u.container} bg-gradient-to-r from-red-600 to-red-500 text-white font-bold rounded-full shadow-lg shadow-red-500/25`,children:[e.jsx("span",{className:`${u.dot} bg-white rounded-full animate-pulse`}),e.jsx("span",{className:"uppercase tracking-wide",children:"Live"})]}),t&&n>0&&e.jsxs("div",{className:`inline-flex items-center ${u.container} bg-dark-800/90 backdrop-blur-sm text-white rounded-full border border-dark-700`,children:[e.jsx(Be,{className:`${u.icon} text-gray-400`}),e.jsx("span",{className:`font-semibold tabular-nums ${d?"text-green-400":""}`,children:n.toLocaleString()}),d&&e.jsx(mt,{className:`${u.icon} text-green-400 animate-bounce`})]})]}):null}function es({eventId:s,className:a=""}){const[t,r]=i.useState(null),[o,n]=i.useState(!0);i.useEffect(()=>{if(!s)return;c();const m=setInterval(c,3e4);return()=>clearInterval(m)},[s]);const c=async()=>{try{const m=new Date(Date.now()-12e4).toISOString(),{count:p,error:u}=await x.from("livestream_sessions").select("*",{count:"exact",head:!0}).eq("event_id",s).gte("last_heartbeat",m);u||r(p||0)}catch(m){console.error("Failed to fetch viewer count:",m)}finally{n(!1)}};if(o||t===null)return null;const d=m=>m>=1e3?`${(m/1e3).toFixed(1)}k`:m.toString();return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 bg-dark-800/80 backdrop-blur-sm rounded-full ${a}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"w-4 h-4 text-red-500"}),t>0&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full animate-pulse"})]}),e.jsx("span",{className:"text-sm font-medium text-white",children:d(t)}),e.jsx("span",{className:"text-sm text-gray-400",children:t===1?"viewer":"viewers"})]})}function ts({streams:s,selectedStream:a,onSelect:t,isLive:r=!1}){const[o,n]=i.useState({});if(i.useEffect(()=>{if(!s||s.length===0)return;const d=async()=>{const p=s.filter(u=>u.mux_stream_id);if(p.length!==0)try{const u=await Promise.all(p.map(async g=>{try{const{data:v,error:k}=await x.functions.invoke("mux-stream",{body:{action:"stream-status",mux_stream_id:g.mux_stream_id}});if(!k&&v)return{id:g.id,isLive:v.isLive,status:v.status}}catch(v){console.warn("Failed to fetch stream status:",v)}return{id:g.id,isLive:!1,status:"unknown"}})),w={};u.forEach(g=>{w[g.id]=g}),n(w)}catch(u){console.error("Failed to fetch stream statuses:",u)}};d();const m=setInterval(d,3e4);return()=>clearInterval(m)},[s]),!s||s.length<=1)return null;const c=d=>o[d.id]?o[d.id].isLive:d.status==="live"||d.status==="active";return e.jsxs("div",{className:"bg-dark-900/80 backdrop-blur-sm rounded-xl border border-dark-700 p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(se,{className:"w-5 h-5 text-red-500"}),e.jsx("h3",{className:"text-white font-semibold",children:"Select Stream"}),r&&e.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-red-500/20 text-red-500 text-xs font-medium rounded-full",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"LIVE"]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:s.map(d=>{const m=a?.id===d.id,p=c(d);return e.jsxs("button",{onClick:()=>t(d),className:`relative flex flex-col items-center justify-center p-4 rounded-lg border-2 transition-all ${m?"border-red-500 bg-red-500/10":"border-dark-600 bg-dark-800 hover:border-dark-500 hover:bg-dark-700"}`,children:[p&&e.jsx("span",{className:"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full animate-pulse"}),m&&e.jsx("div",{className:"absolute top-2 left-2 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx(Ae,{className:"w-3 h-3 text-white"})}),e.jsx(Ge,{className:`w-8 h-8 mb-2 ${m?"text-red-500":"text-gray-400"}`}),e.jsx("span",{className:`text-sm font-medium ${m?"text-white":"text-gray-300"}`,children:d.name}),e.jsx("span",{className:`text-xs mt-1 ${p?"text-red-400":"text-gray-500"}`,children:p?"Live":"Waiting"})]},d.id)})}),e.jsx("p",{className:"text-xs text-gray-500 mt-3 text-center",children:"You can switch between streams at any time"})]})}function ss({streams:s,selectedStream:a,onSelect:t,liveStatuses:r={}}){const[o,n]=i.useState(!1),[c,d]=i.useState({});if(i.useEffect(()=>{if(!s||s.length===0)return;const u=async()=>{const g=s.filter(v=>v.mux_stream_id);if(g.length!==0)try{const v=await Promise.all(g.map(async j=>{try{const f=await fetch(`${STREAM_STATUS_API}/${j.mux_stream_id}`);if(f.ok){const y=await f.json();return{id:j.id,isLive:y.isLive,status:y.status}}}catch(f){console.warn("Failed to fetch stream status:",f)}return{id:j.id,isLive:!1,status:"unknown"}})),k={};v.forEach(j=>{k[j.id]=j}),d(k)}catch(v){console.error("Failed to fetch stream statuses:",v)}};u();const w=setInterval(u,3e4);return()=>clearInterval(w)},[s]),!s||s.length<=1)return null;const m={...r,...c},p=u=>m[u.id]?m[u.id].isLive:u.status==="live"||u.status==="active";return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>n(!o),className:"flex items-center gap-2 px-3 py-1.5 bg-black/60 hover:bg-black/80 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx(se,{className:"w-4 h-4"}),a?.name||"Select Stream"]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)}),e.jsx("div",{className:"absolute bottom-full left-0 mb-2 w-48 bg-dark-900 border border-dark-700 rounded-lg shadow-xl z-50",children:s.map(u=>{const w=a?.id===u.id,g=p(u);return e.jsxs("button",{onClick:()=>{t(u),n(!1)},className:`w-full flex items-center gap-3 px-4 py-3 text-left transition-colors ${w?"bg-red-500/20 text-white":"text-gray-300 hover:bg-dark-800 hover:text-white"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:`w-5 h-5 ${w?"text-red-500":"text-gray-500"}`}),g&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:u.name}),e.jsx("p",{className:`text-xs ${g?"text-red-400":"text-gray-500"}`,children:g?"Live":"Waiting"})]}),w&&e.jsx(Ae,{className:"w-4 h-4 text-red-500"})]},u.id)})})]})]})}function as(){const{eventId:s}=Ve(),[a]=Pe(),[t,r]=i.useState(null),[o,n]=i.useState(a.get("email")||""),[c,d]=i.useState(null),[m,p]=i.useState(!1),[u,w]=i.useState(!0),[g,v]=i.useState(!1),[k,j]=i.useState(null),[f,y]=i.useState(!1),[$,_]=i.useState(null),[N,E]=i.useState(null),[P,S]=i.useState(!0),[l,h]=i.useState(!1),[C,V]=i.useState(0),z=i.useRef(null),ne=i.useRef(null),[I,Ne]=i.useState([]),[W,X]=i.useState(null),[he,le]=i.useState(!1),[oe,ee]=i.useState({}),[ie,ge]=i.useState(!1),[ke,ce]=i.useState(!1);i.useEffect(()=>{if(!I||I.length===0)return;const b=async()=>{const T=I.filter(U=>U.mux_stream_id);if(T.length!==0)try{const U=await Promise.all(T.map(async A=>{try{const{data:te,error:Je}=await x.functions.invoke("mux-stream",{body:{action:"stream-status",mux_stream_id:A.mux_stream_id}});if(!Je&&te)return{id:A.id,isLive:te.isLive,status:te.status}}catch(te){console.warn("Failed to fetch stream status:",te)}return{id:A.id,isLive:!1,status:"unknown"}})),B={};U.forEach(A=>{B[A.id]=A}),ee(B)}catch(U){console.error("Failed to fetch stream statuses:",U)}};b();const D=setInterval(b,3e4);return()=>clearInterval(D)},[I]);const de=b=>oe[b.id]?oe[b.id].isLive:b.status==="live"||b.status==="active";i.useEffect(()=>(pe(),()=>{z.current&&clearInterval(z.current)}),[s]),i.useEffect(()=>{t&&(a.get("bypass")||t.geo_blocking_enabled?fe():S(!1))},[t]),i.useEffect(()=>{if(!t)return;const b=new Date,D=t.end_time?new Date(t.end_time):null,T=new Date(t.start_time),U=new Date(T.getTime()+480*60*1e3);if((D?b>D:b>U)&&t.vod_enabled&&(ge(!0),t.vod_available_until)){const A=new Date(t.vod_available_until);b>A&&ce(!0)}},[t]);const fe=async()=>{try{const b=a.get("bypass"),T=await(await fetch("https://gonalgubgldgpkcekaxe.supabase.co/functions/v1/geo-check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({venue_lat:t.geo_lat,venue_lng:t.geo_lng,radius_km:t.geo_radius_km||50,event_id:s,bypass_token:b})})).json();T.bypass?(_(!1),E({...T,crew_bypass:!0}),p(!0),n("crew@bypass"),t?.is_multi_stream&&le(!0)):(_(T.blocked),E(T))}catch(b){console.error("Geo check failed:",b),_(!1)}finally{S(!1)}};i.useEffect(()=>{const b=a.get("email");b&&t&&!m&&L(b)},[t,a]),i.useEffect(()=>(c&&m&&(z.current=setInterval(async()=>{try{await _t(c)||(y(!0),p(!1),clearInterval(z.current))}catch(b){console.error("Heartbeat failed:",b),y(!0),p(!1),clearInterval(z.current)}},3e4)),()=>{z.current&&clearInterval(z.current)}),[c,m]),i.useEffect(()=>{if(!t)return;const D=(A=>{if(!A)return new Date;const te=A.replace(/[Z+].*$/,"").replace(/\.000$/,"");return new Date(te)})(t.start_time),T=t.is_live||t.status==="live",U=new Date>=D,B=a.get("preview")==="player";if(U&&!T&&!B)return h(!0),ne.current=setInterval(async()=>{try{const A=await Te(s);(A?.is_live||A?.status==="live")&&(clearInterval(ne.current),r(A),h(!1))}catch(A){console.error("Failed to check event status:",A)}},15e3),()=>{ne.current&&clearInterval(ne.current)};h(!1)},[t,s,a]);const pe=async()=>{try{const b=await Te(s);if(r(b),b?.is_multi_stream)try{const D=await St(s);if(Ne(D||[]),!a.get("bypass")){const U=D?.find(B=>B.is_default)||D?.[0];U&&X(U)}}catch(D){console.error("Failed to load streams:",D)}}catch{j("Event not found")}finally{w(!1)}},L=async(b=o)=>{if(!b){j("Please enter your email");return}v(!0),j(null),y(!1);try{const D=a.get("session_id");let T=await ze(s,b);if(!T&&D)try{const{data:B}=await x.functions.invoke("verify-payment",{body:{session_id:D,event_id:s,email:b}});B?.verified&&(T=await ze(s,b))}catch(B){console.warn("Payment verification edge function failed:",B)}if(!T){j("No purchase found for this email. Please check your email or purchase access."),p(!1);return}const U=await kt({event_id:s,order_id:T.id,email:b.toLowerCase()});d(U.token),p(!0),n(b),D&&Vt(s,b),localStorage.setItem(`livestream_session_${s}`,U.token),localStorage.setItem(`livestream_email_${s}`,b)}catch(D){console.error("Verify error:",D),j("Failed to verify access. Please try again."),p(!1)}finally{v(!1)}};if(u)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-dark-700 border-t-red-500 mx-auto"}),e.jsx(q,{className:"absolute inset-0 m-auto w-6 h-6 text-red-500"})]}),e.jsx("p",{className:"text-gray-400 mt-4",children:"Loading stream..."})]})});if(k&&!t)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Fe,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Event Not Found"}),e.jsx("p",{className:"text-gray-400",children:k})]})});if($)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 blur-2xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-yellow-500/20 to-orange-500/20 flex items-center justify-center",children:e.jsx(H,{className:"w-10 h-10 text-yellow-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Location Restricted"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:["Online streaming is not available within ",t.geo_radius_km||50,"km of the venue."]}),N?.user_location&&e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:["Distance from venue: ",e.jsxs("span",{className:"text-white font-semibold",children:[N.distance_km,"km"]})]}),e.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-4 mb-6 border border-dark-700/50",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Watch live in person at:"}),e.jsx("p",{className:"text-white font-semibold",children:t.venue})]}),t.ticket_url&&e.jsxs("a",{href:t.ticket_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold rounded-xl transition-all duration-300 shadow-lg shadow-red-500/25",children:[e.jsx(q,{className:"w-5 h-5"}),"Get Tickets"]})]})]})});if(f)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 blur-2xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-yellow-500/20 to-orange-500/20 flex items-center justify-center",children:e.jsx(Fe,{className:"w-10 h-10 text-yellow-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Session Ended"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"This stream is now playing on another device. Only one active viewing session is allowed per purchase."}),e.jsxs("button",{onClick:()=>L(o),className:"inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold rounded-xl transition-all duration-300 shadow-lg shadow-red-500/25",children:[e.jsx(xt,{className:"w-5 h-5"}),"Watch Here Instead"]})]})]})});if(P)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-dark-700 border-t-red-500 mx-auto"}),e.jsx(je,{className:"absolute inset-0 m-auto w-6 h-6 text-red-500"})]}),e.jsx("p",{className:"text-gray-400 mt-4",children:"Checking access..."})]})});if(!m)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500/10 to-orange-500/10 blur-2xl rounded-3xl"}),e.jsxs("div",{className:"relative bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 overflow-hidden",children:[t.thumbnail_url&&e.jsxs("div",{className:"relative h-32 overflow-hidden",children:[e.jsx("img",{src:G(t.thumbnail_url),alt:t.title,className:"w-full h-full object-cover opacity-50"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-900 to-transparent"})]}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:t.title}),e.jsx("p",{className:"text-gray-400",children:t.org_display_name||t.organization})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Enter Your Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),e.jsx("input",{type:"email",value:o,onChange:b=>n(b.target.value),placeholder:"your@email.com",className:"w-full pl-12 pr-4 py-4 bg-dark-800/50 border border-dark-700 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-red-500 focus:ring-2 focus:ring-red-500/20 transition-all duration-300"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),"Use the email from your purchase"]})]}),k&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsx("p",{className:"text-red-400 text-sm",children:k})}),e.jsx("button",{onClick:()=>L(),disabled:g||!o,className:"w-full py-4 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 disabled:from-dark-700 disabled:to-dark-700 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-2 shadow-lg shadow-red-500/25 disabled:shadow-none",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5"}),"Watch Stream"]})}),e.jsxs("div",{className:"text-center pt-4 border-t border-dark-800",children:[e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Don't have access?"}),e.jsxs(ae,{to:`/live/${s}`,className:"text-red-500 hover:text-red-400 font-semibold transition-colors",children:["Purchase Access â€” $",t.price," AUD"]})]})]})]})]})]})});const F=(b=>{if(!b)return new Date;const D=b.replace(/[Z+].*$/,"").replace(/\.000$/,"");return new Date(D)})(t.start_time),M=t.is_live||t.status==="live",Y=t.doors_open===!0,K=a.get("preview")==="player",R=new Date>=F,Oe=!Y&&(M||R)&&!K,_e=!Y&&!M&&!R&&!K;if(ie&&ke)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gray-500/20 flex items-center justify-center",children:e.jsx(xe,{className:"w-10 h-10 text-gray-500"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"Replay No Longer Available"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"The VOD replay for this event has expired and is no longer available for viewing."}),e.jsx(ae,{to:"/live",className:"inline-flex items-center gap-2 px-6 py-3 bg-red-500 hover:bg-red-600 text-white font-semibold rounded-xl transition-colors",children:"Browse Other Events"})]})});if(Oe)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-red-500/20 flex items-center justify-center",children:e.jsx(ut,{className:"w-10 h-10 text-red-500"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"Stream Temporarily Unavailable"}),e.jsx("p",{className:"text-gray-400 mb-6",children:t.doors_closed_message||"The stream is currently unavailable. Please check back shortly."}),e.jsx("p",{className:"text-sm text-gray-500",children:"If you've purchased access, you'll be able to watch once the stream resumes."})]})});if(_e)return e.jsx("div",{className:"min-h-screen bg-dark-950",children:e.jsx("div",{className:"w-full bg-gradient-to-b from-dark-900 to-dark-950",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-16 text-center",children:[t.thumbnail_url&&e.jsxs("div",{className:"relative max-w-2xl mx-auto mb-8 rounded-2xl overflow-hidden shadow-2xl shadow-red-500/10 group",children:[e.jsx("img",{src:G(t.thumbnail_url),alt:t.title,className:"w-full aspect-video object-cover opacity-80 transition-transform duration-500 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-950 via-dark-950/50 to-transparent"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center border border-white/20",children:e.jsx(Q,{className:"w-10 h-10 text-white"})})})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-yellow-500/20 text-yellow-500 rounded-full text-sm font-medium mb-6 border border-yellow-500/30",children:[e.jsx(ye,{className:"w-4 h-4"}),"Waiting Room"]}),e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-white mb-3",children:t.title}),e.jsx("p",{className:"text-xl text-gray-400 mb-8",children:t.org_display_name||t.organization}),e.jsx("div",{className:"bg-dark-800/30 backdrop-blur-sm rounded-2xl p-8 max-w-xl mx-auto mb-8 border border-dark-700/50",children:e.jsx(Ye,{targetDate:t.start_time,onComplete:()=>pe()})}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-gray-400 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(Z,{className:"w-5 h-5 text-red-500"}),F.toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(Q,{className:"w-5 h-5 text-red-500"}),F.toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"})," AEST"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(H,{className:"w-5 h-5 text-red-500"}),t.venue]})]}),e.jsxs("div",{className:"bg-dark-800/30 backdrop-blur-sm rounded-2xl p-6 max-w-md mx-auto border border-dark-700/50",children:[e.jsx(ht,{className:"w-10 h-10 text-red-500 mx-auto mb-3"}),e.jsx("p",{className:"text-white font-semibold mb-2",children:"Don't miss the start!"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Keep this tab open â€” it will automatically refresh when the event goes live."}),e.jsxs("p",{className:"text-gray-600 text-xs flex items-center justify-center gap-1",children:[e.jsx(ue,{className:"w-3 h-3"}),"Logged in as: ",o]})]})]})})});if(R&&!M&&!K)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 blur-2xl rounded-3xl animate-pulse"}),e.jsxs("div",{className:"relative bg-dark-900/95 backdrop-blur-xl rounded-2xl border border-dark-700/50 p-8 text-center",children:[t.thumbnail_url&&e.jsxs("div",{className:"relative max-w-sm mx-auto mb-6 rounded-xl overflow-hidden",children:[e.jsx("img",{src:G(t.thumbnail_url),alt:t.title,className:"w-full aspect-video object-cover opacity-60"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-dark-700 border-t-red-500"})})]}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-yellow-500/20 text-yellow-500 rounded-full text-sm font-medium mb-4 border border-yellow-500/30 animate-pulse",children:[e.jsx(ye,{className:"w-4 h-4"}),"Starting Soon"]}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t.title}),e.jsx("p",{className:"text-gray-400 mb-6",children:"The event is about to begin. The stream will start momentarily."}),e.jsx("p",{className:"text-gray-500 text-sm",children:"This page will automatically refresh when the stream goes live."}),e.jsxs("p",{className:"text-gray-600 text-xs mt-4 flex items-center justify-center gap-1",children:[e.jsx(ue,{className:"w-3 h-3"}),"Logged in as: ",o]})]})]})});const J=ie&&t.vod_playback_id?t.vod_playback_id:W?.mux_playback_id||t.mux_playback_id||"demo-playback-id",me=I.length>1;return me&&(he||!W)?e.jsxs("div",{className:"min-h-screen bg-dark-950",children:[K&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-black px-4 py-2 text-center text-sm font-medium",children:"ðŸŽ¨ Preview Mode â€” This is how the player page will look. No stream is playing."}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[t.thumbnail_url&&e.jsxs("div",{className:"relative max-w-md mx-auto mb-6 rounded-xl overflow-hidden shadow-xl",children:[e.jsx("img",{src:G(t.thumbnail_url),alt:t.title,className:"w-full aspect-video object-cover opacity-70"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark-950 via-dark-950/30 to-transparent"})]}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:t.title}),e.jsx("p",{className:"text-gray-400",children:t.org_display_name||t.organization}),N?.crew_bypass&&e.jsxs("span",{className:"inline-flex items-center gap-1 mt-3 px-3 py-1 bg-green-500/20 text-green-400 text-sm font-medium rounded-full border border-green-500/30",children:[e.jsx(ue,{className:"w-4 h-4"}),"Crew Access"]})]}),e.jsxs("div",{className:"bg-dark-900/50 backdrop-blur-sm rounded-2xl border border-dark-700/50 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[e.jsx(se,{className:"w-6 h-6 text-red-500"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Select a Stream"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:I.map(b=>{const D=de(b);return e.jsxs("button",{onClick:()=>{X(b),le(!1)},className:"relative flex flex-col items-center justify-center p-6 rounded-xl border-2 border-dark-600 bg-dark-800 hover:border-red-500 hover:bg-red-500/10 transition-all duration-200 group",children:[D&&e.jsxs("span",{className:"absolute top-3 right-3 flex items-center gap-1 px-2 py-0.5 bg-red-500/20 text-red-500 text-xs font-medium rounded-full",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"LIVE"]}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-dark-700 group-hover:bg-red-500/20 flex items-center justify-center mb-3 transition-colors",children:e.jsx(se,{className:"w-8 h-8 text-gray-400 group-hover:text-red-500 transition-colors"})}),e.jsx("span",{className:"text-lg font-semibold text-white group-hover:text-red-400 transition-colors",children:b.name}),e.jsx("span",{className:`text-sm mt-1 ${D?"text-red-400":"text-gray-500"}`,children:D?"Now Streaming":"Waiting"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-red-500/0 group-hover:bg-red-500/10 rounded-xl transition-colors",children:e.jsxs("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-red-400 font-semibold flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"})," Watch"]})})]},b.id)})})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(Z,{className:"w-4 h-4 text-red-500"}),F.toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(H,{className:"w-4 h-4 text-red-500"}),t.venue]})]})]})]}):e.jsxs("div",{className:"min-h-screen bg-dark-950",children:[K&&e.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-black px-4 py-2 text-center text-sm font-medium",children:"ðŸŽ¨ Preview Mode â€” This is how the player page will look. No stream is playing."}),me&&e.jsxs("button",{onClick:()=>le(!0),className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white px-4 py-2 text-center text-sm font-medium flex items-center justify-center gap-2 transition-all cursor-pointer",children:[e.jsx(se,{className:"w-4 h-4"}),"Multiple Streams Available â€” Currently watching: ",e.jsx("strong",{children:W?.name||"Stream 1"}),e.jsx("span",{className:"ml-2 px-2 py-0.5 bg-white/20 rounded text-xs",children:"Click to switch"})]}),e.jsx("div",{className:"w-full bg-black",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[me&&e.jsx("div",{className:"md:hidden",children:e.jsx(ts,{streams:I,selectedStream:W,onSelect:X,isLive:M})}),e.jsxs("div",{className:"relative",children:[e.jsx(Qt,{playbackId:J,title:W?`${t.title} - ${W.name}`:t.title,poster:G(t.thumbnail_url||t.player_poster_url),isLive:M||W?.status==="live",viewerEmail:o,onShare:()=>{navigator.share&&navigator.share({title:t.title,text:`Watch ${t.title} live!`,url:window.location.href})}}),me&&e.jsx("div",{className:"hidden md:block absolute bottom-4 left-4 z-10",children:e.jsx(ss,{streams:I,selectedStream:W,onSelect:X})})]}),me&&e.jsx("div",{className:"bg-dark-900/80 backdrop-blur-sm border-t border-dark-700/50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-gray-400 text-sm mr-2",children:"Quick Switch:"}),I.map(b=>{const D=W?.id===b.id,T=de(b);return e.jsxs("button",{onClick:()=>X(b),className:`relative flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${D?"bg-red-500 text-white shadow-lg shadow-red-500/25":"bg-dark-700 text-gray-300 hover:bg-dark-600 hover:text-white"}`,children:[T&&!D&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsx(se,{className:"w-4 h-4"}),b.name]},b.id)}),e.jsx("button",{onClick:()=>le(!0),className:"px-3 py-2 text-gray-500 hover:text-white text-sm transition-colors",children:"View All â†’"})]})})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:t.title}),e.jsx(Xt,{isLive:M,viewerCount:C}),N?.crew_bypass&&e.jsx("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 text-sm font-medium rounded-full border border-green-500/30",children:"Crew Access"})]}),e.jsx("p",{className:"text-gray-400",children:t.org_display_name||t.organization})]}),M&&e.jsx(es,{eventId:s})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(Z,{className:"w-4 h-4 text-red-500"}),F.toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/30 px-4 py-2 rounded-xl border border-dark-700/30",children:[e.jsx(H,{className:"w-4 h-4 text-red-500"}),t.venue]})]}),t.description&&e.jsxs("div",{className:"bg-dark-800/20 rounded-2xl p-6 border border-dark-700/30",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"About This Event"}),e.jsx("p",{className:"text-gray-400 leading-relaxed",children:t.description})]})]})]})}const Zs=Object.freeze(Object.defineProperty({__proto__:null,default:as},Symbol.toStringTag,{value:"Module"}));function rs(){const s=gt();Pe();const[a,t]=i.useState(null),[r,o]=i.useState([]),[n,c]=i.useState(!0),[d,m]=i.useState(""),[p,u]=i.useState(!1),[w,g]=i.useState(!1),[v,k]=i.useState(null);i.useEffect(()=>{j();const{data:{subscription:l}}=Lt(async(h,C)=>{if(h==="SIGNED_IN"&&C?.user){t(C.user);try{await Re(C.user.id,C.user.email)}catch(V){console.error("Failed to sync profile:",V)}f(C.user.email)}else h==="SIGNED_OUT"&&(t(null),o([]))});return()=>l.unsubscribe()},[]);const j=async()=>{try{const l=await Ct();if(l?.user){t(l.user);try{await Re(l.user.id,l.user.email)}catch(h){console.error("Failed to sync profile:",h)}await f(l.user.email)}}catch(l){console.error("Auth check failed:",l)}finally{c(!1)}},f=async l=>{try{const h=await $t(l);o(h||[])}catch(h){console.error("Failed to load purchases:",h),k("Failed to load your purchases")}},y=async l=>{if(l.preventDefault(),!!d){u(!0),k(null);try{await Et(d,`${window.location.origin}/#/my-purchases`),g(!0)}catch(h){k("Failed to send login link. Please try again."),console.error("Magic link error:",h)}finally{u(!1)}}},$=async()=>{await Dt(),t(null),o([])},_=l=>new Date(l).toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),N=l=>new Date(l).toLocaleTimeString("en-AU",{hour:"2-digit",minute:"2-digit"}),E=l=>{const h=new Date,C=new Date(l.start_time),V=new Date(l.end_time);return h>=C&&h<=V&&l.is_live},P=l=>new Date(l.start_time)>new Date,S=l=>new Date(l.end_time)<new Date;return n?e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"})}):a?e.jsx("div",{className:"min-h-screen bg-dark-950",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"My Purchases"}),e.jsx("p",{className:"text-gray-400",children:a.email})]}),e.jsxs("button",{onClick:$,className:"flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(ft,{className:"w-5 h-5"}),"Sign Out"]})]}),r.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(we,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"No Purchases Yet"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"You haven't purchased any events yet."}),e.jsx("button",{onClick:()=>s("/live"),className:"px-6 py-3 bg-red-500 hover:bg-red-600 text-white font-semibold rounded-lg transition-colors",children:"Browse Events"})]}):e.jsx("div",{className:"space-y-4",children:r.map(l=>{const h=l.event,C=E(h),V=P(h),z=S(h);return e.jsx("div",{className:"bg-dark-900 rounded-xl border border-dark-800 overflow-hidden hover:border-dark-700 transition-colors",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[h.thumbnail_url&&e.jsx("div",{className:"md:w-48 h-32 md:h-auto flex-shrink-0",children:e.jsx("img",{src:h.thumbnail_url,alt:h.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:h.title}),C&&e.jsxs("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),"LIVE"]}),V&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 text-xs font-medium rounded-full",children:"Upcoming"}),z&&!h.mux_playback_id&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-500/20 text-gray-400 text-xs font-medium rounded-full",children:"Ended"}),z&&h.mux_playback_id&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 text-xs font-medium rounded-full",children:"Replay Available"})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-3",children:h.org_display_name||h.organization}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"}),_(h.start_time)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-4 h-4"}),N(h.start_time)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"w-4 h-4"}),h.venue]})]})]}),(C||V||h.mux_playback_id)&&e.jsxs("button",{onClick:()=>s(`/watch/${h.id}?email=${encodeURIComponent(a.email)}`),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors flex-shrink-0 ${C?"bg-red-500 hover:bg-red-600 text-white":"bg-dark-800 hover:bg-dark-700 text-white"}`,children:[e.jsx(q,{className:"w-5 h-5"}),C?"Watch Live":V?"Watch":"Replay"]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-800 flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Purchased ",_(l.created_at)]}),e.jsxs("span",{className:"text-green-500 font-medium",children:["$",l.amount," AUD"]})]})]})]})},l.id)})})]})}):e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(we,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"My Purchases"}),e.jsx("p",{className:"text-gray-400",children:"Enter your email to access your purchased events"})]}),w?e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-xl p-6 text-center",children:[e.jsx(ve,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Check Your Email!"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:["We've sent a login link to ",e.jsx("span",{className:"text-white font-medium",children:d})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click the link in your email to access your purchases. The link expires in 1 hour."}),e.jsx("button",{onClick:()=>g(!1),className:"mt-4 text-red-500 hover:text-red-400 text-sm",children:"Use a different email"})]}):e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:d,onChange:l=>m(l.target.value),placeholder:"your@email.com",className:"w-full px-4 py-3 bg-dark-800 border border-dark-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500",required:!0})]}),v&&e.jsx("div",{className:"text-red-500 text-sm",children:v}),e.jsx("button",{type:"submit",disabled:p||!d,className:"w-full py-3 bg-red-500 hover:bg-red-600 disabled:bg-dark-700 disabled:text-gray-500 text-white font-semibold rounded-lg transition-colors flex items-center justify-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-5 h-5"}),"Send Login Link"]})}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No password needed! We'll email you a secure login link."})]})]})})}const Ys=Object.freeze(Object.defineProperty({__proto__:null,default:rs},Symbol.toStringTag,{value:"Module"}));export{Is as A,Ts as B,Cs as C,Ps as D,Us as E,Os as F,Ms as G,Fs as H,He as I,Rs as J,Vs as K,qs as L,Bs as M,fs as N,ws as O,ys as P,Ss as Q,Ns as R,Gs as S,Hs as T,Ys as U,Zs as W,x as a,cs as b,ds as c,xs as d,hs as e,ms as f,zs as g,ps as h,js as i,bs as j,vs as k,ks as l,gs as m,_s as n,Es as o,os as p,G as q,St as r,is as s,Ws as t,us as u,Ds as v,As as w,Nt as x,$s as y,Ls as z};
