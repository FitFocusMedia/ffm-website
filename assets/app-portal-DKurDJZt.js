import{a as r,j as e,aq as us,K as ve,ar as ps,u as Qe,a8 as bs,e as Ce,C as we,b as He,D as Ze,H as De,U as We,B as $e,W as Se,as as Yt,_ as Ie,at as Kt,M as rt,au as ut,av as fs,X as Dt,l as pt,a7 as et,G as Qt,aw as ys,p as vs,ax as js,a6 as lt,al as _e,ak as Xt,m as Ne,ay as Me,a0 as Jt,t as jt,az as Oe,aA as $t,a3 as nt,P as Nt,aB as Ns,aC as ze,aD as Zt,v as ws,c as Tt,w as _s,aE as ks,aF as Cs,aG as ke,aH as Ss,E as Re,aa as Ye,ac as Ge,aI as At,aJ as Ke,S as es,aK as Es,aL as Ds,aM as $s,aN as Ts,aO as As,aP as Ps,aQ as Ls,R as tt,aR as Fs,aS as Ms,aT as st,F as Je,aU as Os,I as zs,aV as Rs,aW as Is,aX as it,d as Pt,am as Bs,Y as ts,V as Lt,ab as Us,aj as Fe,aY as Ft}from"./vendor-react-CBAhgyLg.js";import{a as U,b as wt,c as ss,u as Mt,d as Ot,e as qs,f as Vs,m as Gs,h as Hs,i as Ws,j as Ys,k as as,l as Ks,n as Qs,o as Xs,p as Js,q as zt,r as bt,v as rs,w as Zs,x as ea,y as Le,z as ta,A as sa,B as aa,C as ra,D as la,E as Rt,F as ot,G as na,H as ia,I as oa,J as da,K as ca,L as xa,M as ma}from"./app-livestream-Bf1YYS1I.js";import{R as It,B as ga,X as ha,Y as ua,d as pa,C as Bt,e as ba,f as fa}from"./feature-charts-DQYlD5jU.js";import{m as ye,A as at}from"./feature-motion-Bu8rrqv7.js";import{u as ya,a as dt,D as va,c as ja,b as Na,K as wa,T as _a,P as ka,d as Ca,e as Sa}from"./feature-dnd-BN92K1zc.js";import{L as ls}from"./feature-maps-CF1gGmr7.js";const ns=r.createContext({}),_t=()=>{const t=r.useContext(ns);if(!t)throw new Error("useAuth must be used within AuthProvider");return t},Kr=({children:t})=>{const[a,s]=r.useState(null),[i,l]=r.useState(null),[y,x]=r.useState(!0);r.useEffect(()=>{U.auth.getSession().then(({data:{session:d}})=>{l(d),s(d?.user??null),x(!1)});const{data:{subscription:p}}=U.auth.onAuthStateChange((d,f)=>{l(f),s(f?.user??null)});return()=>p.unsubscribe()},[]);const z={user:a,session:i,loading:y,signIn:async(p,d)=>{const{data:f,error:v}=await U.auth.signInWithPassword({email:p,password:d});if(v)throw v;return f},signInWithMagicLink:async(p,d)=>{const{data:f,error:v}=await U.auth.signInWithOtp({email:p.toLowerCase(),options:{emailRedirectTo:d||window.location.origin}});if(v)throw v;return f},signOut:async()=>{const{error:p}=await U.auth.signOut();if(p)throw p}};return e.jsx(ns.Provider,{value:z,children:t})};function Ea({children:t}){const{user:a,loading:s}=_t();return s?e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-xl",children:"Loading..."})}):a?t:e.jsx(us,{to:"/portal",replace:!0})}const Qr=Object.freeze(Object.defineProperty({__proto__:null,default:Ea},Symbol.toStringTag,{value:"Module"}));function Da({children:t}){const{user:a,signOut:s}=_t(),i=ve(),l=ps(),y=async()=>{try{await s(),i("/portal")}catch(c){console.error("Error signing out:",c)}},x=c=>l.pathname.startsWith(c),j=[{name:"Contracts",path:"/portal/contracts"},{name:"Pipeline",path:"/portal/pipeline"},{name:"Proposals",path:"/portal/proposals"},{name:"Outreach",path:"/portal/outreach"},{name:"Onboarding",path:"/portal/onboarding"},{name:"Content",path:"/portal/content-admin"},{name:"Orders",path:"/portal/orders"},{name:"Livestream",path:"/portal/livestream"},{name:"Analytics",path:"/portal/livestream/analytics"},{name:"Crews",path:"/portal/crews"},{name:"Pricing",path:"/portal/pricing"}];return e.jsxs("div",{className:"min-h-screen bg-[#0d0d1a] flex flex-col overflow-x-hidden w-full max-w-full",children:[e.jsx("header",{className:"print:hidden bg-gradient-to-r from-[#1a1a2e] to-[#16162a] border-b border-gray-800/50 w-full max-w-full overflow-hidden",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>i("/portal/contracts"),children:[e.jsxs("span",{className:"text-lg font-black tracking-wider",children:[e.jsx("span",{className:"text-red-500",children:"FIT FOCUS"})," ",e.jsx("span",{className:"text-white",children:"MEDIA"})]}),e.jsx("span",{className:"text-gray-700",children:"|"}),e.jsx("span",{className:"text-gray-400 font-medium",children:"Portal"})]}),a&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-gray-500 text-sm hidden sm:block",children:a.email}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded-lg transition-all text-sm font-medium border border-gray-700/50",children:"Sign Out"})]})]}),a&&e.jsx("div",{className:"flex gap-1 sm:gap-4 -mb-px overflow-x-auto scrollbar-hide pb-px",children:j.map(c=>e.jsxs("button",{onClick:()=>i(c.path),className:`relative px-3 sm:px-4 py-3 font-bold text-xs sm:text-sm transition-colors whitespace-nowrap flex-shrink-0 ${x(c.path)?"text-red-500":"text-gray-400 hover:text-gray-300"}`,children:[c.name,x(c.path)&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-red-500"})]},c.path))})]})}),e.jsx("main",{className:"flex-1",children:t})]})}const Xr=Object.freeze(Object.defineProperty({__proto__:null,default:Da},Symbol.toStringTag,{value:"Module"}));function $a(){const[t,a]=r.useState(""),[s,i]=r.useState(""),[l,y]=r.useState(""),[x,j]=r.useState(!1),{signIn:c}=_t(),w=ve(),z=async p=>{p.preventDefault(),y(""),j(!0);try{await c(t,s),w("/portal/contracts")}catch(d){y(d.message||"Failed to sign in")}finally{j(!1)}};return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Portal Login"}),e.jsx("p",{className:"text-gray-400",children:"Fit Focus Media Contract Management"})]}),e.jsx("div",{className:"bg-dark-900 rounded-lg p-8 shadow-xl",children:e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:t,onChange:p=>a(p.target.value),required:!0,className:"w-full px-4 py-3 bg-dark-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:s,onChange:p=>i(p.target.value),required:!0,className:"w-full px-4 py-3 bg-dark-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"})]}),l&&e.jsx("div",{className:"bg-red-900/30 border border-red-500 text-red-200 px-4 py-3 rounded-lg",children:l}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 text-white font-medium py-3 px-6 rounded-lg transition-colors",children:x?"Signing in...":"Sign In"})]})})]})})}const Jr=Object.freeze(Object.defineProperty({__proto__:null,default:$a},Symbol.toStringTag,{value:"Module"}));function kt(t){const a=t.contract_data||{},s=(c,w="[NOT SET]")=>c||`<span class="text-gray-500">${w}</span>`,i=(c,w,z="[NOT SET]")=>!c&&!w?`<span class="text-gray-500">${z}</span>`:c?!w||w===c?c:`${c}‚Äì${w}`:w,l=c=>c?"‚òë":"‚òê";let y="";a.multi_events&&a.multi_events.length>0&&a.multi_events.forEach((c,w)=>{(c.name||c.date||c.venue)&&(y+=`
          <tr>
            <td class="border border-gray-700 px-4 py-2">${w+1}</td>
            <td class="border border-gray-700 px-4 py-2">${s(c.name)}</td>
            <td class="border border-gray-700 px-4 py-2">${s(c.date)}</td>
            <td class="border border-gray-700 px-4 py-2">${s(c.venue)}</td>
          </tr>
        `)});const x=c=>c?`$${parseFloat(c).toLocaleString()}`:"$0";let j="";return a.athlete_revenue_ffm_100?j="<p><strong>‚òë FFM retains 100%</strong> of Athlete Media Package sales. This is reflected in the zero upfront cost and Client deliverables provided at no charge.</p>":j=`
      <table class="w-full border-collapse border border-gray-700 my-4">
        <tr><th class="border border-gray-700 px-4 py-2 bg-gray-800">Party</th><th class="border border-gray-700 px-4 py-2 bg-gray-800">Share</th></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>FFM</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.athlete_ffm_split,"80")}%</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Client</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.athlete_client_split,"20")}%</td></tr>
      </table>
      <p>The Client's share will be paid monthly, with a statement of sales provided.</p>
    `,`
    <div class="contract-content prose prose-invert max-w-none">
      <h1 class="text-3xl font-bold mb-6">EVENT MEDIA COVERAGE & PARTNERSHIP AGREEMENT</h1>
      
      <p><strong>AGREEMENT</strong> made on <strong>${s(a.agreement_date,new Date().toLocaleDateString())}</strong></p>
      
      <p><strong>BETWEEN:</strong></p>
      
      <p>
        <strong>Fit Focus Media</strong> ABN ${s(a.ffm_abn,"[ABN]")}<br>
        Represented by: Brandon Hibbs<br>
        Email: info@fitfocusmedia.com.au<br>
        Website: www.fitfocusmedia.com.au<br>
        (hereinafter referred to as <strong>"FFM"</strong> or <strong>"the Media Provider"</strong>)
      </p>
      
      <p><strong>AND:</strong></p>
      
      <p>
        <strong>${s(a.org_name,"[ORGANIZATION NAME]")}</strong><br>
        Represented by: ${s(a.promoter_name,"[PROMOTER NAME]")}<br>
        Position: ${s(a.promoter_position,"[POSITION]")}<br>
        Email: ${s(a.promoter_email,"[EMAIL]")}<br>
        Phone: ${s(a.promoter_phone,"[PHONE]")}<br>
        (hereinafter referred to as <strong>"the Client"</strong> or <strong>"the Event Organiser"</strong>)
      </p>
      
      <hr class="my-6 border-gray-700">
      
      <h2 class="text-2xl font-bold mt-6 mb-4">1. EVENT DETAILS</h2>
      <table class="w-full border-collapse border border-gray-700 my-4">
        <tr><th class="border border-gray-700 px-4 py-2 bg-gray-800">Field</th><th class="border border-gray-700 px-4 py-2 bg-gray-800">Details</th></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Event Name</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.event_name)}</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Event Date(s)</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.event_date)}</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Event Location</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.event_location)}</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Event Type</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.event_type,"BJJ / Grappling Competition")}</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Estimated Matches</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.estimated_matches)}</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Expected Athlete Participants</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.expected_athletes)}</td></tr>
        <tr><td class="border border-gray-700 px-4 py-2"><strong>Expected Audience</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.expected_audience)}</td></tr>
      </table>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">2. PARTNERSHIP MODEL ‚Äî ZERO UPFRONT COST</h2>
      
      <h3 class="text-xl font-bold mt-4 mb-2">2.1 No Upfront Fee</h3>
      <p>FFM will provide full professional media coverage for the Event at <strong>no upfront cost</strong> to the Client.</p>
      
      <h3 class="text-xl font-bold mt-4 mb-2">2.2 What FFM Provides at Zero Cost</h3>
      <ul class="list-disc pl-6 my-4">
        <li>Multi-camera professional video coverage (${i(a.camera_angles,a.camera_angles_max,"2")} camera angles)</li>
        ${a.photography_type==="professional"?"<li>Professional event photography</li>":""}
        ${a.photography_type==="base"?"<li>Base event photography</li>":""}
        <li>Livestream and/or PPV broadcast production (if applicable)</li>
        <li>Post-event highlight reel for the Client's promotional use</li>
        <li>Access to the FFM Athlete Media Portal for athlete content delivery</li>
        <li>On-site crew (${i(a.crew_size,a.crew_size_max,"2")} persons)</li>
      </ul>
      
      <h3 class="text-xl font-bold mt-4 mb-2">2.3 Multi-Event Commitment</h3>
      <p>This Agreement covers <strong>${s(a.multi_event_count,"1")}</strong> events over a period of <strong>${s(a.multi_event_duration,"[DURATION]")}</strong>${y?", as scheduled below:":"."}</p>
      
      ${y?`
        <table class="w-full border-collapse border border-gray-700 my-4">
          <tr><th class="border border-gray-700 px-4 py-2 bg-gray-800">#</th><th class="border border-gray-700 px-4 py-2 bg-gray-800">Event Name</th><th class="border border-gray-700 px-4 py-2 bg-gray-800">Date</th><th class="border border-gray-700 px-4 py-2 bg-gray-800">Venue</th></tr>
          ${y}
        </table>
      `:""}
      
      <h2 class="text-2xl font-bold mt-6 mb-4">3. SCOPE OF MEDIA COVERAGE</h2>
      
      <h3 class="text-xl font-bold mt-4 mb-2">3.1 Post-Production Deliverables for the Client</h3>
      <ul class="list-disc pl-6 my-4">
        <li>One (1) Event Highlight Reel (60‚Äì120 seconds) within ${i(a.highlight_delivery_days,a.highlight_delivery_days_max,"7")} business days</li>
        <li>${i(a.social_clips_count,a.social_clips_count_max,"5")} social media clips within ${i(a.social_clips_delivery_days,a.social_clips_delivery_days_max,"5")} business days</li>
        ${a.photography_type&&a.photography_type!=="none"?`<li>Curated photo gallery of ${i(a.photo_count,a.photo_count_max,"50")} edited images</li>`:""}
      </ul>
      
      <h3 class="text-xl font-bold mt-4 mb-2">3.2 Livestream / PPV Production</h3>
      <p>
        <strong>Livestream included:</strong> ${l(a.livestream_included)} ${a.livestream_included?"Yes":"No"}<br>
        <strong>PPV included:</strong> ${l(a.ppv_included)} ${a.ppv_included?"Yes":"No"}
      </p>
      ${a.ppv_included?`
        <p>
          <strong>Platform:</strong> ${s(a.ppv_platform)}<br>
          <strong>PPV Price Point:</strong> ${a.ppv_price_type==="range"&&a.ppv_price_max?`${x(a.ppv_price)} - ${x(a.ppv_price_max)}`:x(a.ppv_price)} per viewer
        </p>
      `:""}
      
      <h2 class="text-2xl font-bold mt-6 mb-4">4. LIVESTREAM & PPV REVENUE SHARE</h2>
      ${a.ppv_included?`
        <table class="w-full border-collapse border border-gray-700 my-4">
          <tr><th class="border border-gray-700 px-4 py-2 bg-gray-800">Party</th><th class="border border-gray-700 px-4 py-2 bg-gray-800">Share</th></tr>
          <tr><td class="border border-gray-700 px-4 py-2"><strong>FFM</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.ppv_ffm_split,"70")}%</td></tr>
          <tr><td class="border border-gray-700 px-4 py-2"><strong>Client</strong></td><td class="border border-gray-700 px-4 py-2">${s(a.ppv_client_split,"30")}%</td></tr>
        </table>
        <p>The Client's share will be paid within ${s(a.ppv_payment_days,"21")} days of each Event via bank transfer.</p>
      `:"<p>PPV not included in this agreement.</p>"}
      
      <h2 class="text-2xl font-bold mt-6 mb-4">5. ATHLETE MEDIA PACKAGES</h2>
      
      <h3 class="text-xl font-bold mt-4 mb-2">5.1 Overview</h3>
      <p>FFM operates a direct-to-athlete media sales model through the <strong>FFM Athlete Media Portal</strong>.</p>
      
      <h3 class="text-xl font-bold mt-4 mb-2">5.2 Available Packages</h3>
      ${a.athlete_packages&&a.athlete_packages.length>0?`
        <table class="w-full border-collapse border border-gray-700 my-4">
          <tr>
            <th class="border border-gray-700 px-4 py-2 bg-gray-800 text-left">Package</th>
            <th class="border border-gray-700 px-4 py-2 bg-gray-800 text-left">Price</th>
            <th class="border border-gray-700 px-4 py-2 bg-gray-800 text-left">Description</th>
          </tr>
          ${a.athlete_packages.map(c=>`
            <tr>
              <td class="border border-gray-700 px-4 py-2"><strong>${c.name||"[Package Name]"}</strong></td>
              <td class="border border-gray-700 px-4 py-2">${x(c.price)}</td>
              <td class="border border-gray-700 px-4 py-2">${c.description||"-"}</td>
            </tr>
          `).join("")}
        </table>
      `:`
        <p><strong>üî• VIP COVERAGE</strong> ‚Äî ${x(a.vip_price||350)}</p>
        <p><strong>üìπ MATCH PACKAGE</strong> ‚Äî ${x(a.match_price||175)}</p>
        <p><strong>‚≠ê SEASON PASS</strong> ‚Äî ${x(a.season_price||899)}/year</p>
      `}
      
      <h3 class="text-xl font-bold mt-4 mb-2">5.3 Athlete Media Package Revenue Split</h3>
      ${j}
      
      ${a.add_ons&&a.add_ons.length>0?`
      <h2 class="text-2xl font-bold mt-6 mb-4">6. CLIENT ADD-ONS</h2>
      <p>The following additional services have been included in this Agreement at the Client's request:</p>
      <table class="w-full border-collapse border border-gray-700 my-4">
        <tr>
          <th class="border border-gray-700 px-4 py-2 bg-gray-800 text-left">Add-On</th>
          <th class="border border-gray-700 px-4 py-2 bg-gray-800 text-left">Price</th>
          <th class="border border-gray-700 px-4 py-2 bg-gray-800 text-left">Description</th>
        </tr>
        ${a.add_ons.map(c=>`
          <tr>
            <td class="border border-gray-700 px-4 py-2"><strong>${c.name||"[Add-On Name]"}</strong></td>
            <td class="border border-gray-700 px-4 py-2">${x(c.price)}</td>
            <td class="border border-gray-700 px-4 py-2">${c.description||"-"}</td>
          </tr>
        `).join("")}
        <tr class="bg-gray-800">
          <td class="border border-gray-700 px-4 py-2"><strong>TOTAL ADD-ONS</strong></td>
          <td class="border border-gray-700 px-4 py-2"><strong>${x(a.add_ons.reduce((c,w)=>c+(parseFloat(w.price)||0),0))}</strong></td>
          <td class="border border-gray-700 px-4 py-2"></td>
        </tr>
      </table>
      <p>Payment for add-ons is due prior to the Event date unless otherwise agreed in writing.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">7. EXCLUSIVE MEDIA COVERAGE RIGHTS</h2>
      `:`
      <h2 class="text-2xl font-bold mt-6 mb-4">6. EXCLUSIVE MEDIA COVERAGE RIGHTS</h2>
      `}
      <p>The Client grants FFM <strong>exclusive rights</strong> to provide professional video and photography media coverage services at the Event.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">7. ACCESS & LOGISTICS</h2>
      <ul class="list-disc pl-6 my-4">
        <li>FFM requires venue access at least ${s(a.setup_hours,"2")} hours prior to first match</li>
        <li>Crew size: ${i(a.crew_size,a.crew_size_max,"2")} persons with complimentary entry</li>
        ${a.internet_speed?`<li>Internet upload speed: minimum ${a.internet_speed} Mbps</li>`:""}
        <li>Event schedule to be provided ${s(a.schedule_hours_before,"48")} hours before Event</li>
        <li>Athlete list to be provided ${s(a.athlete_list_days_before,"7")} days before Event</li>
      </ul>
      
      <h3 class="text-xl font-bold mt-4 mb-2">7.1 Athlete Contact Information</h3>
      <p>The Client <strong>must provide</strong> FFM with contact information for all registered athletes, including but not limited to:</p>
      <ul class="list-disc pl-6 my-4">
        <li>Full name</li>
        <li>Email address</li>
        <li>Phone number (where available)</li>
        <li>Social media handles (Instagram, etc.)</li>
      </ul>
      <p>This information will be used by FFM for:</p>
      <ul class="list-disc pl-6 my-4">
        <li>Delivering content and media packages to athletes via the FFM Athlete Media Portal</li>
        <li>Marketing and promotional communications regarding event content and athlete media services</li>
        <li>Tagging athletes in social media content</li>
      </ul>
      <p>The Client warrants that appropriate consent has been obtained from athletes for their contact information to be shared with FFM for these purposes, as outlined in Section 12.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">8. CANCELLATION & RESCHEDULING</h2>
      <p>Cancellation less than 15 days before Event: Client will pay ${x(a.cancellation_fee||500)} cancellation fee plus non-recoverable expenses.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">9. TERM & TERMINATION</h2>
      <p>Initial term: ${s(a.initial_term_months,"12")} months. Auto-renews for ${s(a.renewal_period_months,"12")}-month periods unless ${s(a.nonrenewal_notice_days,"60")} days' written notice provided.</p>
      <p>Termination: ${s(a.termination_notice_days,"30")} days' written notice. Remedy period: ${s(a.remedy_period_days,"14")} days.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">10. LIABILITY & INSURANCE</h2>
      <p>FFM holds public liability insurance of ${x(a.pli_amount||2e7)}.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">11. INTELLECTUAL PROPERTY & OWNERSHIP</h2>
      
      <h3 class="text-xl font-bold mt-4 mb-2">11.1 Ownership of Content</h3>
      <p>The Client agrees that, subject to the rights and licenses granted herein, FFM is and will remain the <strong>sole and exclusive owner</strong> of all right, title, and interest, throughout the world, to all video footage, photographs, and other media content ("Content") produced under this Agreement, and any copies thereof. Except as expressly provided in this Agreement, FFM reserves all rights and licenses not expressly granted.</p>
      
      <h3 class="text-xl font-bold mt-4 mb-2">11.2 License to Client</h3>
      <p>FFM hereby grants to the Client a <strong>non-exclusive, perpetual license</strong> to use the deliverables specified in Section 3.1 (Event Highlight Reel, social media clips, and curated photo gallery) for promotional purposes related to the Event and Client's organization. This license is non-transferable and does not include the right to sublicense.</p>
      
      <h3 class="text-xl font-bold mt-4 mb-2">11.3 Restrictions on Use</h3>
      <p>The Client will NOT use the Content for any of the following purposes without prior written permission from FFM:</p>
      <ul class="list-disc pl-6 my-4">
        <li><strong>No Unlawful Use:</strong> The Client will not use the Content in any unlawful manner, including but not limited to pornography or defamation.</li>
        <li><strong>No Standalone File Distribution:</strong> The Client will not distribute raw footage or allow Content to be downloaded, extracted, or redistributed by third parties.</li>
        <li><strong>No Trademark Use:</strong> The Client will not use the Content in any trademark, design, logo, or service mark without FFM's written consent.</li>
        <li><strong>No Products for Resale:</strong> The Client will not use the Content in any goods or products where the Content is the primary value.</li>
        <li><strong>No Alterations:</strong> The Client will not alter, modify, or create derivative works from the Content without prior written permission from FFM.</li>
        <li><strong>No Sublicensing:</strong> The Client will not sublicense, sell, or transfer rights to the Content to any third party.</li>
      </ul>
      
      <h3 class="text-xl font-bold mt-4 mb-2">11.4 Credit Requirements</h3>
      <p>The Client must include appropriate credit to <strong>"Fit Focus Media"</strong> or <strong>"@fitfocusmedia"</strong> when publishing or sharing any Content produced under this Agreement on social media, websites, or promotional materials.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">12. MEDIA RELEASE & CONSENT</h2>
      
      <h3 class="text-xl font-bold mt-4 mb-2">12.1 Athlete Media Release</h3>
      <p>The Client acknowledges that FFM will capture video footage and photographs of athletes, coaches, officials, and spectators at the Event. The Client warrants that:</p>
      <ul class="list-disc pl-6 my-4">
        <li>Appropriate media release and consent has been obtained from all athletes participating in the Event, either through registration terms & conditions or separate media release forms.</li>
        <li>Athletes have been informed that professional media coverage will be present and content may be used for promotional, commercial, and broadcast purposes.</li>
        <li>Minors participating in the Event have appropriate parental/guardian consent for media capture and publication.</li>
      </ul>
      
      <h3 class="text-xl font-bold mt-4 mb-2">12.2 Grant of Rights</h3>
      <p>FFM is granted the <strong>perpetual and irrevocable right</strong> to use, publish, and distribute video and photographs captured at the Event for editorial, trade, advertising, promotional, and commercial purposes in any manner and medium, including but not limited to:</p>
      <ul class="list-disc pl-6 my-4">
        <li>Social media platforms and websites</li>
        <li>Marketing and promotional materials</li>
        <li>Broadcast and streaming services</li>
        <li>Athlete Media Packages sold through the FFM Portal</li>
        <li>Portfolio and showcase purposes</li>
      </ul>
      
      <h3 class="text-xl font-bold mt-4 mb-2">12.3 Implied Consent & Opt-Out Procedure</h3>
      <p>The parties agree that:</p>
      <ul class="list-disc pl-6 my-4">
        <li><strong>Implied Consent:</strong> All athletes, by registering for and competing in the Event, are deemed to have consented to the capture, use, and publication of their image, likeness, and performance by FFM for the purposes outlined in this Agreement.</li>
        <li><strong>Opt-Out Requirement:</strong> Any athlete who does not consent to media capture and publication must notify FFM <strong>in writing</strong> (via email to info@fitfocusmedia.com.au) no less than <strong>48 hours prior</strong> to the Event. FFM will make reasonable efforts to exclude such athletes from published content, however FFM cannot guarantee exclusion from all footage, particularly wide-angle or crowd shots.</li>
        <li><strong>Client Responsibility:</strong> The Client is solely responsible for communicating media coverage terms to athletes through registration materials, event signage, and/or announcements. The Client shall include appropriate notice in registration terms and conditions that professional media coverage will be present and content may be used commercially.</li>
        <li><strong>Liability:</strong> The Client assumes all liability for any claims arising from athletes who allege they did not consent to media capture. FFM shall not be held liable for any such claims, and the Client shall indemnify FFM accordingly as outlined in Section 13.</li>
      </ul>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">13. INDEMNIFICATION</h2>
      <p>The Client will <strong>indemnify, defend, and hold harmless</strong> FFM, its officers, employees, agents, and contractors from all liability, claims, demands, causes of action, judgments, damages, and expenses (including reasonable attorneys' fees and costs) arising out of or as a result of:</p>
      <ul class="list-disc pl-6 my-4">
        <li>The Client's use of the Content in violation of this Agreement</li>
        <li>Any breach of the Client's representations or warranties under this Agreement</li>
        <li>Any claim by a third party (including athletes, spectators, or venue operators) relating to the Event</li>
        <li>The Client's failure to obtain proper media releases or consents</li>
      </ul>
      <p>This indemnification does not apply to claims arising solely from FFM's willful misconduct, gross negligence, or bad faith.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">14. LIMITATION OF LIABILITY</h2>
      <p><strong>EXCEPT FOR ANY REMEDIES THAT CANNOT BE EXCLUDED OR LIMITED BY LAW, NEITHER PARTY, NOR ANY AFFILIATE, WILL BE LIABLE UNDER THIS AGREEMENT TO THE OTHER PARTY FOR ANY INDIRECT, INCIDENTAL, CONSEQUENTIAL, SPECIAL, RELIANCE, OR PUNITIVE DAMAGES OR LOST OR IMPUTED PROFITS, LOST DATA, OR COST OF PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES.</strong></p>
      <p>FFM's total liability under this Agreement shall not exceed the total fees paid or payable by the Client under this Agreement in the twelve (12) months preceding the claim.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">15. FORCE MAJEURE</h2>
      <p>Neither party shall be liable for any failure or delay in performing their obligations under this Agreement if such failure or delay results from circumstances beyond the reasonable control of that party, including but not limited to: acts of God, natural disasters, pandemic, government actions, war, terrorism, civil unrest, or failure of third-party services.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">16. CONFIDENTIALITY</h2>
      <p>Each party agrees to keep confidential and not disclose to any third party any confidential information received from the other party, including but not limited to business strategies, financial information, athlete data, and the specific commercial terms of this Agreement, except as required by law or with prior written consent.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">17. ASSIGNMENT</h2>
      <p>This Agreement may not be assigned by the Client without FFM's prior written consent. FFM may assign this Agreement, in whole or in part, to any affiliate or successor without the Client's consent.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">18. DISPUTE RESOLUTION</h2>
      <p>Any dispute arising from this Agreement shall first be resolved through good-faith negotiation between the parties. If the dispute cannot be resolved through negotiation within thirty (30) days, the dispute shall be submitted to mediation. If mediation fails, the dispute will be resolved through binding arbitration conducted in Brisbane, Queensland in accordance with the rules of the Resolution Institute.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">19. GOVERNING LAW</h2>
      <p>This Agreement shall be governed by and construed in accordance with the laws of <strong>Queensland, Australia</strong>, without reference to rules governing choice of laws. The parties submit to the exclusive jurisdiction of the courts of Queensland.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">20. SEVERABILITY</h2>
      <p>If any provision of this Agreement is held invalid, illegal, or unenforceable by a court of competent jurisdiction, the remainder of the Agreement will remain valid and enforceable, and the parties will negotiate in good faith a substitute provision which most nearly reflects the original intent.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">21. ENTIRE AGREEMENT</h2>
      <p>This Agreement represents and constitutes the <strong>entire agreement</strong> between the parties with respect to the subject matter hereof, and supersedes and merges all prior negotiations, agreements, and understandings, oral or written. This Agreement may not be altered, modified, or amended except in writing signed by both parties.</p>
      
      <h2 class="text-2xl font-bold mt-6 mb-4">22. NOTICES</h2>
      <p>All notices, demands, or other communications under this Agreement shall be in writing and delivered via email with read receipt, registered mail, or hand delivery to the addresses specified in this Agreement. Notices delivered by email shall be deemed received on the business day sent (or the next business day if sent after 5pm AEST). Mailed notices shall be deemed received three (3) business days after posting.</p>
      
      ${a.custom_notes&&a.custom_notes.length>0?`
      <h2 class="text-2xl font-bold mt-6 mb-4">ADDITIONAL TERMS & NOTES</h2>
      <p>The following additional terms and event-specific provisions apply to this Agreement:</p>
      ${a.custom_notes.map((c,w)=>`
        <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-4 my-4">
          <h3 class="text-lg font-bold mb-2">${c.title||`Custom Note ${w+1}`}</h3>
          <p class="whitespace-pre-wrap">${c.content||"[No content provided]"}</p>
        </div>
      `).join("")}
      `:""}
      
      <hr class="my-6 border-gray-700">
      
      <h2 class="text-2xl font-bold mt-6 mb-4">SIGNATURES</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
        <div class="border border-gray-700 rounded-lg p-6">
          <h3 class="text-lg font-bold mb-4">Fit Focus Media</h3>
          ${t.ffm_signature?`
            <img src="${t.ffm_signature}" alt="FFM Signature" class="max-w-full h-auto border border-gray-600 p-2 rounded bg-white mb-4" style="max-width: 300px;">
            <p><strong>Name:</strong> Brandon Hibbs</p>
            <p><strong>Signed:</strong> ${new Date(t.ffm_signed_at).toLocaleString("en-AU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,timeZoneName:"short"})}</p>
          `:'<p class="text-gray-500">[PENDING FFM SIGNATURE]</p>'}
        </div>
        
        <div class="border border-gray-700 rounded-lg p-6">
          <h3 class="text-lg font-bold mb-4">${s(a.org_name,"[ORGANIZATION]")}</h3>
          ${t.client_signature?`
            <img src="${t.client_signature}" alt="Client Signature" class="max-w-full h-auto border border-gray-600 p-2 rounded bg-white mb-4" style="max-width: 300px;">
            <p><strong>Name:</strong> ${s(a.promoter_name)}</p>
            <p><strong>Position:</strong> ${s(a.promoter_position)}</p>
            <p><strong>Signed:</strong> ${new Date(t.client_signed_at).toLocaleString("en-AU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,timeZoneName:"short"})}</p>
          `:'<p class="text-gray-500">[PENDING CLIENT SIGNATURE]</p>'}
        </div>
      </div>
    </div>
  `}function ft(t){const a=document.createElement("canvas");a.width=t.width,a.height=t.height;const s=a.getContext("2d"),y=t.getContext("2d").getImageData(0,0,t.width,t.height).data,x=s.createImageData(t.width,t.height),j=x.data;for(let c=0;c<y.length;c+=4)y[c+3]>10?(j[c]=0,j[c+1]=0,j[c+2]=0,j[c+3]=255):(j[c]=255,j[c+1]=255,j[c+2]=255,j[c+3]=255);return s.putImageData(x,0,0),a.toDataURL("image/png")}function is(t){return t.getContext("2d").getImageData(0,0,t.width,t.height).data.some(i=>i!==0)}function yt(t){const a=window.location.hostname;let s;return a==="localhost"||a.includes("192.168.")||a.includes("100.")?s="https://clawdbots-mini.tailcfdc1.ts.net:5198":s=window.location.origin,`${s}/#/contract/${t}`}function Ta(t,a,s){const i=yt(t);return{subject:`Event Media Coverage Agreement ‚Äî Fit Focus Media √ó ${s}`,body:`Hi ${a},

Please find your Event Media Coverage & Partnership Agreement with Fit Focus Media ready for review and signature.

Review & Sign Here:
${i}

Once you've reviewed the terms, you can sign directly on the page. If you have any questions, reply to this email.

Cheers,
Brandon Hibbs
Fit Focus Media
info@fitfocusmedia.com.au
www.fitfocusmedia.com.au`}}function Ct(t){return{draft:"üìù",sent:"üì§",viewed:"üëÄ",signed:"‚úÖ",expired:"‚ùå"}[t]||"üìÑ"}function os(t){return`${{draft:"bg-gray-600",sent:"bg-blue-600",viewed:"bg-yellow-600",signed:"bg-green-600",expired:"bg-red-600"}[t]||"bg-gray-600"} text-white px-3 py-1 rounded-full text-sm font-medium inline-flex items-center gap-2`}const Aa={draft:"bg-gray-700 text-gray-200",sent:"bg-blue-600/20 text-blue-400 border border-blue-500/30",viewed:"bg-yellow-600/20 text-yellow-400 border border-yellow-500/30",signed:"bg-green-600/20 text-green-400 border border-green-500/30",expired:"bg-red-600/20 text-red-400 border border-red-500/30"};function Pa(){const[t,a]=r.useState([]),[s,i]=r.useState([]),[l,y]=r.useState(!0),[x,j]=r.useState(""),[c,w]=r.useState(""),[z,p]=r.useState("created_desc"),[d,f]=r.useState({total:0,signedThisMonth:0,pending:0,drafts:0,value:0}),v=ve();r.useEffect(()=>{E()},[]),r.useEffect(()=>{D()},[t,x,c,z]);const E=async()=>{try{const o=await wt();a(o),A(o)}catch(o){console.error("Error loading contracts:",o)}finally{y(!1)}},A=o=>{const N=new Date,k=o.filter(_=>{if(_.status!=="signed")return!1;const T=new Date(_.created_at);return T.getMonth()===N.getMonth()&&T.getFullYear()===N.getFullYear()}),u=o.filter(_=>_.status==="sent"||_.status==="viewed"),F=o.filter(_=>_.status==="draft"),C=o.reduce((_,T)=>{const g=T.contract_data?.vip_price||0,L=T.contract_data?.expected_athletes||0;return _+g*L*.3},0);f({total:o.length,signedThisMonth:k.length,pending:u.length,drafts:F.length,value:Math.round(C)})},D=()=>{let o=[...t];if(x){const N=x.toLowerCase();o=o.filter(k=>(k.org_name||"").toLowerCase().includes(N)||(k.promoter_name||"").toLowerCase().includes(N)||(k.promoter_email||"").toLowerCase().includes(N))}c&&(o=o.filter(N=>N.status===c)),o.sort((N,k)=>{switch(z){case"created_asc":return new Date(N.created_at)-new Date(k.created_at);case"created_desc":return new Date(k.created_at)-new Date(N.created_at);case"org_name":return(N.org_name||"").localeCompare(k.org_name||"");case"status":return(N.status||"").localeCompare(k.status||"");default:return 0}}),i(o)};return l?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"text-gray-400 text-lg",children:"Loading contracts..."})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("h1",{className:"text-3xl font-black text-white tracking-tight",children:[e.jsx("span",{className:"text-red-500",children:"CONTRACT"})," MANAGEMENT"]}),e.jsxs("button",{onClick:()=>v("/portal/contracts/new"),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-bold transition-all hover:scale-105 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"+"})," Create New Contract"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[{label:"TOTAL CONTRACTS",value:d.total,color:"text-white",filter:""},{label:"DRAFTS",value:d.drafts,color:"text-yellow-500",filter:"draft"},{label:"SIGNED THIS MONTH",value:d.signedThisMonth,color:"text-green-500",filter:"signed"},{label:"PENDING SIGNATURES",value:d.pending,color:"text-blue-400",filter:""},{label:"TOTAL VALUE",value:`$${d.value.toLocaleString()}`,color:"text-red-400",filter:""}].map(({label:o,value:N,color:k,filter:u})=>e.jsxs("div",{onClick:()=>u!==void 0&&w(u),className:`bg-[#1a1a2e] rounded-xl p-5 border border-gray-800/50 ${u!==""?"cursor-pointer hover:border-gray-600 transition-colors":""}`,children:[e.jsx("div",{className:"text-[11px] font-bold text-gray-500 tracking-widest uppercase mb-3",children:o}),e.jsx("div",{className:`text-3xl font-black ${k}`,children:N})]},o))}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mb-6",children:[e.jsx("input",{type:"text",value:x,onChange:o=>j(o.target.value),placeholder:"Search by organization name...",className:"flex-1 px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500/40 focus:border-red-500/40"}),e.jsxs("select",{value:c,onChange:o=>w(o.target.value),className:"px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40 min-w-[160px]",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"viewed",children:"Viewed"}),e.jsx("option",{value:"signed",children:"Signed"}),e.jsx("option",{value:"expired",children:"Expired"})]}),e.jsxs("select",{value:z,onChange:o=>p(o.target.value),className:"px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40 min-w-[160px]",children:[e.jsx("option",{value:"created_desc",children:"Newest First"}),e.jsx("option",{value:"created_asc",children:"Oldest First"}),e.jsx("option",{value:"org_name",children:"Organization A-Z"}),e.jsx("option",{value:"status",children:"Status"})]})]}),s.length===0?e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-12 text-center border border-gray-800/50",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üìÑ"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:t.length===0?"No Contracts Yet":"No Contracts Found"}),e.jsx("p",{className:"text-gray-500 mb-6",children:t.length===0?"Create your first contract to get started":"Try adjusting your search or filters"}),t.length===0&&e.jsx("button",{onClick:()=>v("/portal/contracts/new"),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-bold transition-all",children:"Create New Contract"})]}):e.jsx("div",{className:"flex flex-col gap-3",children:s.map(o=>{const N=o.contract_data?.event_date?new Date(o.contract_data.event_date).toLocaleDateString("en-AU"):"Not set",k=new Date(o.created_at).toLocaleDateString("en-AU");return e.jsx("div",{onClick:()=>o.status==="draft"?v(`/portal/contracts/${o.id}/edit`):v(`/portal/contracts/${o.id}`),className:`bg-[#1a1a2e] rounded-xl p-5 border-l-4 ${o.status==="draft"?"border-l-yellow-500":"border-l-red-600"} border border-gray-800/50 hover:border-gray-700 cursor-pointer transition-all hover:bg-[#1f1f35] group`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-red-400 transition-colors",children:o.org_name||"Untitled Contract"}),e.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-1 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-wider",children:"Promoter"}),e.jsx("div",{className:"text-gray-300",children:o.promoter_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-wider",children:"Event Date"}),e.jsx("div",{className:"text-gray-300",children:N})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-wider",children:"Created"}),e.jsx("div",{className:"text-gray-300",children:k})]})]})]}),e.jsxs("span",{className:`px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider ${Aa[o.status]||"bg-gray-700 text-gray-300"}`,children:[Ct(o.status)," ",o.status]})]})},o.id)})})]})}const Zr=Object.freeze(Object.defineProperty({__proto__:null,default:Pa},Symbol.toStringTag,{value:"Module"}));function ds({onSignatureChange:t,className:a=""}){const s=r.useRef(null),i=r.useRef(!1),l=r.useRef({x:0,y:0});r.useEffect(()=>{const x=s.current;if(!x)return;const j=()=>{const c=x.getBoundingClientRect();x.width=c.width,x.height=c.height,x.getContext("2d").clearRect(0,0,x.width,x.height)};return setTimeout(j,100),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),r.useEffect(()=>{const x=s.current;if(!x)return;const j=x.getContext("2d"),c=d=>{const f=x.getBoundingClientRect(),v=(d.clientX||d.touches?.[0]?.clientX||0)-f.left,E=(d.clientY||d.touches?.[0]?.clientY||0)-f.top;return{x:v,y:E}},w=d=>{d.preventDefault(),i.current=!0;const f=c(d);l.current=f},z=d=>{if(!i.current)return;d.preventDefault();const f=c(d);j.strokeStyle="#ffffff",j.lineWidth=2,j.lineCap="round",j.lineJoin="round",j.beginPath(),j.moveTo(l.current.x,l.current.y),j.lineTo(f.x,f.y),j.stroke(),l.current=f,t&&t(x)},p=()=>{i.current=!1};return x.addEventListener("mousedown",w),x.addEventListener("mousemove",z),x.addEventListener("mouseup",p),x.addEventListener("mouseout",p),x.addEventListener("touchstart",w),x.addEventListener("touchmove",z),x.addEventListener("touchend",p),()=>{x.removeEventListener("mousedown",w),x.removeEventListener("mousemove",z),x.removeEventListener("mouseup",p),x.removeEventListener("mouseout",p),x.removeEventListener("touchstart",w),x.removeEventListener("touchmove",z),x.removeEventListener("touchend",p)}},[t]);const y=()=>{const x=s.current;if(!x)return;x.getContext("2d").clearRect(0,0,x.width,x.height),t&&t(x)};return e.jsxs("div",{className:"signature-canvas-container",children:[e.jsx("canvas",{ref:s,className:`border-2 border-gray-600 rounded-lg bg-gray-900 cursor-crosshair touch-none ${a}`,style:{width:"100%",height:"200px"}}),e.jsx("button",{type:"button",onClick:y,className:"mt-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Clear Signature"})]})}const Ae=6;function La({editMode:t=!1}){const{id:a}=Qe(),[s,i]=r.useState(1),[l,y]=r.useState({agreement_date:new Date().toISOString().split("T")[0],ffm_abn:"",org_name:"",promoter_name:"",promoter_position:"",promoter_email:"",promoter_phone:"",org_instagram:"",org_facebook:"",org_website:"",event_name:"",event_date:"",event_location:"",event_type:"BJJ / Grappling Competition",estimated_matches:"",expected_athletes:"",expected_audience:"",camera_angles:"2",camera_angles_max:"",crew_size:"2",crew_size_max:"",multi_event_count:"1",multi_event_duration:"",highlight_delivery_days:"7",highlight_delivery_days_max:"",social_clips_count:"5",social_clips_count_max:"",social_clips_delivery_days:"5",social_clips_delivery_days_max:"",photo_count:"50",photo_count_max:"",photography_included:!0,photography_type:"professional",livestream_included:!1,ppv_included:!1,ppv_platform:"",ppv_price:"",ppv_price_type:"fixed",ppv_price_max:"",ppv_ffm_split:"70",ppv_client_split:"30",ppv_payment_days:"21",vip_price:"350",match_price:"175",season_price:"899",athlete_revenue_ffm_100:!0,athlete_ffm_split:"80",athlete_client_split:"20",setup_hours:"2",internet_speed:"",schedule_hours_before:"48",athlete_list_days_before:"7",cancellation_fee:"500",initial_term_months:"12",renewal_period_months:"12",nonrenewal_notice_days:"60",termination_notice_days:"30",remedy_period_days:"14",pli_amount:"20000000"}),[x,j]=r.useState([]),[c,w]=r.useState([{name:"VIP Coverage",price:"350",description:"Full event coverage with priority editing, professional highlight reel, all match recordings, and premium photo package."},{name:"Match Package",price:"175",description:"Individual match recording with edited highlights and action photos from your matches."},{name:"Season Pass",price:"899",description:"Full season coverage across all events, priority processing, and exclusive content access."}]),[z,p]=r.useState([]),[d,f]=r.useState([]),[v,E]=r.useState(!1),[A,D]=r.useState(!1),[o,N]=r.useState(null),[k,u]=r.useState(t),[F,C]=r.useState(!0);r.useRef(null);const[_,T]=r.useState(null),[g,L]=r.useState(!1),[O,Y]=r.useState(null),B=ve();r.useEffect(()=>{t&&a&&X()},[t,a]);const X=async()=>{try{u(!0);const b=await ss(a);N(b);const S=b.contract_data||{};y(q=>({...q,...S})),S.multi_events&&j(S.multi_events),S.athlete_packages&&w(S.athlete_packages),S.add_ons&&p(S.add_ons),S.custom_notes&&f(S.custom_notes)}catch(b){console.error("Error loading contract:",b),alert("Failed to load contract for editing"),B("/portal/contracts")}finally{u(!1)}};r.useEffect(()=>{if(!t){const b=localStorage.getItem("contractBuilderData");if(b)try{const S=JSON.parse(b);y(S.formData||l),j(S.multiEvents||[]),S.athletePackages&&w(S.athletePackages),S.addOns&&p(S.addOns),S.customNotes&&f(S.customNotes),i(S.currentStep||1)}catch(S){console.error("Error loading saved data:",S)}}},[t]),r.useEffect(()=>{localStorage.setItem("contractBuilderData",JSON.stringify({formData:l,multiEvents:x,athletePackages:c,addOns:z,customNotes:d,currentStep:s}))},[l,x,c,z,d,s]);const P=b=>{const{name:S,value:q,type:K,checked:le}=b.target;y(se=>({...se,[S]:K==="checkbox"?le:q}))},h=()=>{j([...x,{name:"",date:"",venue:""}])},$=b=>{j(x.filter((S,q)=>q!==b))},I=(b,S,q)=>{const K=[...x];K[b][S]=q,j(K)},H=(b,S)=>{const q=b+S;if(q<0||q>=x.length)return;const K=[...x],[le]=K.splice(b,1);K.splice(q,0,le),j(K)},Q=()=>{w([...c,{name:"",price:"",description:""}])},R=b=>{w(c.filter((S,q)=>q!==b))},V=(b,S,q)=>{const K=[...c];K[b][S]=q,w(K)},J=()=>{p([...z,{name:"",price:"",description:"",included:!0}])},te=b=>{p(z.filter((S,q)=>q!==b))},ae=(b,S,q)=>{const K=[...z];K[b][S]=q,p(K)},ge=()=>{f([...d,{title:"",content:""}])},pe=b=>{f(d.filter((S,q)=>q!==b))},de=(b,S,q)=>{const K=[...d];K[b][S]=q,f(K)},re=b=>{const q={1:["org_name","promoter_name","promoter_position","promoter_email","promoter_phone"],2:["event_name","event_date","event_location","estimated_matches","expected_athletes","expected_audience"],3:[],4:[],5:[],6:[]}[b]||[];for(const K of q)if(!l[K]||l[K].trim()==="")return alert("Please fill in all required fields in this step."),!1;return!0},fe=()=>{re(s)&&s<Ae&&(i(s+1),window.scrollTo({top:0,behavior:"smooth"}))},ce=()=>{s>1&&(i(s-1),window.scrollTo({top:0,behavior:"smooth"}))},ne=b=>{i(b),window.scrollTo({top:0,behavior:"smooth"})},M=async b=>{b.preventDefault();const S=_&&is(_);if(!t){if(!S){alert("Please sign the contract before submitting.");return}if(!g){alert("Please confirm your signature.");return}}E(!0);try{const q={...l,multi_events:x,athlete_packages:c,add_ons:z,custom_notes:d};if(t&&o){const K={org_name:l.org_name,promoter_name:l.promoter_name,promoter_email:l.promoter_email,promoter_phone:l.promoter_phone,contract_data:q,updated_at:new Date().toISOString()};S&&g&&(K.ffm_signature=ft(_),K.ffm_signed_at=new Date().toISOString()),await Mt(a,K),alert("Contract updated successfully!"),B(`/portal/contracts/${a}`)}else{const K=ft(_),le=await Ot({status:"sent",org_name:l.org_name,promoter_name:l.promoter_name,promoter_email:l.promoter_email,promoter_phone:l.promoter_phone,contract_data:q,ffm_signature:K,ffm_signed_at:new Date().toISOString()});localStorage.removeItem("contractBuilderData"),alert("Contract created successfully! You can now share it with the client."),B(`/portal/contracts/${le.id}`)}}catch(q){console.error("Error saving contract:",q),alert("Failed to save contract: "+q.message)}finally{E(!1)}},G=async()=>{D(!0);try{const b={...l,multi_events:x,athlete_packages:c,add_ons:z,custom_notes:d};if(t&&o)await Mt(a,{status:o.status==="draft"?"draft":o.status,org_name:l.org_name||"Untitled Draft",promoter_name:l.promoter_name,promoter_email:l.promoter_email,promoter_phone:l.promoter_phone,contract_data:b}),Y(new Date),alert("Draft saved!");else{const S=await Ot({status:"draft",org_name:l.org_name||"Untitled Draft",promoter_name:l.promoter_name,promoter_email:l.promoter_email,promoter_phone:l.promoter_phone,contract_data:b});localStorage.removeItem("contractBuilderData"),B(`/portal/contracts/${S.id}/edit`,{replace:!0}),N(S),Y(new Date),alert("Draft saved! You can continue editing or come back later.")}}catch(b){console.error("Error saving draft:",b),alert("Failed to save draft: "+b.message)}finally{D(!1)}},n={contract_data:{...l,multi_events:x,athlete_packages:c,add_ons:z,custom_notes:d},ffm_signature:null,client_signature:null};return k?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-white text-xl",children:"Loading contract..."})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>B(t?`/portal/contracts/${a}`:"/portal/contracts"),className:"text-gray-400 hover:text-white mb-2 inline-flex items-center gap-2",children:["‚Üê ",t?"Back to Contract":"Back to Dashboard"]}),e.jsx("h1",{className:"text-3xl font-bold text-white",children:t?`Edit Contract: ${l.org_name||"Untitled"}`:"Create New Contract"})]}),e.jsxs("button",{onClick:()=>C(!F),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:[F?"Hide":"Show"," Preview"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"bg-dark-900 rounded-lg p-6 mb-6 border border-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:Array.from({length:Ae},(b,S)=>S+1).map(b=>e.jsx("button",{onClick:()=>ne(b),className:`flex-1 text-center py-2 px-3 rounded-lg font-medium transition-colors ${b===s?"bg-blue-600 text-white":b<s?"bg-green-600 text-white":"bg-gray-800 text-gray-400"} ${b<Ae?"mr-2":""}`,children:b},b))}),e.jsxs("div",{className:"text-center text-gray-400 text-sm",children:["Step ",s," of ",Ae]})]}),e.jsxs("form",{onSubmit:M,noValidate:!0,className:"bg-dark-900 rounded-lg p-6 border border-gray-800",children:[s===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Step 1: Party Details"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Agreement Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"agreement_date",value:l.agreement_date,onChange:P,required:!0,className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"FFM ABN"}),e.jsx("input",{type:"text",name:"ffm_abn",value:l.ffm_abn,onChange:P,placeholder:"Enter ABN if available",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Organization Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"org_name",value:l.org_name,onChange:P,required:!0,placeholder:"e.g., Queensland Grappling Association",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Promoter Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"promoter_name",value:l.promoter_name,onChange:P,required:!0,placeholder:"Full name of the promoter",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Promoter Position ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"promoter_position",value:l.promoter_position,onChange:P,required:!0,placeholder:"e.g., Event Director, CEO",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Promoter Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"promoter_email",value:l.promoter_email,onChange:P,required:!0,placeholder:"email@example.com",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Promoter Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"promoter_phone",value:l.promoter_phone,onChange:P,required:!0,placeholder:"+61 4XX XXX XXX",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-4",children:"Social & Web (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Instagram"}),e.jsx("input",{type:"text",name:"org_instagram",value:l.org_instagram,onChange:P,placeholder:"@yourorg",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Facebook"}),e.jsx("input",{type:"text",name:"org_facebook",value:l.org_facebook,onChange:P,placeholder:"facebook.com/yourorg",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Website"}),e.jsx("input",{type:"text",name:"org_website",value:l.org_website,onChange:P,placeholder:"https://yourorg.com",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]}),s===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Step 2: Event Details"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Event Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"event_name",value:l.event_name,onChange:P,required:!0,placeholder:"e.g., Queensland Open 2024",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Event Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"event_date",value:l.event_date,onChange:P,required:!0,className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Event Location ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"event_location",value:l.event_location,onChange:P,required:!0,placeholder:"Venue name and address",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Event Type"}),e.jsx("input",{type:"text",name:"event_type",value:l.event_type,onChange:P,placeholder:"e.g., BJJ / Grappling Competition",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Estimated Matches ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"estimated_matches",value:l.estimated_matches,onChange:P,required:!0,placeholder:"e.g., 200",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Expected Athlete Participants ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"expected_athletes",value:l.expected_athletes,onChange:P,required:!0,placeholder:"e.g., 400",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Expected Audience ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"expected_audience",value:l.expected_audience,onChange:P,required:!0,placeholder:"e.g., 300",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Multi-Event Count"}),e.jsx("input",{type:"number",name:"multi_event_count",value:l.multi_event_count,onChange:P,placeholder:"e.g., 1",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Multi-Event Duration"}),e.jsx("input",{type:"text",name:"multi_event_duration",value:l.multi_event_duration,onChange:P,placeholder:"e.g., 12 months",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Event Schedule (Optional)"}),e.jsx("button",{type:"button",onClick:h,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",children:"+ Add Event"})]}),x.map((b,S)=>e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg mb-2",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-gray-400 text-sm font-medium w-6",children:["#",S+1]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{type:"button",onClick:()=>H(S,-1),disabled:S===0,className:`px-2 py-0.5 rounded text-xs ${S===0?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-white hover:bg-dark-600"}`,title:"Move up",children:"‚ñ≤"}),e.jsx("button",{type:"button",onClick:()=>H(S,1),disabled:S===x.length-1,className:`px-2 py-0.5 rounded text-xs ${S===x.length-1?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-white hover:bg-dark-600"}`,title:"Move down",children:"‚ñº"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx("input",{type:"text",value:b.name,onChange:q=>I(S,"name",q.target.value),placeholder:"Event Name",className:"px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"date",value:b.date,onChange:q=>I(S,"date",q.target.value),className:"px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"text",value:b.venue,onChange:q=>I(S,"venue",q.target.value),placeholder:"Venue",className:"px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("button",{type:"button",onClick:()=>$(S),className:"text-red-500 hover:text-red-400 text-sm px-2",title:"Remove event",children:"‚úï"})]})},S))]})]}),s===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Step 3: Coverage & Deliverables"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:'üí° All fields support ranges. Leave "Max" empty for a single value, or enter a max to specify a range (e.g., "2-3").'}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Camera Angles"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"camera_angles",value:l.camera_angles,onChange:P,placeholder:"Min",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Min"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"camera_angles_max",value:l.camera_angles_max,onChange:P,placeholder:"Max (optional)",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Max (optional)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"On-Site Crew Size"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"crew_size",value:l.crew_size,onChange:P,placeholder:"Min",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Min"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"crew_size_max",value:l.crew_size_max,onChange:P,placeholder:"Max (optional)",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Max (optional)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Highlight Reel Delivery (Days)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"highlight_delivery_days",value:l.highlight_delivery_days,onChange:P,placeholder:"Min",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Min"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"highlight_delivery_days_max",value:l.highlight_delivery_days_max,onChange:P,placeholder:"Max (optional)",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Max (optional)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Social Media Clips Count"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"social_clips_count",value:l.social_clips_count,onChange:P,placeholder:"Min",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Min"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"social_clips_count_max",value:l.social_clips_count_max,onChange:P,placeholder:"Max (optional)",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Max (optional)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Social Clips Delivery (Days)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"social_clips_delivery_days",value:l.social_clips_delivery_days,onChange:P,placeholder:"Min",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Min"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"social_clips_delivery_days_max",value:l.social_clips_delivery_days_max,onChange:P,placeholder:"Max (optional)",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Max (optional)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Photography"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"photography_type",value:"none",checked:l.photography_type==="none",onChange:P,className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-300",children:"No photography included"})]}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"photography_type",value:"base",checked:l.photography_type==="base",onChange:P,className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-300",children:"Base event photography"})]}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"photography_type",value:"professional",checked:l.photography_type==="professional",onChange:P,className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-300",children:"Professional event photography"})]})]})]}),l.photography_type!=="none"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Photo Count"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"photo_count",value:l.photo_count,onChange:P,placeholder:"Min",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Min"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"photo_count_max",value:l.photo_count_max,onChange:P,placeholder:"Max (optional)",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500 mt-1 block",children:"Max (optional)"})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"livestream_included",name:"livestream_included",checked:l.livestream_included,onChange:P,className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"livestream_included",className:"ml-2 text-sm font-medium text-gray-300",children:"Livestream Included"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"ppv_included",name:"ppv_included",checked:l.ppv_included,onChange:P,className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"ppv_included",className:"ml-2 text-sm font-medium text-gray-300",children:"PPV Included"})]}),l.ppv_included&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"PPV Platform"}),e.jsx("input",{type:"text",name:"ppv_platform",value:l.ppv_platform,onChange:P,placeholder:"e.g., Vimeo, YouTube Live",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"PPV Pricing Type"}),e.jsxs("div",{className:"flex gap-4 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"ppv_price_type",value:"fixed",checked:l.ppv_price_type==="fixed",onChange:P,className:"text-orange-500 focus:ring-orange-500"}),e.jsx("span",{className:"text-gray-300",children:"Fixed Price"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"ppv_price_type",value:"range",checked:l.ppv_price_type==="range",onChange:P,className:"text-orange-500 focus:ring-orange-500"}),e.jsx("span",{className:"text-gray-300",children:"Price Range"})]})]}),l.ppv_price_type==="fixed"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"PPV Price per Viewer"}),e.jsx("input",{type:"number",name:"ppv_price",value:l.ppv_price,onChange:P,placeholder:"e.g., 25.00",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Minimum Price"}),e.jsx("input",{type:"number",name:"ppv_price",value:l.ppv_price,onChange:P,placeholder:"e.g., 25.00",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Maximum Price"}),e.jsx("input",{type:"number",name:"ppv_price_max",value:l.ppv_price_max,onChange:P,placeholder:"e.g., 35.00",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]})]}),s===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Step 4: Financial Terms"}),l.ppv_included&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-bold text-white mt-6",children:"PPV Revenue Split"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"FFM PPV Share (%)"}),e.jsx("input",{type:"number",name:"ppv_ffm_split",value:l.ppv_ffm_split,onChange:P,placeholder:"e.g., 70",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Client PPV Share (%)"}),e.jsx("input",{type:"number",name:"ppv_client_split",value:l.ppv_client_split,onChange:P,placeholder:"e.g., 30",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"PPV Payment Within (Days)"}),e.jsx("input",{type:"number",name:"ppv_payment_days",value:l.ppv_payment_days,onChange:P,placeholder:"e.g., 21",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Athlete Media Packages"}),e.jsx("button",{type:"button",onClick:Q,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",children:"+ Add Package"})]}),c.length===0&&e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:'No packages added. Click "+ Add Package" to create athlete media packages.'}),c.map((b,S)=>e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg mb-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-400",children:["Package ",S+1]}),e.jsx("button",{type:"button",onClick:()=>R(S),className:"text-red-500 hover:text-red-400 text-sm",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Package Name"}),e.jsx("input",{type:"text",value:b.name,onChange:q=>V(S,"name",q.target.value),placeholder:"e.g., VIP Coverage",className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Price ($)"}),e.jsx("input",{type:"number",value:b.price,onChange:q=>V(S,"price",q.target.value),placeholder:"e.g., 350",className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Description (what's included)"}),e.jsx("textarea",{value:b.description,onChange:q=>V(S,"description",q.target.value),placeholder:"Describe what this package includes...",rows:2,className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]})]},S))]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Client Add-Ons"}),e.jsx("button",{type:"button",onClick:J,className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors",children:"+ Add Add-On"})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Optional services or packages the client has opted into for this event."}),z.length===0&&e.jsx("p",{className:"text-gray-500 text-sm italic mb-4",children:'No add-ons added. Click "+ Add Add-On" to include optional services.'}),z.map((b,S)=>e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg mb-4 border border-green-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-green-400",children:["Add-On ",S+1]}),e.jsx("button",{type:"button",onClick:()=>te(S),className:"text-red-500 hover:text-red-400 text-sm",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Add-On Name"}),e.jsx("input",{type:"text",value:b.name,onChange:q=>ae(S,"name",q.target.value),placeholder:"e.g., Additional Camera Operator",className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Price ($)"}),e.jsx("input",{type:"number",value:b.price,onChange:q=>ae(S,"price",q.target.value),placeholder:"e.g., 500",className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:b.description,onChange:q=>ae(S,"description",q.target.value),placeholder:"Describe what this add-on includes...",rows:2,className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-green-500 resize-none"})]})]},S))]}),e.jsx("h3",{className:"text-lg font-bold text-white mt-6",children:"Athlete Revenue Split"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"athlete_revenue_ffm_100",name:"athlete_revenue_ffm_100",checked:l.athlete_revenue_ffm_100,onChange:P,className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"athlete_revenue_ffm_100",className:"ml-2 text-sm font-medium text-gray-300",children:"FFM Retains 100% of Athlete Media Package Sales"})]}),!l.athlete_revenue_ffm_100&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"FFM Athlete Revenue Share (%)"}),e.jsx("input",{type:"number",name:"athlete_ffm_split",value:l.athlete_ffm_split,onChange:P,placeholder:"e.g., 80",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Client Athlete Revenue Share (%)"}),e.jsx("input",{type:"number",name:"athlete_client_split",value:l.athlete_client_split,onChange:P,placeholder:"e.g., 20",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),s===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Step 5: Terms & Conditions"}),e.jsx("h3",{className:"text-lg font-bold text-white",children:"Access & Logistics"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Setup Hours Before Event"}),e.jsx("input",{type:"number",name:"setup_hours",value:l.setup_hours,onChange:P,placeholder:"e.g., 2",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Internet Upload Speed (Mbps)"}),e.jsx("input",{type:"text",name:"internet_speed",value:l.internet_speed,onChange:P,placeholder:"e.g., 50",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Event Schedule Provided (Hours Before)"}),e.jsx("input",{type:"number",name:"schedule_hours_before",value:l.schedule_hours_before,onChange:P,placeholder:"e.g., 48",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Athlete List Provided (Days Before)"}),e.jsx("input",{type:"number",name:"athlete_list_days_before",value:l.athlete_list_days_before,onChange:P,placeholder:"e.g., 7",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("h3",{className:"text-lg font-bold text-white mt-6",children:"Cancellation & Term"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cancellation Fee"}),e.jsx("input",{type:"number",name:"cancellation_fee",value:l.cancellation_fee,onChange:P,placeholder:"e.g., 500",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Initial Term (Months)"}),e.jsx("input",{type:"number",name:"initial_term_months",value:l.initial_term_months,onChange:P,placeholder:"e.g., 12",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Auto-Renewal Period (Months)"}),e.jsx("input",{type:"number",name:"renewal_period_months",value:l.renewal_period_months,onChange:P,placeholder:"e.g., 12",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Non-Renewal Notice (Days)"}),e.jsx("input",{type:"number",name:"nonrenewal_notice_days",value:l.nonrenewal_notice_days,onChange:P,placeholder:"e.g., 60",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Termination Notice (Days)"}),e.jsx("input",{type:"number",name:"termination_notice_days",value:l.termination_notice_days,onChange:P,placeholder:"e.g., 30",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Remedy Period (Days)"}),e.jsx("input",{type:"number",name:"remedy_period_days",value:l.remedy_period_days,onChange:P,placeholder:"e.g., 14",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Public Liability Insurance Amount"}),e.jsx("input",{type:"number",name:"pli_amount",value:l.pli_amount,onChange:P,placeholder:"e.g., 20000000",className:"w-full px-4 py-2 bg-dark-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Custom Contract Notes"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Add event-specific details like geo-blocking, special requirements, or custom terms."})]}),e.jsx("button",{type:"button",onClick:ge,className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm transition-colors",children:"+ Add Note"})]}),d.length===0&&e.jsx("p",{className:"text-gray-500 text-sm italic mb-4",children:'No custom notes added. Click "+ Add Note" to include event-specific details.'}),d.map((b,S)=>e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg mb-4 border border-purple-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-purple-400",children:["Custom Note ",S+1]}),e.jsx("button",{type:"button",onClick:()=>pe(S),className:"text-red-500 hover:text-red-400 text-sm",children:"Remove"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Note Title"}),e.jsx("input",{type:"text",value:b.title,onChange:q=>de(S,"title",q.target.value),placeholder:"e.g., Geo-Blocking Requirements, Special Access, etc.",className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Note Content"}),e.jsx("textarea",{value:b.content,onChange:q=>de(S,"content",q.target.value),placeholder:"Enter the details for this custom note...",rows:3,className:"w-full px-3 py-2 bg-dark-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"})]})]},S))]})]}),s===6&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Step 6: ",t?"Review & Save":"Sign Contract"]}),t&&o?.ffm_signature&&e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-green-200 text-sm mb-3",children:"‚úÖ This contract already has an FFM signature. You can update the contract details without re-signing, or provide a new signature below if needed."}),e.jsx("div",{className:"bg-white p-2 rounded inline-block",children:e.jsx("img",{src:o.ffm_signature,alt:"Existing FFM Signature",className:"max-h-24"})}),e.jsxs("p",{className:"text-green-300 text-xs mt-2",children:["Signed: ",new Date(o.ffm_signed_at).toLocaleString()]})]}),e.jsx("div",{className:"bg-yellow-900/20 border border-yellow-600 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-200 text-sm",children:t?"‚ö†Ô∏è Review your changes. If you want to update the signature, draw a new one below and check the confirmation box.":"‚ö†Ô∏è By signing this contract, you confirm that all information provided is accurate and you are authorized to create this agreement on behalf of Fit Focus Media."})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t?"New FFM Signature (optional)":"FFM Signature"}),e.jsx(ds,{onSignatureChange:b=>T(b)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"confirmSignature",checked:g,onChange:b=>L(b.target.checked),className:"w-4 h-4 text-blue-600 bg-dark-800 border-gray-700 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"confirmSignature",className:"ml-2 text-sm font-medium text-gray-300",children:t?"I want to update the signature with the new one above":"I confirm this is my signature and I am authorized to sign this contract"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s>1&&e.jsx("button",{type:"button",onClick:ce,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"‚Üê Previous"}),e.jsx("button",{type:"button",onClick:G,disabled:A,className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 disabled:bg-yellow-800 text-white rounded-lg transition-colors flex items-center gap-2",children:A?e.jsx(e.Fragment,{children:"üíæ Saving..."}):e.jsx(e.Fragment,{children:"üíæ Save Draft"})}),O&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Saved ",O.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s<Ae&&e.jsx("button",{type:"button",onClick:fe,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Next ‚Üí"}),s===Ae&&e.jsx("button",{type:"submit",disabled:v,className:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white rounded-lg transition-colors",children:v?t?"Updating Contract...":"Creating Contract...":t?"Update Contract":"Sign & Send Contract"})]})]})]})]}),F&&e.jsx("div",{className:"lg:sticky lg:top-8 lg:h-[calc(100vh-4rem)]",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg p-6 border border-gray-800 overflow-y-auto h-full",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Live Preview"}),e.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:kt(n)}})]})})]})]})}const el=Object.freeze(Object.defineProperty({__proto__:null,default:La},Symbol.toStringTag,{value:"Module"}));function Fa(){const{id:t}=Qe(),[a,s]=r.useState(null),[i,l]=r.useState(!0),y=ve();r.useEffect(()=>{x()},[t]);const x=async()=>{try{const f=await ss(t);s(f)}catch(f){console.error("Error loading contract:",f),alert("Contract not found"),y("/portal/contracts")}finally{l(!1)}},[j,c]=r.useState(!1),w=async()=>{const f=yt(a.share_token);try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(f);else{const v=document.createElement("textarea");v.value=f,v.style.position="fixed",v.style.left="-9999px",document.body.appendChild(v),v.focus(),v.select(),document.execCommand("copy"),document.body.removeChild(v)}c(!0),setTimeout(()=>c(!1),3e3)}catch{alert(`Copy this link:

`+f)}},z=()=>{const{subject:f,body:v}=Ta(a.share_token,a.contract_data?.promoter_name||"there",a.org_name||"Organization"),A=`mailto:${a.contract_data?.promoter_email||""}?subject=${encodeURIComponent(f)}&body=${encodeURIComponent(v)}`;window.open(A,"_blank"),navigator.clipboard.writeText(yt(a.share_token)).catch(()=>{})},p=()=>{window.print()},d=async()=>{if(confirm("Are you sure you want to delete this contract? This cannot be undone."))try{await qs(a.id),alert("Contract deleted successfully."),y("/portal/contracts")}catch(f){console.error("Error deleting contract:",f),alert("Failed to delete contract: "+f.message)}};return i?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-white text-xl",children:"Loading contract..."})}):a?e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6 print:hidden",children:[e.jsx("button",{onClick:()=>y("/portal/contracts"),className:"text-gray-400 hover:text-white mb-2 inline-flex items-center gap-2",children:"‚Üê Back to Dashboard"}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:a.org_name||"Untitled Contract"}),e.jsx("p",{className:"text-gray-400",children:a.promoter_name||"No promoter name"})]}),e.jsxs("span",{className:os(a.status),children:[Ct(a.status)," ",a.status]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6 print:hidden",children:[e.jsx("button",{onClick:w,className:`px-4 py-2 ${j?"bg-green-600":"bg-gray-700 hover:bg-gray-600"} text-white rounded-lg transition-colors`,children:j?"‚úÖ Copied!":"üìã Copy Link"}),a.status!=="signed"&&e.jsx("button",{onClick:z,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"üìß Send to Client"}),e.jsx("button",{onClick:p,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"üìÑ Download PDF"}),a.status!=="signed"&&e.jsx("button",{onClick:()=>y(`/portal/contracts/${a.id}/edit`),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors",children:"‚úèÔ∏è Edit Contract"}),e.jsx("button",{onClick:d,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors ml-auto",children:"üóëÔ∏è Delete"})]}),e.jsx("div",{className:"bg-dark-900 rounded-lg p-8 border border-gray-800",dangerouslySetInnerHTML:{__html:kt(a)}})]}):null}const tl=Object.freeze(Object.defineProperty({__proto__:null,default:Fa},Symbol.toStringTag,{value:"Module"}));function Ma(){const{shareToken:t}=Qe(),[a,s]=r.useState(null),[i,l]=r.useState(!0),[y,x]=r.useState(!1),[j,c]=r.useState(null);r.useEffect(()=>{w()},[t]);const w=async()=>{try{const d=await Vs(t);s(d),d.status==="sent"&&!d.viewed_at&&(await Gs(d.id),s({...d,status:"viewed",viewed_at:new Date().toISOString()}))}catch(d){console.error("Error loading contract:",d),alert("Contract not found")}finally{l(!1)}},z=async()=>{if(!j||!is(j)){alert("Please sign before submitting.");return}if(confirm("By signing, you agree to all terms and conditions in this agreement. This action cannot be undone.")){x(!0);try{const d=ft(j),f=await Hs(a.id,d,!0);s(f),alert("Contract signed successfully! Both parties will receive confirmation.")}catch(d){console.error("Error submitting signature:",d),alert("Failed to submit signature: "+d.message)}finally{x(!1)}}};if(i)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-xl",children:"Loading contract..."})});if(!a)return e.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"‚ùå"}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Contract Not Found"}),e.jsx("p",{className:"text-gray-400",children:"This contract link may be invalid or expired."})]})});const p=a.status!=="signed"&&!a.client_signature&&a.ffm_signature;return e.jsxs("div",{className:"min-h-screen bg-dark-950",children:[e.jsx("header",{className:"bg-dark-900 border-b border-gray-800 print:hidden",children:e.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:"Fit Focus Media"}),e.jsx("p",{className:"text-gray-400",children:"Event Media Coverage Agreement"})]}),e.jsxs("span",{className:os(a.status),children:[Ct(a.status)," ",a.status]})]})})}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-dark-900 rounded-lg p-8 border border-gray-800 mb-8",dangerouslySetInnerHTML:{__html:kt(a)}}),p&&e.jsxs("div",{className:"bg-dark-900 rounded-lg p-8 border border-gray-800 print:hidden",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Sign Agreement"}),e.jsx("div",{className:"bg-yellow-900/20 border border-yellow-600 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-yellow-200 text-sm",children:"‚ö†Ô∏è By signing this agreement, you acknowledge that you have read, understood, and agree to all terms and conditions outlined above. This signature is legally binding."})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Your Signature"}),e.jsx(ds,{onSignatureChange:d=>c(d)})]}),e.jsx("button",{onClick:z,disabled:y,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition-colors",children:y?"Submitting...":"‚úì Accept & Sign Contract"})]}),a.status==="signed"&&e.jsxs("div",{className:"bg-green-900/20 border border-green-600 rounded-lg p-6 text-center print:hidden",children:[e.jsx("div",{className:"text-5xl mb-3",children:"‚úÖ"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Contract Fully Executed"}),e.jsx("p",{className:"text-gray-300",children:"This contract has been signed by both parties. Both parties will receive confirmation."})]})]})]})}const sl=Object.freeze(Object.defineProperty({__proto__:null,default:Ma},Symbol.toStringTag,{value:"Module"}));async function Xe(){const{data:t,error:a}=await U.from("crm_leads").select("*").order("priority_score",{ascending:!1});return a?(console.error("Error fetching leads:",a),[]):t||[]}async function Oa(t){const{data:a,error:s}=await U.from("crm_leads").select("*").eq("id",t).single();return s?(console.error("Error fetching lead:",s),null):a}async function cs(t,a){const{data:s,error:i}=await U.from("crm_leads").update({...a,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(i)throw console.error("Error updating lead:",i),i;return s}async function Ue(t){const{data:a,error:s}=await U.from("crm_activities").select("*").eq("lead_id",t).order("created_at",{ascending:!1});return s?(console.error("Error fetching activities:",s),[]):a||[]}async function Ut(t,a){const{data:s,error:i}=await U.from("crm_activities").insert([{lead_id:t,type:a.type,notes:a.notes,created_at:new Date().toISOString()}]).select().single();if(i)throw console.error("Error adding activity:",i),i;return await U.from("crm_leads").update({last_contact:new Date().toISOString()}).eq("id",t),s}async function za(t,a){const{data:s,error:i}=await U.from("crm_activities").update({type:a.type,notes:a.notes}).eq("id",t).select().single();if(i)throw console.error("Error updating activity:",i),i;return s}async function Ra(t){const{error:a}=await U.from("crm_activities").delete().eq("id",t);if(a)throw console.error("Error deleting activity:",a),a;return!0}const xs=[{id:"cold-outreach",name:"Cold Outreach",subject:"{{org_name}} ‚Äî free event coverage?",body:`{{decision_maker || "Hey"}},

I'll keep this short.

We film {{sport}} events ‚Äî multi-camera, professional grade, full match coverage for every athlete. Livestream if you want it.

Here's the thing: you pay nothing.

We make money when athletes buy their footage through our portal after the event. You get free professional coverage. Athletes get content they actually want. Everyone wins.

We just covered NBA Sydney Nationals ‚Äî 400 athletes across 2 days. The org paid $0.

If that sounds interesting, I'll explain how it works in 10 minutes. If not, no worries.

Brandon
0411 934 935`},{id:"follow-up-1",name:"Follow-up #1",subject:"Re: {{org_name}} coverage",body:`{{decision_maker || "Hey"}},

Following up on my last email.

I know you're busy running events, so here's the short version:

‚Üí Professional multi-camera coverage for {{org_name}}
‚Üí Athletes buy their own footage (you don't lift a finger)
‚Üí You pay nothing. Ever.

We've done this for grappling comps, bodybuilding shows, and fight nights. Happy to send examples if useful.

10 minutes to see if it fits?

Brandon
0411 934 935`},{id:"meeting-request",name:"Meeting Request",subject:"{{org_name}} ‚Äî quick call?",body:`{{decision_maker || "Hey"}},

Thanks for getting back.

Here's what I'll cover (10 min max):
1. How the zero-cost model works (and why there's no catch)
2. What your athletes would actually receive
3. What we'd need from you (almost nothing)

Send me a time that works or just call me direct.

Brandon
0411 934 935`},{id:"post-meeting",name:"Post-Meeting Follow-up",subject:"{{org_name}} ‚Äî next steps",body:`{{decision_maker || "Hey"}},

Good chat. Here's the recap:

WHAT YOU GET (at zero cost):
‚Üí Multi-camera coverage, every mat, every match
‚Üí Livestream/PPV if you want it
‚Üí Event highlight reel for your socials
‚Üí Full photo gallery

WHAT ATHLETES GET:
‚Üí Professional footage of their matches
‚Üí Access through our portal
‚Üí Delivered within days of the event

WHAT IT COSTS YOU:
‚Üí $0 upfront
‚Üí $0 ongoing
‚Üí We make money on athlete purchases only

NEXT STEP:
I'm sending the agreement now. Read it, flag anything, we lock in the dates.

Questions? Call me.

Brandon
0411 934 935`},{id:"breakup",name:"Breakup Email",subject:"{{org_name}} ‚Äî closing the loop",body:`{{decision_maker || "Hey"}},

I've sent a few emails about covering {{org_name}} events. Haven't heard back, so I'll assume the timing's not right.

All good. If you ever want professional coverage at no cost, the offer stands.

Good luck with the season.

Brandon`}];function Ia(){return xs}function Ba(t,a){const s=xs.find(c=>c.id===t);if(!s)return null;const i={org_name:a.org_name||"",decision_maker:a.contact?.decision_maker||"",sport:a.sport||"",upcoming_event:a.events?.upcoming?.[0]||"",event_date:a.events?.upcoming?.[0]?.split(":")?.[1]?.trim()||""};let l=s.subject,y=s.body;const x=/\{\{(\w+)\s*\|\|\s*"([^"]*)"\}\}/g;l=l.replace(x,(c,w,z)=>i[w]||z),y=y.replace(x,(c,w,z)=>i[w]||z);const j=/\{\{(\w+)\}\}/g;return l=l.replace(j,(c,w)=>i[w]||""),y=y.replace(j,(c,w)=>i[w]||""),{subject:l,body:y}}async function ms(){const t=await Xe(),{data:a}=await U.from("crm_activities").select("*").order("created_at",{ascending:!1}),s=a||[],i={new:0,contacted:0,meeting:0,proposal:0,negotiating:0,signed:0,lost:0};t.forEach(v=>{const E=v.stage||"new";i.hasOwnProperty(E)&&i[E]++});const l=t.length,y=t.filter(v=>!["signed","lost","do_not_contact"].includes(v.stage)).length,x=i.signed,j=l>0?Math.round(x/l*100):0;let c=0;t.forEach(v=>{if(["proposal","negotiating","signed"].includes(v.stage)){const E=v.revenue_potential?.match(/\$(\d+)K/);E&&(c+=parseInt(E[1])*1e3)}});const w=new Date,z=new Date(w);z.setDate(w.getDate()-w.getDay()),z.setHours(0,0,0,0);const p=s.filter(v=>v.type==="Meeting"&&new Date(v.created_at)>=z).length,d=s.slice(0,10).map(v=>{const E=t.find(A=>A.id===v.lead_id);return{...v,lead_name:E?.org_name||"Unknown"}}),f={1:0,2:0,3:0};return t.forEach(v=>{f.hasOwnProperty(v.tier)&&f[v.tier]++}),{totalLeads:l,activeLeads:y,signedLeads:x,conversionRate:j,pipelineValue:c,meetingsThisWeek:p,stageCounts:i,tierCounts:f,recentActivities:d}}const vt=[{touch:1,name:"Initial Outreach",daysAfterPrevious:0,type:"initial"},{touch:2,name:"Value-Add Follow-up",daysAfterPrevious:3,type:"value"},{touch:3,name:"Social Proof",daysAfterPrevious:5,type:"proof"},{touch:4,name:"Meeting Request",daysAfterPrevious:5,type:"meeting"},{touch:5,name:"Permission to Close",daysAfterPrevious:7,type:"breakup"}];function Ua(t,a=1){if(!t)return null;const s=new Date(t),i=vt[a];if(!i)return null;let l=0;for(let x=1;x<=a;x++)l+=vt[x].daysAfterPrevious;const y=new Date(s);return y.setDate(y.getDate()+l),{touch:i.touch,name:i.name,type:i.type,dueDate:y,daysUntilDue:Math.ceil((y-new Date)/(1e3*60*60*24))}}function qa(t){let a=1;(t.stage==="contacted"||t.stage==="meeting"||t.stage==="proposal")&&(a=1);const s=Ua(t.last_contact,a);if(!s)return{status:"complete",...t};const{daysUntilDue:i}=s;let l="upcoming";return i<0?l="overdue":i===0?l="today":i<=2&&(l="soon"),{...t,nextTouch:s,status:l,daysUntilDue:i}}function Va(){const[t,a]=r.useState([]),[s,i]=r.useState(!0),[l,y]=r.useState("all");r.useEffect(()=>{x()},[]);const x=async()=>{i(!0);try{const f=(await Xe()).filter(v=>["new","contacted","meeting"].includes(v.stage)&&v.last_contact);a(f.map(qa))}catch(d){console.error("Error loading leads:",d)}finally{i(!1)}},c=l==="all"?t:t.filter(d=>d.status===l),w=t.filter(d=>d.status==="overdue").length,z=t.filter(d=>d.status==="today").length,p=t.filter(d=>d.status==="soon").length;return s?e.jsx("div",{className:"text-gray-400",children:"Loading follow-ups..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white",children:"Follow-Up Scheduler"}),e.jsx("p",{className:"text-gray-400 text-xs sm:text-sm mt-1",children:"5-Touch outreach strategy tracker"})]}),e.jsxs("div",{className:"flex gap-4 sm:gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-500",children:w}),e.jsx("div",{className:"text-xs text-gray-400",children:"Overdue"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-yellow-500",children:z}),e.jsx("div",{className:"text-xs text-gray-400",children:"Today"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-500",children:p}),e.jsx("div",{className:"text-xs text-gray-400",children:"Soon"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","overdue","today","soon","upcoming"].map(d=>e.jsx("button",{onClick:()=>y(d),className:`px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-all ${l===d?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:d.charAt(0).toUpperCase()+d.slice(1)},d))}),c.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 sm:p-8 text-center text-gray-400",children:[e.jsx(bs,{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2 sm:mb-3 text-green-500"}),e.jsxs("p",{className:"text-sm sm:text-base",children:["No follow-ups ",l!=="all"?l:"needed","!"]})]}):e.jsx("div",{className:"space-y-3",children:c.map(d=>e.jsx("div",{className:`bg-gray-800 rounded-lg p-3 sm:p-4 border-l-4 ${d.status==="overdue"?"border-red-500":d.status==="today"?"border-yellow-500":d.status==="soon"?"border-blue-500":"border-gray-600"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 flex-wrap",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white truncate",children:d.org_name}),e.jsxs("span",{className:`px-2 py-0.5 sm:py-1 rounded text-xs font-medium flex-shrink-0 ${d.tier===1?"bg-red-900 text-red-200":d.tier===2?"bg-yellow-900 text-yellow-200":"bg-blue-900 text-blue-200"}`,children:["Tier ",d.tier]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4 text-xs sm:text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Touch ",d.nextTouch.touch,": ",d.nextTouch.name]})]}),e.jsxs("div",{className:"flex items-center gap-4 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsxs("span",{children:["Due: ",d.nextTouch.dueDate.toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:d.status==="overdue"?"text-red-400 font-medium":d.status==="today"?"text-yellow-400 font-medium":"text-gray-400",children:d.daysUntilDue===0?"Today":d.daysUntilDue<0?`${Math.abs(d.daysUntilDue)} days overdue`:`In ${d.daysUntilDue} days`})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-end sm:self-auto",children:[d.status==="overdue"&&e.jsx(Ze,{className:"w-5 h-5 text-red-500 hidden sm:block"}),e.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm font-medium transition-all whitespace-nowrap",children:"Send Follow-Up"})]})]})},d.id))}),e.jsxs("details",{className:"bg-gray-800 rounded-lg",children:[e.jsxs("summary",{className:"p-3 sm:p-4 text-xs sm:text-sm font-bold text-white cursor-pointer list-none flex items-center justify-between",children:["5-Touch Strategy Timeline",e.jsx("span",{className:"text-gray-500 text-xs",children:"tap to expand"})]}),e.jsxs("div",{className:"px-3 sm:px-4 pb-3 sm:pb-4 space-y-2 text-xs sm:text-sm",children:[vt.map((d,f)=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-gray-400",children:[e.jsxs("span",{className:"font-mono text-[10px] sm:text-xs bg-gray-700 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded",children:["T",d.touch]}),e.jsx("span",{className:"flex-1 text-xs sm:text-sm",children:d.name}),e.jsx("span",{className:"text-[10px] sm:text-xs",children:f===0?"Initial":`+${d.daysAfterPrevious} days`})]},d.touch)),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-700 text-[10px] sm:text-xs text-gray-500",children:"üí° Research shows 80% of sales happen between Touch 5-12. Don't give up early!"})]})]})]})}const ct=["#ef4444","#f59e0b","#3b82f6"],Pe={new:"#6b7280",contacted:"#3b82f6",meeting:"#8b5cf6",proposal:"#eab308",negotiating:"#f97316",signed:"#10b981"};function Ga(){const t=ve(),[a,s]=r.useState(null),[i,l]=r.useState([]),[y,x]=r.useState(!0),[j,c]=r.useState(""),[w,z]=r.useState(""),[p,d]=r.useState("");r.useEffect(()=>{f()},[]);const f=async()=>{x(!0);try{const[D,o]=await Promise.all([ms(),Xe()]);s(D),l(o)}catch(D){console.error("Error loading CRM data:",D)}finally{x(!1)}},v=()=>{let D=i;return j&&(D=D.filter(o=>o.tier===parseInt(j))),w&&(D=D.filter(o=>o.sport?.toLowerCase().includes(w.toLowerCase()))),p&&(D=D.filter(o=>o.stage===p)),D};if(y)return e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"text-gray-400 text-lg",children:"Loading CRM data..."})});const E=[{name:"New",value:a.stageCounts.new,color:Pe.new},{name:"Contacted",value:a.stageCounts.contacted,color:Pe.contacted},{name:"Meeting",value:a.stageCounts.meeting,color:Pe.meeting},{name:"Proposal",value:a.stageCounts.proposal,color:Pe.proposal},{name:"Negotiating",value:a.stageCounts.negotiating,color:Pe.negotiating},{name:"Signed",value:a.stageCounts.signed,color:Pe.signed}],A=[{name:"Tier 1",value:a.tierCounts[1]||0,color:ct[0]},{name:"Tier 2",value:a.tierCounts[2]||0,color:ct[1]},{name:"Tier 3",value:a.tierCounts[3]||0,color:ct[2]}].filter(D=>D.value>0);return e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4 mb-6 sm:mb-8",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-black text-white tracking-tight",children:[e.jsx("span",{className:"text-red-500",children:"CRM"})," DASHBOARD"]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs("button",{onClick:f,className:"bg-gray-700 hover:bg-gray-600 text-white px-3 sm:px-4 py-2 rounded-lg font-medium transition-all flex items-center justify-center gap-2 text-xs sm:text-sm flex-1 sm:flex-none",children:[e.jsx(De,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),"Refresh"]}),e.jsx("button",{onClick:()=>t("/portal/pipeline/board"),className:"bg-red-600 hover:bg-red-700 text-white px-4 sm:px-6 py-2 rounded-lg font-bold transition-all hover:scale-105 text-xs sm:text-sm flex-1 sm:flex-none whitespace-nowrap",children:"View Pipeline Board"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 mb-6 sm:mb-8",children:[e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx(We,{size:16,className:"text-gray-500 sm:w-5 sm:h-5"}),e.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Total Leads"})]}),e.jsx("div",{className:"text-2xl sm:text-3xl font-black text-white",children:a.totalLeads})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx($e,{size:16,className:"text-pink-500 sm:w-5 sm:h-5"}),e.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Conversion"})]}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-black text-pink-500",children:[a.conversionRate,"%"]})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx(He,{size:16,className:"text-purple-500 sm:w-5 sm:h-5"}),e.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Meetings"})]}),e.jsx("div",{className:"text-2xl sm:text-3xl font-black text-purple-500",children:a.meetingsThisWeek})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-3 sm:p-5 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsx(Se,{size:16,className:"text-red-400 sm:w-5 sm:h-5"}),e.jsx("div",{className:"text-[9px] sm:text-[11px] font-bold text-gray-500 tracking-wider sm:tracking-widest uppercase",children:"Pipeline"})]}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-black text-red-400",children:["$",(a.pipelineValue/1e3).toFixed(0),"K"]})]})]}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsx(Va,{})}),e.jsxs("div",{className:"hidden sm:grid md:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsxs("div",{className:"md:col-span-2 bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Pipeline Funnel"}),e.jsx(It,{width:"100%",height:200,children:e.jsxs(ga,{data:E,layout:"vertical",children:[e.jsx(ha,{type:"number",stroke:"#6b7280"}),e.jsx(ua,{dataKey:"name",type:"category",stroke:"#6b7280",width:80,tick:{fontSize:12}}),e.jsx(pa,{dataKey:"value",radius:[0,8,8,0],children:E.map((D,o)=>e.jsx(Bt,{fill:D.color},`cell-${o}`))})]})})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Leads by Tier"}),e.jsx(It,{width:"100%",height:200,children:e.jsx(ba,{children:e.jsx(fa,{data:A,cx:"50%",cy:"50%",innerRadius:50,outerRadius:75,dataKey:"value",label:D=>`${D.name}: ${D.value}`,children:A.map((D,o)=>e.jsx(Bt,{fill:D.color},`cell-${o}`))})})})]})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[e.jsx(Yt,{size:16,className:"text-gray-500 sm:w-5 sm:h-5"}),e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white",children:"Quick Filters"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:[e.jsxs("select",{value:j,onChange:D=>c(D.target.value),className:"px-3 sm:px-4 py-2 sm:py-3 bg-[#12122a] border border-gray-800/50 rounded-lg sm:rounded-xl text-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40",children:[e.jsx("option",{value:"",children:"All Tiers"}),e.jsx("option",{value:"1",children:"Tier 1"}),e.jsx("option",{value:"2",children:"Tier 2"}),e.jsx("option",{value:"3",children:"Tier 3"})]}),e.jsxs("select",{value:p,onChange:D=>d(D.target.value),className:"px-3 sm:px-4 py-2 sm:py-3 bg-[#12122a] border border-gray-800/50 rounded-lg sm:rounded-xl text-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"meeting",children:"Meeting Booked"}),e.jsx("option",{value:"proposal",children:"Proposal Sent"}),e.jsx("option",{value:"negotiating",children:"Negotiating"}),e.jsx("option",{value:"signed",children:"Signed"}),e.jsx("option",{value:"lost",children:"Lost"})]}),e.jsx("input",{type:"text",value:w,onChange:D=>z(D.target.value),placeholder:"Filter by sport...",className:"col-span-2 sm:col-span-1 px-3 sm:px-4 py-2 sm:py-3 bg-[#12122a] border border-gray-800/50 rounded-lg sm:rounded-xl text-white placeholder-gray-600 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40"})]}),(j||w||p)&&e.jsx("div",{className:"mt-3 sm:mt-4",children:e.jsxs("div",{className:"text-xs sm:text-sm text-gray-400",children:["Showing ",v().length," of ",a.totalLeads," leads"]})})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50 mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Recent Activity"}),a.recentActivities.length===0?e.jsx("div",{className:"text-gray-500 text-center py-6 sm:py-8 text-sm",children:"No recent activity"}):e.jsx("div",{className:"space-y-2 sm:space-y-3",children:a.recentActivities.map(D=>e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 p-3 sm:p-4 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-gray-700 transition-all",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 bg-red-600/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-red-400 text-base sm:text-xl",children:D.type==="Phone Call"?"üìû":D.type==="Email"?"üìß":D.type==="Meeting"?"ü§ù":"üìù"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("span",{className:"font-bold text-white text-sm sm:text-base",children:D.lead_name}),e.jsx("span",{className:"text-gray-600",children:"‚Ä¢"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-bold text-gray-500 uppercase",children:D.type})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mb-1 line-clamp-2",children:D.notes}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-600",children:new Date(D.created_at).toLocaleDateString("en-AU",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]},D.id))})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-4 sm:p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-white mb-3 sm:mb-4",children:"Follow-up Reminders"}),e.jsxs("div",{className:"text-gray-500 text-center py-6 sm:py-8 text-sm",children:["No pending follow-ups",e.jsx("div",{className:"text-xs sm:text-sm mt-2",children:"Add activities with due dates to see reminders here"})]})]})]})}const al=Object.freeze(Object.defineProperty({__proto__:null,default:Ga},Symbol.toStringTag,{value:"Module"})),Ha=[{id:"new",name:"New",color:"bg-gray-600",textColor:"text-gray-300"},{id:"contacted",name:"Contacted",color:"bg-blue-600",textColor:"text-blue-400"},{id:"meeting",name:"Meeting Booked",color:"bg-purple-600",textColor:"text-purple-400"},{id:"proposal",name:"Proposal Sent",color:"bg-yellow-600",textColor:"text-yellow-400"},{id:"negotiating",name:"Negotiating",color:"bg-orange-600",textColor:"text-orange-400"},{id:"signed",name:"Signed",color:"bg-green-600",textColor:"text-green-400"},{id:"lost",name:"Lost",color:"bg-red-600",textColor:"text-red-400"}];function Wa({lead:t,onDragStart:a}){const s=ve(),i=l=>l>=80?"bg-red-600 text-red-100":l>=60?"bg-orange-600 text-orange-100":"bg-gray-600 text-gray-100";return e.jsxs("div",{draggable:!0,onDragStart:a,onClick:()=>s(`/portal/pipeline/leads/${t.id}`),className:"bg-[#12122a] rounded-lg p-4 border border-gray-800/50 hover:border-gray-700 cursor-move hover:bg-[#16162e] transition-all group",children:[e.jsx("h4",{className:"font-bold text-white group-hover:text-red-400 transition-colors mb-2 line-clamp-2",children:t.org_name}),e.jsxs("div",{className:"space-y-1.5 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(Kt,{size:14}),e.jsx("span",{className:"truncate",children:t.sport})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(rt,{size:14}),e.jsx("span",{className:"truncate",children:t.location})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-bold ${i(t.priority_score)}`,children:["Priority: ",t.priority_score]}),e.jsxs("span",{className:"text-xs font-bold text-gray-600 uppercase",children:["Tier ",t.tier]})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-800/50 space-y-1",children:[e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("span",{className:"font-bold",children:"Last Contact:"})," ",t.last_contact?new Date(t.last_contact).toLocaleDateString("en-AU"):"Never"]}),t.revenue_potential&&e.jsx("div",{className:"text-xs text-green-400 font-medium",children:t.revenue_potential})]})]})}function Ya({column:t,leads:a,onDrop:s,onDragOver:i}){return e.jsxs("div",{onDrop:s,onDragOver:i,className:"flex flex-col min-h-[500px]",children:[e.jsx("div",{className:`${t.color} rounded-t-xl px-4 py-3 mb-3`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-white text-sm uppercase tracking-wider",children:t.name}),e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs font-bold text-white",children:a.length})]})}),e.jsx("div",{className:"flex-1 space-y-3 px-2",children:a.length===0?e.jsx("div",{className:"text-center text-gray-600 text-sm py-8",children:"No leads"}):a.map(l=>e.jsx(Wa,{lead:l,onDragStart:y=>{y.dataTransfer.effectAllowed="move",y.dataTransfer.setData("leadId",l.id)}},l.id))})]})}function Ka(){const t=ve(),[a,s]=r.useState([]),[i,l]=r.useState({totalLeads:0,activeLeads:0,meetingsThisWeek:0,pipelineValue:0}),[y,x]=r.useState(!0);r.useEffect(()=>{j()},[]);const j=async()=>{x(!0);try{const[p,d]=await Promise.all([Xe(),ms()]);s(p),l({totalLeads:d.totalLeads,activeLeads:d.activeLeads,meetingsThisWeek:d.meetingsThisWeek,pipelineValue:d.pipelineValue})}catch(p){console.error("Error loading pipeline data:",p)}finally{x(!1)}},c=async(p,d)=>{p.preventDefault();const f=p.dataTransfer.getData("leadId");if(f)try{await cs(f,{stage:d}),await j()}catch(v){console.error("Error updating lead:",v)}},w=p=>{p.preventDefault()},z=p=>a.filter(d=>d.stage===p);return y?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"text-gray-400 text-lg",children:"Loading pipeline..."})}):e.jsxs("div",{className:"min-h-screen bg-[#0d0d1a] pb-8",children:[e.jsx("div",{className:"bg-[#1a1a2e] border-b border-gray-800/50 mb-6",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t("/portal/pipeline"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(Ie,{size:24})}),e.jsxs("h1",{className:"text-3xl font-black text-white tracking-tight",children:[e.jsx("span",{className:"text-red-500",children:"PIPELINE"})," BOARD"]})]}),e.jsxs("button",{onClick:j,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 text-sm",children:[e.jsx(De,{size:18}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-[#12122a] rounded-xl p-4 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(We,{size:18,className:"text-gray-500"}),e.jsx("div",{className:"text-[10px] font-bold text-gray-500 tracking-widest uppercase",children:"Total Leads"})]}),e.jsx("div",{className:"text-2xl font-black text-white",children:i.totalLeads})]}),e.jsxs("div",{className:"bg-[#12122a] rounded-xl p-4 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($e,{size:18,className:"text-pink-500"}),e.jsx("div",{className:"text-[10px] font-bold text-gray-500 tracking-widest uppercase",children:"Active Pipeline"})]}),e.jsx("div",{className:"text-2xl font-black text-pink-500",children:i.activeLeads})]}),e.jsxs("div",{className:"bg-[#12122a] rounded-xl p-4 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(we,{size:18,className:"text-purple-500"}),e.jsx("div",{className:"text-[10px] font-bold text-gray-500 tracking-widest uppercase",children:"Meetings This Week"})]}),e.jsx("div",{className:"text-2xl font-black text-purple-500",children:i.meetingsThisWeek})]}),e.jsxs("div",{className:"bg-[#12122a] rounded-xl p-4 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Se,{size:18,className:"text-red-400"}),e.jsx("div",{className:"text-[10px] font-bold text-gray-500 tracking-widest uppercase",children:"Pipeline Value"})]}),e.jsxs("div",{className:"text-2xl font-black text-red-400",children:["$",(i.pipelineValue/1e3).toFixed(0),"K"]})]})]})]})}),e.jsx("div",{className:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-7 gap-4",children:Ha.map(p=>e.jsx(Ya,{column:p,leads:z(p.id),onDrop:d=>c(d,p.id),onDragOver:w},p.id))})})]})}const rl=Object.freeze(Object.defineProperty({__proto__:null,default:Ka},Symbol.toStringTag,{value:"Module"})),xt=[{value:"new",label:"New",color:"bg-gray-600"},{value:"contacted",label:"Contacted",color:"bg-blue-600"},{value:"meeting",label:"Meeting Booked",color:"bg-purple-600"},{value:"proposal",label:"Proposal Sent",color:"bg-yellow-600"},{value:"negotiating",label:"Negotiating",color:"bg-orange-600"},{value:"signed",label:"Signed",color:"bg-green-600"},{value:"lost",label:"Lost",color:"bg-red-600"}],mt=[{value:"Phone Call",icon:"üìû"},{value:"Email",icon:"üìß"},{value:"Meeting",icon:"ü§ù"},{value:"Note",icon:"üìù"},{value:"Follow-up",icon:"üîî"}];function Qa(){const{id:t}=Qe(),a=ve(),[s,i]=r.useState(null),[l,y]=r.useState([]),[x,j]=r.useState(!1),[c,w]=r.useState(null),[z,p]=r.useState(!0),[d,f]=r.useState(!1),[v,E]=r.useState(!1),[A,D]=r.useState("Phone Call"),[o,N]=r.useState(""),[k,u]=r.useState(null),[F,C]=r.useState(""),[_,T]=r.useState("");r.useEffect(()=>{t&&g()},[t]);const g=async()=>{p(!0);try{const[$,I]=await Promise.all([Oa(t),Ue(t)]);$&&(i($),w($),y(I))}catch($){console.error("Error loading lead:",$)}finally{p(!1)}};if(z)return e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"text-gray-400 text-lg",children:"Loading lead..."})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"text-gray-400 text-lg",children:"Lead not found"})});const L=async()=>{f(!0);try{await cs(t,c),i(c),j(!1)}catch($){console.error("Error saving lead:",$),alert("Error saving lead")}finally{f(!1)}},O=async()=>{if(!o.trim()){alert("Please enter activity notes");return}try{await Ut(t,{type:A,notes:o});const $=await Ue(t);y($),N(""),E(!1)}catch($){console.error("Error adding activity:",$),alert("Error adding activity")}},Y=$=>{u($.id),C($.type),T($.notes)},B=async()=>{try{await za(k,{type:F,notes:_});const $=await Ue(t);y($),u(null)}catch($){console.error("Error updating activity:",$),alert("Error updating activity")}},X=async $=>{if(confirm("Are you sure you want to delete this activity?"))try{await Ra($);const I=await Ue(t);y(I)}catch(I){console.error("Error deleting activity:",I),alert("Error deleting activity")}},P=async $=>{try{await Ut(t,{type:$,notes:`Quick ${$.toLowerCase()} logged`});const I=await Ue(t);y(I)}catch(I){console.error("Error logging activity:",I)}},h=xt.find($=>$.value===s.stage)?.color||"bg-gray-600";return e.jsxs("div",{className:"min-h-screen bg-[#0d0d1a]",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#1a1a2e] to-[#16162a] border-b border-gray-800/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>a("/portal/pipeline/board"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(Ie,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-white tracking-tight",children:s.org_name}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:s.sport}),e.jsx("span",{className:"text-gray-700",children:"‚Ä¢"}),e.jsx("span",{className:"text-sm text-gray-400",children:s.location}),e.jsx("span",{className:"text-gray-700",children:"‚Ä¢"}),e.jsx("span",{className:"text-sm text-gray-400",children:s.type})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`${h} px-4 py-2 rounded-lg text-white text-sm font-bold uppercase`,children:xt.find($=>$.value===s.stage)?.label||s.stage}),x?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:L,disabled:d,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 disabled:opacity-50",children:[e.jsx(fs,{size:16})," ",d?"Saving...":"Save"]}),e.jsxs("button",{onClick:()=>{j(!1),w(s)},className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2",children:[e.jsx(Dt,{size:16})," Cancel"]})]}):e.jsxs("button",{onClick:()=>j(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2",children:[e.jsx(ut,{size:16})," Edit"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-red-600/20 border border-red-500/30 px-3 py-1 rounded-full",children:e.jsxs("span",{className:"text-red-400 font-bold text-sm",children:["Priority: ",s.priority_score]})}),e.jsx("div",{className:"bg-blue-600/20 border border-blue-500/30 px-3 py-1 rounded-full",children:e.jsxs("span",{className:"text-blue-400 font-bold text-sm",children:["Tier ",s.tier]})}),e.jsx("div",{className:`${s.verification_status==="verified"?"bg-green-600/20 border-green-500/30 text-green-400":"bg-yellow-600/20 border-yellow-500/30 text-yellow-400"} border px-3 py-1 rounded-full`,children:e.jsxs("span",{className:"font-bold text-sm flex items-center gap-1",children:[e.jsx(pt,{size:14})," ",s.verification_status]})})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Contact Information"}),x?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Email"}),e.jsx("input",{type:"email",value:c.contact?.email||"",onChange:$=>w({...c,contact:{...c.contact,email:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Phone"}),e.jsx("input",{type:"tel",value:c.contact?.phone||"",onChange:$=>w({...c,contact:{...c.contact,phone:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"0400 000 000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Website"}),e.jsx("input",{type:"url",value:c.contact?.website||"",onChange:$=>w({...c,contact:{...c.contact,website:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Instagram"}),e.jsx("input",{type:"text",value:c.contact?.instagram||"",onChange:$=>w({...c,contact:{...c.contact,instagram:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"@username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Facebook"}),e.jsx("input",{type:"text",value:c.contact?.facebook||"",onChange:$=>w({...c,contact:{...c.contact,facebook:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"PageName"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Contact Form URL"}),e.jsx("input",{type:"url",value:c.contact?.contact_form||"",onChange:$=>w({...c,contact:{...c.contact,contact_form:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"https://example.com/contact"})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Decision Maker"}),e.jsx("input",{type:"text",value:c.contact?.decision_maker||"",onChange:$=>w({...c,contact:{...c.contact,decision_maker:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1 block",children:"Avatar URL"}),e.jsx("input",{type:"url",value:c.contact?.avatar||"",onChange:$=>w({...c,contact:{...c.contact,avatar:$.target.value}}),className:"w-full bg-[#12122a] border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:border-red-500 focus:outline-none",placeholder:"https://example.com/photo.jpg"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[(s.contact?.email||x)&&e.jsxs("a",{href:`mailto:${s.contact?.email}`,className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(Ce,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"Email"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400 truncate",children:s.contact?.email||"‚Äî"})]})]}),(s.contact?.phone||x)&&e.jsxs("a",{href:`tel:${s.contact?.phone}`,className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(et,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"Phone"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400",children:s.contact?.phone||"‚Äî"})]})]}),(s.contact?.website||x)&&e.jsxs("a",{href:s.contact?.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(Qt,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"Website"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400 truncate",children:s.contact?.website||"‚Äî"})]})]}),(s.contact?.instagram||x)&&e.jsxs("a",{href:`https://instagram.com/${s.contact?.instagram?.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(ys,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"Instagram"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400",children:s.contact?.instagram||"‚Äî"})]})]}),s.contact?.facebook&&e.jsxs("a",{href:`https://facebook.com/${s.contact?.facebook}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(vs,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"Facebook"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400",children:s.contact?.facebook||"‚Äî"})]})]}),s.contact?.linkedin&&e.jsxs("a",{href:`https://linkedin.com/in/${s.contact?.linkedin}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(js,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"LinkedIn"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400 truncate",children:s.contact?.linkedin||"‚Äî"})]})]}),s.contact?.decision_maker_instagram&&e.jsxs("a",{href:`https://instagram.com/${s.contact?.decision_maker_instagram?.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-[#12122a] rounded-lg border border-gray-800/50 hover:border-red-500/30 transition-all group",children:[e.jsx(lt,{size:20,className:"text-gray-500 group-hover:text-red-400"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-0.5",children:"Decision Maker IG"}),e.jsx("div",{className:"text-sm text-gray-300 group-hover:text-red-400",children:s.contact?.decision_maker_instagram||"‚Äî"})]})]})]}),(s.contact?.decision_maker||x)&&e.jsxs("div",{className:"mt-4 p-3 bg-[#12122a] rounded-lg border border-gray-800/50",children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1",children:"Decision Maker"}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.contact?.avatar&&e.jsx("img",{src:s.contact.avatar,alt:s.contact.decision_maker,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-700"}),e.jsx("div",{className:"text-white font-bold",children:s.contact?.decision_maker||"‚Äî"})]})]})]})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Event Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(we,{size:20,className:"text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1",children:"Frequency"}),e.jsx("div",{className:"text-gray-300",children:s.events?.frequency||"Not specified"})]})]}),s.events?.upcoming?.length>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Kt,{size:20,className:"text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1",children:"Upcoming Events"}),e.jsx("div",{className:"text-gray-300 space-y-1",children:s.events.upcoming.map(($,I)=>e.jsx("div",{children:$},I))})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(rt,{size:20,className:"text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1",children:"Typical Venue"}),e.jsx("div",{className:"text-gray-300",children:s.events?.typical_venue||"Not specified"})]})]})]})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Media & Revenue Assessment"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-2",children:"Media Quality"}),e.jsx("div",{className:"text-gray-300 text-sm",children:s.media_quality||"Not assessed"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Se,{size:20,className:"text-green-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-bold text-gray-600 uppercase mb-1",children:"Revenue Potential"}),e.jsx("div",{className:"text-green-400 font-bold",children:s.revenue_potential||"TBD"})]})]})]})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Internal Notes"}),x?e.jsx("textarea",{value:c.notes||"",onChange:$=>w({...c,notes:$.target.value}),rows:4,className:"w-full px-4 py-3 bg-[#12122a] border border-gray-800/50 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500/40"}):e.jsx("div",{className:"text-gray-300 text-sm whitespace-pre-wrap",children:s.notes||"No notes"})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Activity Timeline"}),e.jsxs("button",{onClick:()=>E(!v),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2 text-sm",children:[e.jsx(_e,{size:16})," Add Activity"]})]}),v&&e.jsx("div",{className:"mb-6 p-4 bg-[#12122a] rounded-lg border border-gray-800/50",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Activity Type"}),e.jsx("select",{value:A,onChange:$=>D($.target.value),className:"w-full px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40",children:mt.map($=>e.jsxs("option",{value:$.value,children:[$.icon," ",$.value]},$.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Notes"}),e.jsx("textarea",{value:o,onChange:$=>N($.target.value),rows:3,placeholder:"What happened?",className:"w-full px-4 py-3 bg-[#1a1a2e] border border-gray-800/50 rounded-xl text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500/40"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:O,className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-all",children:"Add Activity"}),e.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg font-medium transition-all",children:"Cancel"})]})]})}),l.length===0?e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No activities yet. Add your first activity above."}):e.jsx("div",{className:"space-y-3",children:l.map($=>{const I=mt.find(Q=>Q.value===$.type),H=k===$.id;return e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-[#12122a] rounded-lg border border-gray-800/50",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-600/20 rounded-full flex items-center justify-center text-xl",children:I?.icon||"üìù"}),e.jsx("div",{className:"flex-1 min-w-0",children:H?e.jsxs("div",{className:"space-y-3",children:[e.jsx("select",{value:F,onChange:Q=>C(Q.target.value),className:"w-full px-3 py-2 bg-[#1a1a2e] border border-gray-700 rounded-lg text-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40",children:mt.map(Q=>e.jsxs("option",{value:Q.value,children:[Q.icon," ",Q.value]},Q.value))}),e.jsx("textarea",{value:_,onChange:Q=>T(Q.target.value),rows:3,className:"w-full px-3 py-2 bg-[#1a1a2e] border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-red-500/40"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:B,className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm",children:"Save"}),e.jsx("button",{onClick:()=>u(null),className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-sm",children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:$.type}),e.jsx("span",{className:"text-gray-700",children:"‚Ä¢"}),e.jsx("span",{className:"text-xs text-gray-600",children:new Date($.created_at).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>Y($),className:"p-1 text-gray-500 hover:text-blue-400 transition-colors",title:"Edit",children:e.jsx(ut,{size:14})}),e.jsx("button",{onClick:()=>X($.id),className:"p-1 text-gray-500 hover:text-red-400 transition-colors",title:"Delete",children:e.jsx(Dt,{size:14})})]})]}),e.jsx("p",{className:"text-sm text-gray-300",children:$.notes})]})})]},$.id)})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>P("Phone Call"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[e.jsx(et,{size:18})," Log Call"]}),e.jsxs("button",{onClick:()=>a("/portal/outreach"),className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[e.jsx(Ce,{size:18})," Send Email"]}),e.jsxs("button",{onClick:()=>P("Meeting"),className:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[e.jsx(we,{size:18})," Schedule Meeting"]}),e.jsxs("button",{onClick:()=>E(!0),className:"w-full bg-gray-700 hover:bg-gray-600 text-white px-4 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2",children:[e.jsx(_e,{size:18})," Add Note"]})]})]}),x&&e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Change Stage"}),e.jsx("select",{value:c.stage,onChange:$=>w({...c,stage:$.target.value}),className:"w-full px-4 py-3 bg-[#12122a] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40",children:xt.map($=>e.jsx("option",{value:$.value,children:$.label},$.value))})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Xt,{size:18})," Tags"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags?.map(($,I)=>e.jsx("span",{className:"px-3 py-1 bg-gray-700 text-gray-300 rounded-full text-xs font-medium",children:$},I))})]})]})]})})]})}const ll=Object.freeze(Object.defineProperty({__proto__:null,default:Qa},Symbol.toStringTag,{value:"Module"}));function Xa(){const[t]=r.useState(Ia()),[a,s]=r.useState(t[0]),[i,l]=r.useState(null),[y,x]=r.useState([]),[j,c]=r.useState(null),[w,z]=r.useState(!1),[p,d]=r.useState(!0),f=r.useRef(null);r.useEffect(()=>{(async()=>{d(!0);const D=await Xe();x(D),d(!1)})()},[]),r.useEffect(()=>{if(a&&i){const A=Ba(a.id,i);c(A)}else c(null)},[a,i]);const v=async()=>{const A=j?`Subject: ${j.subject}

${j.body}`:"";if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(A),z(!0),setTimeout(()=>z(!1),2e3);return}catch{console.log("Clipboard API failed, falling back to textarea method")}if(f.current){f.current.value=A,f.current.style.display="block",f.current.select(),f.current.setSelectionRange(0,99999);try{document.execCommand("copy"),z(!0),setTimeout(()=>z(!1),2e3)}catch{alert("Copy failed. Please select and copy manually.")}f.current.style.display="none"}},E=()=>{if(!j||!i?.contact?.email){alert("No email address available for this lead");return}const A=encodeURIComponent(j.subject),D=encodeURIComponent(j.body),o=`mailto:${i.contact.email}?subject=${A}&body=${D}`;window.location.href=o};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("textarea",{ref:f,style:{position:"absolute",left:"-9999px",display:"none"},readOnly:!0}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-black text-white tracking-tight mb-2",children:[e.jsx("span",{className:"text-red-500",children:"OUTREACH"})," TEMPLATES"]}),e.jsx("p",{className:"text-gray-400",children:"Pre-built email templates for sales outreach"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Templates"}),e.jsx("div",{className:"space-y-2",children:t.map(A=>e.jsx("button",{onClick:()=>s(A),className:`w-full text-left px-4 py-3 rounded-lg font-medium transition-all ${a?.id===A.id?"bg-red-600 text-white":"bg-[#12122a] text-gray-300 hover:bg-[#16162e]"}`,children:A.name},A.id))})]}),e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Select Lead"}),e.jsxs("select",{value:i?.id||"",onChange:A=>{const D=y.find(o=>o.id===A.target.value);l(D)},className:"w-full px-4 py-3 bg-[#12122a] border border-gray-800/50 rounded-xl text-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500/40",children:[e.jsx("option",{value:"",children:"-- Select a lead --"}),y.filter(A=>A.stage!=="lost"&&A.verification_status!=="do_not_contact").map(A=>e.jsx("option",{value:A.id,children:A.org_name},A.id))]}),i&&e.jsxs("div",{className:"mt-4 p-3 bg-[#12122a] rounded-lg border border-gray-800/50",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Selected Lead"}),e.jsx("div",{className:"text-white font-bold mb-1",children:i.org_name}),e.jsx("div",{className:"text-sm text-gray-400",children:i.sport}),e.jsx("div",{className:"text-sm text-gray-400",children:i.location}),i.contact.email&&e.jsxs("div",{className:"text-sm text-green-400 mt-2 flex items-center gap-1",children:[e.jsx(Ce,{size:14})," ",i.contact.email]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Preview"}),j&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:v,className:`${w?"bg-green-600":"bg-gray-700 hover:bg-gray-600"} text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2`,children:w?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{size:16})," Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{size:16})," Copy to Clipboard"]})}),e.jsxs("button",{onClick:E,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2",children:[e.jsx(Ce,{size:16})," Open in Email"]})]})]}),j?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Subject Line"}),e.jsx("div",{className:"px-4 py-3 bg-[#12122a] border border-gray-800/50 rounded-xl text-white font-medium",children:j.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Email Body"}),e.jsx("div",{className:"px-4 py-4 bg-[#12122a] border border-gray-800/50 rounded-xl text-gray-300 whitespace-pre-wrap font-mono text-sm leading-relaxed min-h-[400px]",children:j.body})]}),e.jsxs("div",{className:"p-4 bg-blue-600/10 border border-blue-500/20 rounded-lg",children:[e.jsx("div",{className:"text-xs font-bold text-blue-400 uppercase mb-2",children:"Available Variables"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-blue-300",children:[e.jsx("div",{children:e.jsx("code",{className:"bg-blue-900/30 px-2 py-1 rounded",children:"{{org_name}}"})}),e.jsx("div",{children:e.jsx("code",{className:"bg-blue-900/30 px-2 py-1 rounded",children:"{{decision_maker}}"})}),e.jsx("div",{children:e.jsx("code",{className:"bg-blue-900/30 px-2 py-1 rounded",children:"{{sport}}"})}),e.jsx("div",{children:e.jsx("code",{className:"bg-blue-900/30 px-2 py-1 rounded",children:"{{upcoming_event}}"})})]})]})]}):e.jsxs("div",{className:"text-center text-gray-500 py-12",children:[e.jsx(Ce,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Select a template and lead to preview"})]})]}),e.jsxs("div",{className:"mt-4 p-4 bg-green-600/10 border border-green-500/20 rounded-lg",children:[e.jsx("div",{className:"text-xs font-bold text-green-400 uppercase mb-1",children:"‚úì Templates Ready"}),e.jsx("div",{className:"text-sm text-green-300",children:"All email templates are pre-configured with FFM branding. Select a lead and template to preview, then copy or open in your email client."})]})]})]}),e.jsxs("div",{className:"mt-8 bg-[#1a1a2e] rounded-xl p-6 border border-gray-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Outreach Strategy Guide"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-red-400 mb-2",children:"Cold Outreach (First Contact)"}),e.jsxs("ul",{className:"space-y-1 text-gray-400",children:[e.jsx("li",{children:"‚Ä¢ Keep it short and personal"}),e.jsx("li",{children:"‚Ä¢ Lead with value, not features"}),e.jsx("li",{children:"‚Ä¢ Mention specific details about their organization"}),e.jsx("li",{children:"‚Ä¢ End with a clear, low-pressure CTA"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-red-400 mb-2",children:"Follow-up #1 (3-5 days later)"}),e.jsxs("ul",{className:"space-y-1 text-gray-400",children:[e.jsx("li",{children:"‚Ä¢ Acknowledge they're busy"}),e.jsx("li",{children:"‚Ä¢ Share a relevant work example"}),e.jsx("li",{children:"‚Ä¢ Reiterate availability"}),e.jsx("li",{children:"‚Ä¢ Keep it brief"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-red-400 mb-2",children:"Meeting Request (After engagement)"}),e.jsxs("ul",{className:"space-y-1 text-gray-400",children:[e.jsx("li",{children:"‚Ä¢ Be specific about what you'll cover"}),e.jsx("li",{children:"‚Ä¢ Show you've researched them"}),e.jsx("li",{children:"‚Ä¢ Offer flexible scheduling"}),e.jsx("li",{children:"‚Ä¢ Include calendar link if available"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-red-400 mb-2",children:"Post-Meeting (Same day)"}),e.jsxs("ul",{className:"space-y-1 text-gray-400",children:[e.jsx("li",{children:"‚Ä¢ Send within 2 hours of meeting"}),e.jsx("li",{children:"‚Ä¢ Recap what was discussed"}),e.jsx("li",{children:"‚Ä¢ Outline next steps clearly"}),e.jsx("li",{children:"‚Ä¢ Attach proposal or contract"})]})]})]})]})]})}const nl=Object.freeze(Object.defineProperty({__proto__:null,default:Xa},Symbol.toStringTag,{value:"Module"})),gt=[{id:"branding",category:"Branding & Assets",icon:"‚ú®",items:[{id:"logo",label:"High-resolution logo",type:"file",priority:"essential"},{id:"brand_kit",label:"Brand kit (colors, fonts, guidelines)",type:"file",priority:"important"},{id:"event_graphics",label:"Event-specific graphics/banners",type:"file",priority:"important"},{id:"sponsor_logos",label:"Sponsor logos for on-screen display",type:"file",priority:"nice"}]},{id:"athletes",category:"Athlete Information",icon:"üë•",items:[{id:"registration_list",label:"Registration list (Name, Email, Phone, Instagram)",type:"file",priority:"essential"},{id:"notable_athletes",label:"Notable athletes to feature",type:"textarea",priority:"important"}]},{id:"venue",category:"Venue & Technical",icon:"üìç",items:[{id:"floor_plan",label:"Venue floor plan (mat layout)",type:"file",priority:"essential"},{id:"internet_specs",label:"Internet specs (upload speed, hardwired access)",type:"textarea",priority:"essential"},{id:"power_locations",label:"Power outlet locations",type:"textarea",priority:"important"},{id:"load_in_time",label:"Load-in/crew access time",type:"text",priority:"important"},{id:"venue_contact",label:"Venue contact for event day",type:"contact",priority:"important"}]},{id:"event",category:"Event Operations",icon:"üìÖ",items:[{id:"mat_count",label:"Number of mats running",type:"number",priority:"essential"},{id:"schedule",label:"Event schedule/run sheet",type:"file",priority:"essential"},{id:"bracket_system",label:"Bracket/scoring system used",type:"text",priority:"important"},{id:"match_comms_method",label:"How match order will be communicated",type:"textarea",priority:"important"}]},{id:"social",category:"Social & Promotion",icon:"üì∏",items:[{id:"org_instagram",label:"Organization Instagram",type:"text",priority:"important"},{id:"org_facebook",label:"Organization Facebook",type:"text",priority:"nice"},{id:"org_website",label:"Organization Website",type:"text",priority:"nice"},{id:"existing_content",label:"Existing footage/photos for promos",type:"file",priority:"nice"},{id:"existing_content_links",label:"Links to existing footage (Google Drive, Dropbox, etc.)",type:"textarea",priority:"nice"}]}];function Ja({session:t,onClose:a,onSave:s}){const[i,l]=r.useState("checklist"),[y,x]=r.useState(!1),[j,c]=r.useState({}),[w,z]=r.useState({}),[p,d]=r.useState({}),[f,v]=r.useState({});r.useEffect(()=>{if(!t)return;const C={};gt.forEach(_=>{C[_.id]={},_.items.forEach(T=>{const g=t.checklist_config?.[_.id]?.[T.id]||{};C[_.id][T.id]={enabled:g.enabled!==!1,priority:g.priority||T.priority,alreadyHave:g.alreadyHave||!1}})}),c(C),z(t.collected_data||{}),d(t.admin_item_notes||{}),v(t.manual_completions||{})},[t]);const E=(C,_)=>{c(T=>({...T,[C]:{...T[C],[_]:{...T[C][_],enabled:!T[C][_].enabled}}}))},A=(C,_)=>{c(T=>({...T,[C]:{...T[C],[_]:{...T[C][_],alreadyHave:!T[C][_].alreadyHave}}}))},D=(C,_,T)=>{c(g=>({...g,[C]:{...g[C],[_]:{...g[C][_],priority:T}}}))},o=(C,_,T)=>{d(g=>({...g,[`${C}.${_}`]:T}))},N=(C,_)=>{const T=`${C}.${_}`;v(g=>({...g,[T]:!g[T]}))},k=(C,_,T)=>{z(g=>({...g,[C]:{...g[C]||{},[_]:T}}))},u=async()=>{x(!0);try{const C={checklist_config:j,collected_data:w,admin_item_notes:p,manual_completions:f};await Ws(t.id,C),s&&s(C),a()}catch(C){console.error("Error saving:",C),alert("Failed to save changes: "+C.message)}finally{x(!1)}},F=(C,_)=>{const T=w[C]||{},g=T[_]||T[`${_}_url`],L=f[`${C}.${_}`],O=j[C]?.[_]?.alreadyHave;return L?{status:"manual",label:"Manually Complete",color:"blue"}:g?{status:"complete",label:"Client Provided",color:"green"}:O?{status:"already",label:"Already Have",color:"purple"}:{status:"pending",label:"Pending",color:"gray"}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",onClick:a,children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl w-full max-w-5xl my-8 border border-gray-700 shadow-2xl",onClick:C=>C.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Edit Session"}),e.jsx("p",{className:"text-gray-400",children:t.org_name})]}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-white text-xl",children:"‚úï"})]}),e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("div",{className:"flex gap-1 px-6",children:[{id:"checklist",label:"Checklist Config",icon:"‚öôÔ∏è"},{id:"data",label:"Collected Data",icon:"üìù"}].map(C=>e.jsxs("button",{onClick:()=>l(C.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors border-b-2 ${i===C.id?"border-orange-500 text-white":"border-transparent text-gray-500 hover:text-white"}`,children:[e.jsx("span",{children:C.icon})," ",C.label]},C.id))})}),e.jsxs("div",{className:"p-6 max-h-[600px] overflow-y-auto",children:[i==="checklist"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"üí° What this does:"}),' Configure what items the client sees, set priorities, mark items as "already have", and add internal notes for your team.']})}),gt.map(C=>e.jsxs("div",{className:"bg-gray-900/50 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-700 bg-gray-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:C.icon}),e.jsx("h3",{className:"font-bold text-white",children:C.category})]})}),e.jsx("div",{className:"p-4 space-y-4",children:C.items.map(_=>{const T=j[C.id]?.[_.id]||{},g=F(C.id,_.id),L=p[`${C.id}.${_.id}`]||"";return e.jsx("div",{className:`p-4 rounded-lg border transition-all ${T.enabled?"bg-gray-800/50 border-gray-700":"bg-gray-900/30 border-gray-800 opacity-60"}`,children:e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("button",{onClick:()=>E(C.id,_.id),className:`flex-shrink-0 w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${T.enabled?"bg-orange-500 border-orange-500":"bg-transparent border-gray-600"}`,children:T.enabled&&e.jsx("span",{className:"text-white text-sm",children:"‚úì"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-medium ${T.enabled?"text-white":"text-gray-500"}`,children:_.label}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full bg-${g.color}-500/20 text-${g.color}-400 border border-${g.color}-500/30`,children:g.label})]}),T.enabled&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:T.priority,onChange:O=>D(C.id,_.id,O.target.value),className:"text-xs bg-gray-900 border border-gray-700 rounded px-2 py-1 text-white focus:outline-none focus:border-orange-500",children:[e.jsx("option",{value:"essential",children:"Essential"}),e.jsx("option",{value:"important",children:"Important"}),e.jsx("option",{value:"nice",children:"Nice to have"})]}),e.jsx("button",{onClick:()=>A(C.id,_.id),className:`text-xs px-3 py-1 rounded border transition-colors ${T.alreadyHave?"bg-purple-500/20 text-purple-400 border-purple-500/30":"bg-gray-900 text-gray-400 border-gray-700"}`,children:T.alreadyHave?"‚úì Already Have":'Mark "Already Have"'}),e.jsx("button",{onClick:()=>N(C.id,_.id),className:`text-xs px-3 py-1 rounded border transition-colors ${f[`${C.id}.${_.id}`]?"bg-blue-500/20 text-blue-400 border-blue-500/30":"bg-gray-900 text-gray-400 border-gray-700"}`,children:f[`${C.id}.${_.id}`]?"‚úì Manually Complete":"Mark Complete"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Internal Note (not visible to client)"}),e.jsx("textarea",{value:L,onChange:O=>o(C.id,_.id,O.target.value),placeholder:"e.g., Client sent logo via email - see Drive folder",rows:2,className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500 resize-none"})]})]})]})]})},_.id)})})]},C.id))]}),i==="data"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-yellow-200 text-sm",children:[e.jsx("strong",{children:"‚ö†Ô∏è Caution:"})," You're editing data the client submitted. Only modify if you need to correct errors or add information on their behalf."]})}),gt.map(C=>{const _=w[C.id]||{};return e.jsxs("div",{className:"bg-gray-900/50 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-700 bg-gray-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:C.icon}),e.jsx("h3",{className:"font-bold text-white",children:C.category})]})}),e.jsx("div",{className:"p-4 space-y-4",children:C.items.filter(T=>j[C.id]?.[T.id]?.enabled!==!1).map(T=>{const g=_[T.id]||"",L=_[`${T.id}_url`]||"";return e.jsxs("div",{className:"p-3 rounded-lg bg-gray-800/50 border border-gray-700",children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:T.label}),T.type==="file"&&e.jsxs("div",{children:[e.jsx("input",{type:"text",value:L,onChange:O=>k(C.id,`${T.id}_url`,O.target.value),placeholder:"File URL (if uploaded)",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),L&&e.jsx("a",{href:L,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-orange-500 hover:underline mt-1 inline-block",children:"View uploaded file ‚Üí"})]}),T.type==="text"&&e.jsx("input",{type:"text",value:g,onChange:O=>k(C.id,T.id,O.target.value),placeholder:T.placeholder||"",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),T.type==="number"&&e.jsx("input",{type:"number",value:g,onChange:O=>k(C.id,T.id,O.target.value),placeholder:T.placeholder||"",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),T.type==="textarea"&&e.jsx("textarea",{value:g,onChange:O=>k(C.id,T.id,O.target.value),placeholder:T.placeholder||"",rows:3,className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500 resize-none"}),T.type==="contact"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:_[`${T.id}_name`]||"",onChange:O=>k(C.id,`${T.id}_name`,O.target.value),placeholder:"Contact name",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),e.jsx("input",{type:"tel",value:_[`${T.id}_phone`]||"",onChange:O=>k(C.id,`${T.id}_phone`,O.target.value),placeholder:"Phone number",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"}),e.jsx("input",{type:"email",value:_[`${T.id}_email`]||"",onChange:O=>k(C.id,`${T.id}_email`,O.target.value),placeholder:"Email address",className:"w-full text-sm bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white placeholder-gray-600 focus:outline-none focus:border-orange-500"})]})]},T.id)})})]},C.id)})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-700 flex justify-end gap-3",children:[e.jsx("button",{onClick:a,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:u,disabled:y,className:"px-6 py-2 bg-orange-500 hover:bg-orange-600 disabled:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):e.jsx(e.Fragment,{children:"üíæ Save Changes"})})]})]})}):null}const qt=[{id:"branding",category:"Branding & Assets",icon:"‚ú®",items:[{id:"logo",label:"High-resolution logo",type:"file"},{id:"brand_kit",label:"Brand kit (colors, fonts, guidelines)",type:"file"},{id:"event_graphics",label:"Event-specific graphics/banners",type:"file"},{id:"sponsor_logos",label:"Sponsor logos for on-screen display",type:"file"}]},{id:"athletes",category:"Athlete Information",icon:"üë•",items:[{id:"registration_list",label:"Registration list",type:"file"},{id:"notable_athletes",label:"Notable athletes to feature",type:"textarea"}]},{id:"venue",category:"Venue & Technical",icon:"üìç",items:[{id:"floor_plan",label:"Venue floor plan",type:"file"},{id:"internet_specs",label:"Internet specs",type:"textarea"},{id:"power_locations",label:"Power outlet locations",type:"textarea"},{id:"load_in_time",label:"Load-in/crew access time",type:"text"},{id:"venue_contact",label:"Venue contact for event day",type:"contact"}]},{id:"event",category:"Event Operations",icon:"üìÖ",items:[{id:"mat_count",label:"Number of mats running",type:"number"},{id:"schedule",label:"Event schedule/run sheet",type:"file"},{id:"bracket_system",label:"Bracket/scoring system used",type:"text"},{id:"match_comms_method",label:"How match order will be communicated",type:"textarea"}]},{id:"social",category:"Social & Promotion",icon:"üì∏",items:[{id:"org_instagram",label:"Organization Instagram",type:"text"},{id:"org_facebook",label:"Organization Facebook",type:"text"},{id:"org_website",label:"Organization Website",type:"text"},{id:"existing_content",label:"Existing footage/photos for promos",type:"file"},{id:"existing_content_links",label:"Links to existing footage",type:"textarea"}]}],Za=t=>{if(!t)return{icon:$t,type:"file",isImage:!1};const a=t.toLowerCase();return a.match(/\.(jpg|jpeg|png|gif|webp|svg|bmp)(\?|$)/i)?{icon:nt,type:"image",isImage:!0}:a.match(/\.(mp4|mov|avi|webm|mkv)(\?|$)/i)?{icon:Nt,type:"video",isImage:!1}:a.match(/\.(mp3|wav|aac|ogg|m4a)(\?|$)/i)?{icon:Ns,type:"audio",isImage:!1}:a.match(/\.(pdf|doc|docx|xls|xlsx|ppt|pptx|txt|csv)(\?|$)/i)?{icon:ze,type:"document",isImage:!1}:a.match(/\.(zip|rar|7z|tar|gz)(\?|$)/i)?{icon:Zt,type:"archive",isImage:!1}:{icon:$t,type:"file",isImage:!1}},er=t=>{if(!t)return"File";try{const i=new URL(t).pathname.split("/").pop(),l=decodeURIComponent(i);return l.length>40?l.substring(0,37)+"...":l}catch{return"File"}};function tr({url:t,label:a}){const{icon:s,type:i,isImage:l}=Za(t),y=er(t);return e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"group block",children:e.jsxs("div",{className:"border border-gray-700 rounded-xl overflow-hidden hover:border-orange-500/50 transition-all",children:[e.jsxs("div",{className:"bg-gray-900 aspect-video flex items-center justify-center relative overflow-hidden",children:[l?e.jsx("img",{src:t,alt:a,className:"w-full h-full object-cover group-hover:scale-105 transition-transform",onError:x=>{x.target.style.display="none",x.target.nextSibling.style.display="flex"}}):null,e.jsxs("div",{className:`flex flex-col items-center justify-center text-gray-500 ${l?"hidden":""}`,style:l?{display:"none"}:{},children:[e.jsx(s,{size:48,className:"mb-2"}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:i})]}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:e.jsx("div",{className:"bg-orange-500 text-white p-2 rounded-full",children:e.jsx(Oe,{size:20})})})]}),e.jsxs("div",{className:"p-3 bg-gray-800",children:[e.jsx("p",{className:"text-sm text-white truncate",children:y}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a})]})]})})}function sr({value:t,isUrl:a}){return t?Array.isArray(t)?t.length===0?e.jsx("span",{className:"text-gray-500 italic",children:"No links provided"}):e.jsx("div",{className:"space-y-1",children:t.map((s,i)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 break-all flex items-center gap-1 block",children:["üîó ",s.includes("drive.google")?"Google Drive":s.includes("dropbox")?"Dropbox":"External"," link",e.jsx(Oe,{size:14})]},i))}):a||t.startsWith("http://")||t.startsWith("https://")?e.jsxs("a",{href:t.startsWith("http")?t:`https://${t}`,target:"_blank",rel:"noopener noreferrer",className:"text-orange-500 hover:text-orange-400 break-all flex items-center gap-1",children:[t,e.jsx(Oe,{size:14})]}):t.includes(`
`)?e.jsx("p",{className:"text-white whitespace-pre-wrap",children:t}):e.jsx("span",{className:"text-white",children:t}):e.jsx("span",{className:"text-gray-500 italic",children:"Not provided"})}function ar({data:t,itemId:a}){const s=t[`${a}_name`],i=t[`${a}_phone`],l=t[`${a}_email`];return!s&&!i&&!l?e.jsx("span",{className:"text-gray-500 italic",children:"Not provided"}):e.jsxs("div",{className:"space-y-1",children:[s&&e.jsx("p",{className:"text-white font-medium",children:s}),i&&e.jsxs("a",{href:`tel:${i}`,className:"text-orange-500 hover:text-orange-400 block",children:["üìû ",i]}),l&&e.jsxs("a",{href:`mailto:${l}`,className:"text-orange-500 hover:text-orange-400 block",children:["‚úâÔ∏è ",l]})]})}function rr({data:t,files:a=[],checklistConfig:s}){const[i,l]=r.useState(new Set(qt.map(p=>p.id))),y=s||qt,x=(p,d)=>{const f=y.find(E=>E.id===p);return f&&f.items.find(E=>E.id===d)?.label||null},j={};for(const p of a){if(!p.category)continue;j[p.category]||(j[p.category]=[]);const d=x(p.category,p.file_type);j[p.category].push({id:p.file_type||p.id,label:d||p.file_type||"Uploaded file",url:p.drive_file_url||p.public_url,fileName:p.file_name,mimeType:p.mime_type})}const c=p=>{l(d=>{const f=new Set(d);return f.has(p)?f.delete(p):f.add(p),f})},w=p=>{if(j[p]?.length>0)return!0;const d=t?.[p];return d?Object.values(d).some(f=>f&&f!==""):!1},z=p=>{const d=t?.[p.id]||{},f=j[p.id]||[];let v=0,E=p.items.length;const A=new Set(f.map(D=>D.id));return p.items.forEach(D=>{if(D.type==="file")(A.has(D.id)||d[`${D.id}_url`])&&v++;else if(D.type==="contact")(d[`${D.id}_name`]||d[`${D.id}_phone`]||d[`${D.id}_email`])&&v++;else{const o=d[D.id];o&&o!==""&&v++}}),{completed:v,total:E}};return!t||Object.keys(t).length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No information collected yet"})}):e.jsx("div",{className:"space-y-4",children:y.map(p=>{const d=t[p.id]||{},f=i.has(p.id),v=w(p.id),E=z(p),A=j[p.id]||[],D=new Set(A.map(u=>u.id)),o=p.items.filter(u=>u.type==="file").filter(u=>!D.has(u.id)).map(u=>({...u,url:d[`${u.id}_url`]||d[u.id]})).filter(u=>u.url&&u.url.startsWith("http")),N=[...A,...o],k=p.items.filter(u=>u.type!=="file");return e.jsxs("div",{className:`border rounded-xl overflow-hidden transition-colors ${v?"border-gray-700 bg-gray-800/50":"border-gray-800 bg-gray-900/30"}`,children:[e.jsxs("button",{onClick:()=>c(p.id),className:"w-full flex items-center justify-between p-4 hover:bg-gray-700/30 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:p.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-white",children:p.category}),e.jsxs("p",{className:"text-xs text-gray-500",children:[E.completed,"/",E.total," items provided"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[E.completed===E.total?e.jsx("span",{className:"text-green-400 text-sm",children:"‚úì Complete"}):E.completed>0?e.jsxs("span",{className:"text-yellow-400 text-sm",children:[E.completed,"/",E.total]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"Empty"}),f?e.jsx(Jt,{size:20,className:"text-gray-400"}):e.jsx(jt,{size:20,className:"text-gray-400"})]})]}),f&&e.jsxs("div",{className:"border-t border-gray-700 p-4",children:[N.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:["Files (",N.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:N.map((u,F)=>e.jsx(tr,{url:u.url,label:u.label||u.fileName||"Uploaded file"},u.id||F))})]}),k.length>0&&e.jsxs("div",{className:N.length>0?"mt-4 pt-4 border-t border-gray-700":"",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:"Details"}),e.jsx("div",{className:"space-y-4",children:k.map(u=>{const F=d[u.id],C=u.type==="contact"?d[`${u.id}_name`]||d[`${u.id}_phone`]||d[`${u.id}_email`]:F&&F!=="";return e.jsxs("div",{className:`${C?"":"opacity-50"}`,children:[e.jsx("label",{className:"text-sm text-gray-400 block mb-1",children:u.label}),u.type==="contact"?e.jsx(ar,{data:d,itemId:u.id}):e.jsx(sr,{value:F,isUrl:u.id.includes("website")||u.id.includes("facebook")||u.id.includes("instagram")})]},u.id)})})]}),Object.entries(d).filter(([u,F])=>u.endsWith("_links")&&Array.isArray(F)&&F.length>0).length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:"External Links"}),e.jsx("div",{className:"space-y-4",children:Object.entries(d).filter(([u,F])=>u.endsWith("_links")&&Array.isArray(F)&&F.length>0).map(([u,F])=>{const C=u.replace(/_links$/,""),T=p.items.find(g=>g.id===C)?.label||C.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase());return e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-400 block mb-1",children:[T," (external links)"]}),e.jsx("div",{className:"space-y-1",children:F.map((g,L)=>e.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 break-all flex items-center gap-2 p-2 bg-blue-500/10 rounded-lg text-sm",children:[e.jsx("span",{children:"üîó"}),e.jsxs("span",{className:"flex-1 truncate",children:[g.includes("drive.google")?"Google Drive":g.includes("dropbox")?"Dropbox":"External"," link"]}),e.jsx(Oe,{size:14})]},L))})]},u)})})]}),N.length===0&&k.every(u=>{const F=d[u.id];return u.type==="contact"?!(d[`${u.id}_name`]||d[`${u.id}_phone`]||d[`${u.id}_email`]):!F||F===""})&&e.jsx("p",{className:"text-gray-500 text-center py-4 italic",children:"No information provided for this category"})]})]},p.id)})})}function lr(){const t=ve(),[a,s]=r.useState([]),[i,l]=r.useState([]),[y,x]=r.useState(!0),[j,c]=r.useState(null),[w,z]=r.useState(null),[p,d]=r.useState([]),[f,v]=r.useState("all"),[E,A]=r.useState(""),[D,o]=r.useState(!1),[N,k]=r.useState(!1),[u,F]=r.useState(!1),[C,_]=r.useState(!1),[T,g]=r.useState({org_name:"",contact_name:"",contact_email:"",contact_phone:"",event_name:"",event_date:"",event_location:""});r.useEffect(()=>{L()},[]);const L=async()=>{try{const[R,V]=await Promise.all([Ys(),wt()]);s(R||[]),l(V||[])}catch(R){c(R.message)}finally{x(!1)}},O=async R=>{R.preventDefault(),_(!0);try{const V=await as(T);s(J=>[V,...J]),o(!1),g({org_name:"",contact_name:"",contact_email:"",contact_phone:"",event_name:"",event_date:"",event_location:""})}catch(V){alert("Error: "+V.message)}finally{_(!1)}},Y=async R=>{try{await Ks(R,"Brandon Hibbs"),await L(),z(null)}catch(V){alert("Error: "+V.message)}},B=async R=>{if(confirm("Are you sure you want to delete this onboarding session? This cannot be undone."))try{await Qs(R),s(V=>V.filter(J=>J.id!==R)),z(null)}catch(V){alert("Error deleting session: "+V.message)}},X=R=>{s(V=>V.map(J=>J.id===w.id?{...J,...R}:J)),z(V=>({...V,...R})),F(!1)},P=async R=>{z(R);try{const V=await Xs(R.id);d(V||[])}catch(V){console.error("Error fetching files:",V),d([])}},h=R=>{const V={pending:"bg-yellow-500/20 text-yellow-400",in_progress:"bg-blue-500/20 text-blue-400",submitted:"bg-green-500/20 text-green-400",reviewed:"bg-purple-500/20 text-purple-400"},J={pending:"Pending",in_progress:"In Progress",submitted:"Submitted",reviewed:"Reviewed"};return e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${V[R]||V.pending}`,children:J[R]||"Unknown"})},$=R=>{const V=R.checklist_progress||{},J=18,te=Object.values(V).filter(ae=>ae).length;return Math.round(te/J*100)},I=a.filter(R=>!(f!=="all"&&R.status!==f||E&&!R.org_name?.toLowerCase().includes(E.toLowerCase()))),H=R=>`${window.location.origin}/#/onboarding/${R}`,Q=i.filter(R=>R.status==="signed");return y?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[e.jsx("div",{className:"bg-gray-800 border-b border-gray-700",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/portal/contracts"),className:"text-gray-400 hover:text-white",children:"‚Üê Back"}),e.jsx("h1",{className:"text-xl font-bold",children:"Partner Onboarding"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>k(!0),className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2",children:"üìÑ From Contract"}),e.jsx("button",{onClick:()=>o(!0),className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg text-sm flex items-center gap-2",children:"‚ûï New Session"})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:e.jsx("div",{className:"grid grid-cols-4 gap-4",children:[{label:"Total",value:a.length,color:"orange"},{label:"Pending",value:a.filter(R=>R.status==="pending").length,color:"yellow"},{label:"Submitted",value:a.filter(R=>R.status==="submitted").length,color:"green"},{label:"Reviewed",value:a.filter(R=>R.status==="reviewed").length,color:"purple"}].map((R,V)=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:[e.jsx("div",{className:`text-3xl font-bold text-${R.color}-500`,children:R.value}),e.jsx("div",{className:"text-sm text-gray-500",children:R.label})]},V))})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search organizations...",value:E,onChange:R=>A(R.target.value),className:"flex-1 max-w-xs px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:border-orange-500 focus:outline-none"}),e.jsxs("select",{value:f,onChange:R=>v(R.target.value),className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"reviewed",children:"Reviewed"})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 pb-12",children:I.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-xl p-12 text-center border border-gray-700",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üìã"}),e.jsx("p",{className:"text-gray-400",children:"No onboarding sessions found"}),e.jsx("button",{onClick:()=>o(!0),className:"mt-4 bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg text-sm",children:"Create First Session"})]}):e.jsx("div",{className:"space-y-3",children:I.map(R=>e.jsx("div",{onClick:()=>P(R),className:"bg-gray-800 rounded-xl p-5 border border-gray-700 hover:border-gray-600 cursor-pointer transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:R.org_name}),h(R.status)]}),e.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[R.event_name&&e.jsxs("span",{children:["üìÖ ",R.event_name]}),R.contact_name&&e.jsxs("span",{children:["üë§ ",R.contact_name]}),R.event_date&&e.jsxs("span",{children:["üóì ",new Date(R.event_date).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-500",children:[$(R),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Complete"})]})]})},R.id))})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>z(null),children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-auto border border-gray-700",onClick:R=>R.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:w.org_name}),h(w.status)]}),e.jsx("button",{onClick:()=>z(null),className:"text-gray-500 hover:text-white text-xl",children:"‚úï"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Event Details"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[w.event_name&&e.jsxs("p",{children:[e.jsx("strong",{children:"Event:"})," ",w.event_name]}),w.event_date&&e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(w.event_date).toLocaleDateString()]}),w.event_location&&e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",w.event_location]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Contact"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[w.contact_name&&e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",w.contact_name]}),w.contact_email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",e.jsx("a",{href:`mailto:${w.contact_email}`,className:"text-orange-500",children:w.contact_email})]}),w.contact_phone&&e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",e.jsx("a",{href:`tel:${w.contact_phone}`,className:"text-orange-500",children:w.contact_phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Progress"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500",style:{width:`${$(w)}%`}})}),e.jsxs("span",{className:"font-bold text-orange-500",children:[$(w),"%"]})]})]}),w.collected_data&&Object.keys(w.collected_data).length>0||p.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-3",children:"Collected Information"}),e.jsx(rr,{data:w.collected_data,files:p})]}):null,e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs text-gray-500 uppercase mb-2",children:"Google Drive Status"}),w.drive_folder_id?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-400",children:"‚úì"}),e.jsx("span",{className:"text-sm",children:"Synced to Google Drive"})]}),(w.shared_with||[]).length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Team access:"}),w.shared_with.map((R,V)=>e.jsxs("span",{className:"text-xs text-gray-400",children:[R.email,V<w.shared_with.length-1?", ":""]},V))]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"‚è≥"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Pending sync (runs every 10 min)"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>F(!0),className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm",children:"‚úèÔ∏è Edit Session"}),e.jsx("a",{href:H(w.share_token),target:"_blank",rel:"noopener noreferrer",className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"üîó View Portal"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(H(w.share_token)),alert("Link copied!")},className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"üìã Copy Link"}),w.drive_folder_id&&e.jsx("a",{href:w.drive_folder_url||`https://drive.google.com/drive/folders/${w.drive_folder_id}`,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"üìÅ View Drive Folder"}),w.status==="submitted"&&e.jsx("button",{onClick:()=>Y(w.id),className:"bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg text-sm",children:"‚úì Mark Reviewed"}),e.jsx("button",{onClick:()=>B(w.id),className:"bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-lg text-sm",children:"üóë Delete"})]})]})]})}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>o(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-md w-full border border-gray-700",onClick:R=>R.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsx("h2",{className:"text-lg font-bold",children:"Create Onboarding Session"})}),e.jsxs("form",{onSubmit:O,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization Name *"}),e.jsx("input",{required:!0,value:T.org_name,onChange:R=>g({...T,org_name:R.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Name"}),e.jsx("input",{value:T.contact_name,onChange:R=>g({...T,contact_name:R.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Email"}),e.jsx("input",{type:"email",value:T.contact_email,onChange:R=>g({...T,contact_email:R.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{value:T.event_name,onChange:R=>g({...T,event_name:R.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Date"}),e.jsx("input",{type:"date",value:T.event_date,onChange:R=>g({...T,event_date:R.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{value:T.event_location,onChange:R=>g({...T,event_location:R.target.value}),className:"w-full px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:border-orange-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:C,className:"flex-1 py-2 bg-orange-500 hover:bg-orange-600 rounded-lg disabled:opacity-50",children:C?"Creating...":"Create"})]})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>k(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl max-w-md w-full border border-gray-700",onClick:R=>R.stopPropagation(),children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsx("h2",{className:"text-lg font-bold",children:"Create From Signed Contract"})}),e.jsxs("div",{className:"p-6",children:[Q.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No signed contracts available"}):e.jsx("div",{className:"space-y-2 max-h-80 overflow-auto",children:Q.map(R=>{const V=a.some(J=>J.contract_id===R.id);return e.jsxs("button",{onClick:()=>!V&&t(`/portal/onboarding/new?contractId=${R.id}`),disabled:V,className:`w-full p-4 rounded-xl text-left transition-colors ${V?"bg-gray-700/50 cursor-not-allowed opacity-50":"bg-gray-700 hover:bg-gray-600"}`,children:[e.jsx("div",{className:"font-medium",children:R.org_name}),e.jsx("div",{className:"text-sm text-gray-400",children:R.promoter_name}),V&&e.jsx("div",{className:"text-xs text-orange-500 mt-1",children:"Session already exists"})]},R.id)})}),e.jsx("button",{onClick:()=>k(!1),className:"w-full mt-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Close"})]})]})}),u&&w&&e.jsx(Ja,{session:w,onClose:()=>F(!1),onSave:X})]})}const il=Object.freeze(Object.defineProperty({__proto__:null,default:lr},Symbol.toStringTag,{value:"Module"})),qe=[{id:"branding",category:"Branding & Assets",icon:"‚ú®",items:[{id:"logo",label:"High-resolution logo",type:"file",priority:"essential"},{id:"brand_kit",label:"Brand kit (colors, fonts, guidelines)",type:"file",priority:"important"},{id:"event_graphics",label:"Event-specific graphics/banners",type:"file",priority:"important"},{id:"sponsor_logos",label:"Sponsor logos for on-screen display",type:"file",priority:"nice"}]},{id:"athletes",category:"Athlete Information",icon:"üë•",items:[{id:"registration_list",label:"Registration list (Name, Email, Phone, Instagram)",type:"file",priority:"essential"},{id:"notable_athletes",label:"Notable athletes to feature",type:"textarea",priority:"important"}]},{id:"venue",category:"Venue & Technical",icon:"üìç",items:[{id:"floor_plan",label:"Venue floor plan (mat layout)",type:"file",priority:"essential"},{id:"internet_specs",label:"Internet specs (upload speed, hardwired access)",type:"textarea",priority:"essential"},{id:"power_locations",label:"Power outlet locations",type:"textarea",priority:"important"},{id:"load_in_time",label:"Load-in/crew access time",type:"text",priority:"important"},{id:"venue_contact",label:"Venue contact for event day",type:"contact",priority:"important"}]},{id:"event",category:"Event Operations",icon:"üìÖ",items:[{id:"mat_count",label:"Number of mats running",type:"number",priority:"essential"},{id:"schedule",label:"Event schedule/run sheet",type:"file",priority:"essential"},{id:"bracket_system",label:"Bracket/scoring system used",type:"text",priority:"important"},{id:"match_comms_method",label:"How match order will be communicated",type:"textarea",priority:"important"}]},{id:"social",category:"Social & Promotion",icon:"üì∏",items:[{id:"org_instagram",label:"Organization Instagram",type:"text",priority:"important"},{id:"org_facebook",label:"Organization Facebook",type:"text",priority:"nice"},{id:"org_website",label:"Organization Website",type:"text",priority:"nice"},{id:"existing_content",label:"Existing footage/photos for promos",type:"file",priority:"nice"},{id:"existing_content_links",label:"Links to existing footage (Google Drive, Dropbox, etc.)",type:"textarea",priority:"nice"}]}];function nr(){const t=ve(),[a]=ws(),[s,i]=r.useState(1),[l,y]=r.useState([]),[x,j]=r.useState(null),[c,w]=r.useState(!0),[z,p]=r.useState(!1),[d]=r.useState(()=>a.get("contractId")),[f,v]=r.useState({orgName:"",contactName:"",email:"",phone:"",eventName:"",eventDate:"",eventLocation:"",contractId:"",orgInstagram:"",orgFacebook:"",orgWebsite:""}),[E,A]=r.useState(()=>{const M={};return qe.forEach(G=>{M[G.id]={},G.items.forEach(n=>{M[G.id][n.id]={enabled:!0,priority:n.priority,alreadyHave:!1,prefilledValue:""}})}),M}),[D,o]=r.useState({}),[N,k]=r.useState({}),[u,F]=r.useState(null),[C,_]=r.useState(""),[T,g]=r.useState("text"),[L,O]=r.useState(null);r.useEffect(()=>{Y()},[]),r.useEffect(()=>{d&&l.length>0&&!x&&l.find(G=>G.id===d)&&B(d)},[l,d]);const Y=async()=>{try{const G=(await wt()).filter(n=>n.status==="signed");y(G)}catch(M){console.error("Error loading contracts:",M)}finally{w(!1)}},B=async M=>{if(!M){j(null),$();return}const G=l.find(q=>q.id===M);if(!G)return;j(G);const n=G.contract_data||{};let b=null;try{b=await Js(G.org_name)}catch(q){console.log("No CRM lead found:",q)}const S=b?.contact||{};v({orgName:G.org_name||"",contactName:G.promoter_name||G.contact_name||"",email:G.promoter_email||G.contact_email||"",phone:G.promoter_phone||G.contact_phone||"",eventName:n.event_name||"",eventDate:n.event_date||"",eventLocation:n.event_location||n.venue||"",contractId:G.id,orgInstagram:P(S.instagram||n.org_instagram||""),orgFacebook:h(S.facebook||n.org_facebook||""),orgWebsite:S.website||n.org_website||""}),I("social","org_instagram",P(S.instagram||n.org_instagram||"")),I("social","org_facebook",h(S.facebook||n.org_facebook||"")),I("social","org_website",S.website||n.org_website||"")},X=async M=>{const G=M.target.value;B(G)},P=M=>M?M.startsWith("@")?M:`@${M}`:"",h=M=>M?M.startsWith("http")?M:`https://facebook.com/${M.replace(/^@/,"").replace(/^\//,"")}`:"",$=()=>{v({orgName:"",contactName:"",email:"",phone:"",eventName:"",eventDate:"",eventLocation:"",contractId:"",orgInstagram:"",orgFacebook:"",orgWebsite:""})},I=(M,G,n)=>{A(b=>({...b,[M]:{...b[M],[G]:{...b[M][G],prefilledValue:n}}}))},H=M=>{const{name:G,value:n}=M.target;v(b=>({...b,[G]:n})),D[G]&&o(b=>({...b,[G]:""}))},Q=(M,G)=>{A(n=>({...n,[M]:{...n[M],[G]:{...n[M][G],enabled:!n[M][G].enabled}}}))},R=(M,G)=>{A(n=>({...n,[M]:{...n[M],[G]:{...n[M][G],alreadyHave:!n[M][G].alreadyHave}}}))},V=(M,G,n)=>{A(b=>({...b,[M]:{...b[M],[G]:{...b[M][G],priority:n}}}))},J=M=>{if(!C.trim())return;const G=`custom_${Date.now()}`,n={id:G,label:C.trim(),type:T,priority:"important",isCustom:!0};k(b=>({...b,[M]:[...b[M]||[],n]})),A(b=>({...b,[M]:{...b[M],[G]:{enabled:!0,priority:"important",alreadyHave:!1,prefilledValue:"",isCustom:!0,label:C.trim(),type:T}}})),_(""),g("text"),F(null)},te=(M,G)=>{k(n=>({...n,[M]:(n[M]||[]).filter(b=>b.id!==G)})),A(n=>{const b={...n};return b[M][G]?.isCustom?delete b[M][G]:b[M][G]={...b[M][G],enabled:!1},b})},ae=(M,G,n)=>{n.trim()&&(k(b=>({...b,[M]:(b[M]||[]).map(S=>S.id===G?{...S,label:n.trim()}:S)})),A(b=>({...b,[M]:{...b[M],[G]:{...b[M][G],label:n.trim()}}})),O(null))},ge=M=>{const G=M.items,n=N[M.id]||[];return[...G,...n]},pe=()=>{const M={};return f.orgName.trim()||(M.orgName="Organization name is required"),f.contactName.trim()||(M.contactName="Contact name is required"),f.email.trim()?/\S+@\S+\.\S+/.test(f.email)||(M.email="Email is invalid"):M.email="Email is required",f.eventDate||(M.eventDate="Event date is required"),o(M),Object.keys(M).length===0},de=()=>{s===1?pe()&&i(2):s===2&&i(3)},re=()=>{s>1?i(s-1):t("/portal/onboarding")},fe=async()=>{p(!0);try{const M={};qe.forEach(S=>{S.items.forEach(q=>{const K=E[S.id][q.id];K.enabled&&K.prefilledValue&&(M[S.id]||(M[S.id]={}),M[S.id][q.id]=K.prefilledValue)})});const G={};Object.keys(E).forEach(S=>{G[S]={},Object.keys(E[S]).forEach(q=>{const K=E[S][q];G[S][q]={enabled:K.enabled,priority:K.priority,alreadyHave:K.alreadyHave,...K.isCustom?{isCustom:!0,label:K.label,type:K.type}:{}}})});const n={org_name:f.orgName,contact_name:f.contactName,contact_email:f.email,contact_phone:f.phone,event_name:f.eventName,event_date:f.eventDate,event_location:f.eventLocation,contract_id:f.contractId||null,collected_data:M,checklist_config:G},b=await as(n);t(`/portal/onboarding/${b.id}`)}catch(M){console.error("Error creating onboarding:",M),alert("Failed to create onboarding session: "+M.message)}finally{p(!1)}},ne=(()=>{let M=0,G=0;return qe.forEach(n=>{ge(n).forEach(S=>{G++,E[n.id]?.[S.id]?.enabled&&M++})}),{enabled:M,total:G}})();return c?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#0d0d1a] to-[#1a1a2e] flex items-center justify-center",children:e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full"})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#0d0d1a] to-[#1a1a2e] py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("button",{onClick:re,className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-6",children:[e.jsx(Ie,{size:20}),"Back"]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-center gap-4",children:[{num:1,label:"Contract & Details"},{num:2,label:"Customize Checklist"},{num:3,label:"Preview & Confirm"}].map((M,G)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`flex items-center gap-3 ${s>=M.num?"opacity-100":"opacity-40"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold border-2 ${s>=M.num?"bg-red-500 border-red-500 text-white":"bg-transparent border-gray-600 text-gray-600"}`,children:s>M.num?e.jsx(Ne,{size:20}):M.num}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"text-sm font-medium text-white",children:M.label})})]}),G<2&&e.jsx(Tt,{size:20,className:s>M.num?"text-red-500":"text-gray-600"})]},M.num))})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(ye.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-gray-800/50 rounded-xl p-6",children:[s===1&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center",children:e.jsx(ze,{className:"text-red-500",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white",children:"Contract & Details"}),e.jsx("p",{className:"text-gray-400",children:"Select contract or enter details manually"})]})]}),e.jsxs("div",{className:"space-y-5",children:[l.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-white mb-2",children:[e.jsx(_s,{className:"inline mr-2",size:16}),"Link to Existing Contract (Auto-fill)"]}),e.jsxs("select",{value:x?.id||"",onChange:X,className:"w-full bg-gray-900/50 border border-gray-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-red-500 transition-colors",children:[e.jsx("option",{value:"",children:"Create from scratch"}),e.jsx("optgroup",{label:"Signed Contracts",children:l.map(M=>e.jsxs("option",{value:M.id,children:[M.org_name," - ",M.promoter_name||M.contact_name]},M.id))})]}),x&&e.jsxs("p",{className:"text-sm text-green-400 mt-2 flex items-center gap-2",children:[e.jsx(Ne,{size:16})," Contract data loaded! Review and edit below."]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"orgName",className:"block text-sm font-bold text-white mb-2",children:["Organization Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"orgName",name:"orgName",value:f.orgName,onChange:H,placeholder:"e.g., Eternal MMA",className:`w-full bg-gray-900/50 border rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none transition-colors ${D.orgName?"border-red-500":"border-gray-700 focus:border-red-500"}`}),D.orgName&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.orgName})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"contactName",className:"block text-sm font-bold text-white mb-2",children:["Contact Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"contactName",name:"contactName",value:f.contactName,onChange:H,placeholder:"Primary contact person",className:`w-full bg-gray-900/50 border rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none transition-colors ${D.contactName?"border-red-500":"border-gray-700 focus:border-red-500"}`}),D.contactName&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.contactName})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-bold text-white mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"email",name:"email",value:f.email,onChange:H,placeholder:"contact@org.com",className:`w-full bg-gray-900/50 border rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none transition-colors ${D.email?"border-red-500":"border-gray-700 focus:border-red-500"}`}),D.email&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-bold text-white mb-2",children:"Phone"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:f.phone,onChange:H,placeholder:"0400 000 000",className:"w-full bg-gray-900/50 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"eventName",className:"block text-sm font-bold text-white mb-2",children:"Event Name"}),e.jsx("input",{type:"text",id:"eventName",name:"eventName",value:f.eventName,onChange:H,placeholder:"e.g., Summer Showdown 2026",className:"w-full bg-gray-900/50 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"eventDate",className:"block text-sm font-bold text-white mb-2",children:["Event Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",id:"eventDate",name:"eventDate",value:f.eventDate,onChange:H,className:`w-full bg-gray-900/50 border rounded-lg px-4 py-3 text-white focus:outline-none transition-colors ${D.eventDate?"border-red-500":"border-gray-700 focus:border-red-500"}`}),D.eventDate&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.eventDate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"eventLocation",className:"block text-sm font-bold text-white mb-2",children:"Event Location"}),e.jsx("input",{type:"text",id:"eventLocation",name:"eventLocation",value:f.eventLocation,onChange:H,placeholder:"e.g., Brisbane Convention Centre",className:"w-full bg-gray-900/50 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors"})]})]})]})]}),s===2&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center",children:e.jsx(ks,{className:"text-red-500",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white",children:"Customize Checklist"}),e.jsx("p",{className:"text-gray-400",children:"Toggle items, set priorities, mark what they already have"})]})]}),e.jsx("div",{className:"mb-6 bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-blue-200 text-sm flex items-start gap-2",children:[e.jsx(Ze,{size:18,className:"flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Disabled items won't show to the client."}),` Use "Already Have" to pre-check items they've provided. Change priorities to indicate urgency.`]})]})}),e.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2",children:qe.map(M=>{const G=ge(M),n=G.filter(b=>E[M.id]?.[b.id]?.enabled).length;return e.jsxs("div",{className:"bg-gray-900/50 rounded-lg border border-gray-700",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-700 bg-gray-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:M.icon}),e.jsx("h3",{className:"font-bold text-white",children:M.category}),e.jsxs("span",{className:"text-sm text-gray-400 ml-auto",children:[n,"/",G.length," enabled"]})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[G.map(b=>{const S=E[M.id]?.[b.id]||{enabled:!0,priority:b.priority},q=b.isCustom||S.isCustom,K=S.label||b.label,le=L?.categoryId===M.id&&L?.itemId===b.id;return e.jsx("div",{className:`p-3 rounded-lg border transition-all ${S.enabled?"bg-gray-800/50 border-gray-700":"bg-gray-900/30 border-gray-800 opacity-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>Q(M.id,b.id),className:`flex-shrink-0 w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${S.enabled?"bg-red-500 border-red-500":"bg-transparent border-gray-600"}`,children:S.enabled&&e.jsx(Ne,{size:16,className:"text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[le?e.jsx("div",{className:"flex items-center gap-2 flex-1",children:e.jsx("input",{type:"text",defaultValue:K,autoFocus:!0,onKeyDown:se=>{se.key==="Enter"?ae(M.id,b.id,se.target.value):se.key==="Escape"&&O(null)},onBlur:se=>ae(M.id,b.id,se.target.value),className:"flex-1 bg-gray-900 border border-red-500 rounded px-2 py-1 text-white text-sm focus:outline-none"})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium ${S.enabled?"text-white":"text-gray-500"}`,children:K}),q&&e.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-400 px-2 py-0.5 rounded border border-purple-500/30",children:"Custom"}),q&&S.enabled&&e.jsx("button",{onClick:()=>O({categoryId:M.id,itemId:b.id,label:K}),className:"text-gray-500 hover:text-white transition-colors",children:e.jsx(Cs,{size:14})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[S.prefilledValue&&e.jsx("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded-full border border-green-500/30",children:"Pre-filled ‚úì"}),e.jsx("button",{onClick:()=>te(M.id,b.id),className:"text-gray-500 hover:text-red-400 transition-colors",title:q?"Remove field":"Disable field",children:e.jsx(ke,{size:16})})]})]}),S.enabled&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("select",{value:S.priority||"important",onChange:se=>V(M.id,b.id,se.target.value),className:"text-xs bg-gray-900 border border-gray-700 rounded px-2 py-1 text-white focus:outline-none focus:border-red-500",children:[e.jsx("option",{value:"essential",children:"Essential"}),e.jsx("option",{value:"important",children:"Important"}),e.jsx("option",{value:"nice",children:"Nice to have"})]}),e.jsx("button",{onClick:()=>R(M.id,b.id),className:`text-xs px-3 py-1 rounded border transition-colors ${S.alreadyHave?"bg-green-500/20 text-green-400 border-green-500/30":"bg-gray-900 text-gray-400 border-gray-700"}`,children:S.alreadyHave?"‚úì Already Have":'Mark as "Already Have"'}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",b.type||S.type||"text",")"]})]})]})]})},b.id)}),u===M.id?e.jsxs("div",{className:"p-3 rounded-lg border border-dashed border-green-500/50 bg-green-500/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"text",value:C,onChange:b=>_(b.target.value),placeholder:"Field label...",autoFocus:!0,onKeyDown:b=>{b.key==="Enter"&&J(M.id),b.key==="Escape"&&F(null)},className:"flex-1 bg-gray-900 border border-gray-700 rounded px-3 py-2 text-white text-sm placeholder-gray-500 focus:outline-none focus:border-green-500"}),e.jsxs("select",{value:T,onChange:b=>g(b.target.value),className:"bg-gray-900 border border-gray-700 rounded px-2 py-2 text-white text-sm focus:outline-none focus:border-green-500",children:[e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"textarea",children:"Long Text"}),e.jsx("option",{value:"file",children:"File Upload"}),e.jsx("option",{value:"number",children:"Number"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>J(M.id),disabled:!C.trim(),className:"flex-1 bg-green-600 hover:bg-green-500 disabled:bg-gray-700 text-white text-sm font-medium py-2 rounded transition-colors",children:"Add Field"}),e.jsx("button",{onClick:()=>{F(null),_(""),g("text")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition-colors",children:"Cancel"})]})]}):e.jsxs("button",{onClick:()=>F(M.id),className:"w-full p-3 rounded-lg border border-dashed border-gray-700 hover:border-green-500/50 hover:bg-green-500/5 text-gray-500 hover:text-green-400 transition-all flex items-center justify-center gap-2",children:[e.jsx(Ss,{size:18}),"Add Custom Field"]})]})]},M.id)})})]}),s===3&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center",children:e.jsx(Re,{className:"text-red-500",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white",children:"Review & Confirm"}),e.jsx("p",{className:"text-gray-400",children:"Everything looks good? Create the onboarding session!"})]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Organization Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Organization:"}),e.jsx("div",{className:"text-white font-medium",children:f.orgName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Contact:"}),e.jsx("div",{className:"text-white font-medium",children:f.contactName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"}),e.jsx("div",{className:"text-white font-medium",children:f.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"}),e.jsx("div",{className:"text-white font-medium",children:f.phone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Event:"}),e.jsx("div",{className:"text-white font-medium",children:f.eventName||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("div",{className:"text-white font-medium",children:f.eventDate})]})]})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4 border border-gray-700",children:[e.jsx("h3",{className:"font-bold text-white mb-3",children:"Checklist Configuration"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:ne.enabled}),e.jsx("div",{className:"text-xs text-gray-500",children:"Enabled Items"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-500",children:ne.total-ne.enabled}),e.jsx("div",{className:"text-xs text-gray-500",children:"Disabled Items"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:Object.keys(E).reduce((M,G)=>M+Object.keys(E[G]).filter(n=>E[G][n].prefilledValue).length,0)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Pre-filled"})]})]})]})]}),ne.enabled<ne.total/2&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-yellow-200 text-sm flex items-start gap-2",children:[e.jsx(Ze,{size:18,className:"flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"You've disabled more than half the checklist items. Make sure this is intentional ‚Äî clients need these details for quality coverage."})]})})]})]},s),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:re,className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-all font-medium border border-gray-700",children:s===1?"Cancel":"Back"}),s<3?e.jsxs("button",{onClick:de,className:"flex-1 px-6 py-3 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 text-white font-bold rounded-lg transition-all shadow-lg shadow-red-500/20 flex items-center justify-center gap-2",children:["Next Step",e.jsx(Tt,{size:20})]}):e.jsx("button",{onClick:fe,disabled:z,className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 disabled:from-gray-600 disabled:to-gray-500 text-white font-bold rounded-lg transition-all shadow-lg shadow-green-500/20 flex items-center justify-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{size:20}),"Create Onboarding Session"]})})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"sticky top-6",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-gray-800/50 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Re,{size:20,className:"text-red-500"}),e.jsx("h3",{className:"font-bold text-white",children:"Client Preview"})]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-4",children:["This is what ",f.orgName||"the client"," will see"]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg border border-gray-800 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-800 px-3 py-2 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-lg"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-white",children:"Fit Focus Media"}),e.jsx("div",{className:"text-[10px] text-gray-500",children:f.orgName||"Organization"})]})]})}),e.jsxs("div",{className:"p-4 space-y-3 max-h-[500px] overflow-y-auto",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"text-gray-500 text-xs mb-2",children:"Event Details"}),e.jsx("div",{className:"text-white font-medium",children:f.eventName||"Event Name"}),e.jsx("div",{className:"text-gray-400 text-xs",children:f.eventDate||"Date not set"})]}),e.jsxs("div",{className:"border-t border-gray-800 pt-3",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Checklist (",ne.enabled," items)"]}),qe.map(M=>{const n=ge(M).filter(b=>E[M.id]?.[b.id]?.enabled);return n.length===0?null:e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-xs font-medium text-white flex items-center gap-2 mb-1",children:[e.jsx("span",{children:M.icon}),M.category]}),e.jsx("div",{className:"space-y-1",children:n.map(b=>{const S=E[M.id]?.[b.id]||{},q=S.label||b.label;return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:`w-3 h-3 rounded border ${S.alreadyHave?"bg-green-500 border-green-500":"border-gray-600"}`,children:S.alreadyHave&&e.jsx(Ne,{size:10,className:"text-white"})}),e.jsxs("span",{className:`flex-1 ${S.alreadyHave?"text-gray-500 line-through":"text-gray-400"}`,children:[q,(b.isCustom||S.isCustom)&&e.jsx("span",{className:"text-purple-400 ml-1",children:"*"})]}),S.prefilledValue&&e.jsx("span",{className:"text-green-400",children:"‚úì"})]},b.id)})})]},M.id)})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded p-2 text-center border border-gray-800",children:[e.jsx("div",{className:"text-lg font-bold text-red-500",children:ne.enabled}),e.jsx("div",{className:"text-gray-500",children:"Items to collect"})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded p-2 text-center border border-gray-800",children:[e.jsx("div",{className:"text-lg font-bold text-green-500",children:Object.keys(E).reduce((M,G)=>M+Object.keys(E[G]).filter(n=>E[G][n].prefilledValue||E[G][n].alreadyHave).length,0)}),e.jsx("div",{className:"text-gray-500",children:"Pre-filled/Have"})]})]})]})})})]})]})})}const ol=Object.freeze(Object.defineProperty({__proto__:null,default:nr},Symbol.toStringTag,{value:"Module"})),St="ffm_onboarding_workflows";function ir(t,a){if(t.completed)return"complete";if(t.inProgress)return"in-progress";const s=new Date;s.setHours(0,0,0,0);const i=new Date(a);return i.setHours(0,0,0,0),i<s?"overdue":"pending"}function Et(){const t=localStorage.getItem(St);return t?JSON.parse(t):[]}function gs(t){return Et().find(s=>s.id===t)}function ht(t,a,s){const i=Et(),l=i.find(x=>x.id===t);return l?(l.steps[a]={...l.steps[a],...s},s.completed&&!l.steps[a].completedDate&&(l.steps[a].completedDate=new Date().toISOString().split("T")[0]),l.steps.every(x=>x.completed)&&l.status==="active"&&(l.status="completed"),localStorage.setItem(St,JSON.stringify(i)),l):null}function or(t){const s=Et().filter(i=>i.id!==t);return localStorage.setItem(St,JSON.stringify(s)),!0}function dr(t){const a=gs(t);return a?`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Onboarding Checklist - ${a.orgName}</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
    h1 { color: #e51d1d; }
    .header { border-bottom: 2px solid #e51d1d; padding-bottom: 20px; margin-bottom: 30px; }
    .info { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 30px; }
    .phase { margin-bottom: 40px; }
    .phase-title { background: #f5f5f5; padding: 10px; font-weight: bold; margin-bottom: 15px; }
    .step { margin-bottom: 25px; padding-left: 30px; position: relative; }
    .step-number { position: absolute; left: 0; font-weight: bold; }
    .checkbox { display: inline-block; width: 18px; height: 18px; border: 2px solid #333; margin-right: 10px; }
    .subtasks { margin-top: 10px; padding-left: 20px; font-size: 0.9em; color: #666; }
    .subtasks li { margin-bottom: 5px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>Client Onboarding Checklist</h1>
    <div class="info">
      <div><strong>Organization:</strong> ${a.orgName}</div>
      <div><strong>Contact:</strong> ${a.contactName}</div>
      <div><strong>Email:</strong> ${a.email}</div>
      <div><strong>Phone:</strong> ${a.phone}</div>
      <div><strong>Sport:</strong> ${a.sport}</div>
      <div><strong>First Event:</strong> ${a.firstEventDate}</div>
      <div><strong>Signing Date:</strong> ${a.signingDate}</div>
      <div><strong>Generated:</strong> ${new Date().toLocaleDateString()}</div>
    </div>
  </div>
  
  ${[1,2,3].map(i=>`
    <div class="phase">
      <div class="phase-title">
        ${i===1?"Phase 1: Welcome & Setup":i===2?"Phase 2: Pre-Event Prep":"Phase 3: Go-Live"}
      </div>
      ${a.steps.filter(l=>l.phase===i).map(l=>`
        <div class="step">
          <span class="step-number">${l.id}.</span>
          <div>
            <div><span class="checkbox">‚òê</span><strong>${l.title}</strong> (Due: ${l.dueDate})</div>
            <div style="color: #666; margin-top: 5px;">${l.description}</div>
            ${l.subTasks&&l.subTasks.length>0?`
              <ul class="subtasks">
                ${l.subTasks.map(y=>`<li>${y}</li>`).join("")}
              </ul>
            `:""}
          </div>
        </div>
      `).join("")}
    </div>
  `).join("")}
</body>
</html>
  `:null}function cr(){const{id:t}=Qe(),a=ve(),[s,i]=r.useState(null),[l,y]=r.useState(null),[x,j]=r.useState(!1);r.useEffect(()=>{c()},[t]);const c=()=>{const C=gs(t);C?i(C):a("/portal/onboarding")},w=C=>{const _=s.steps[C],T=ht(t,C,{completed:!_.completed,completedDate:_.completed?null:new Date().toISOString().split("T")[0]});i(T)},z=C=>{const _=s.steps[C],T=ht(t,C,{inProgress:!_.inProgress});i(T)},p=(C,_)=>{const T=ht(t,C,{notes:_});i(T)},d=()=>{or(t),a("/portal/onboarding")},f=()=>{const C=dr(t),_=new Blob([C],{type:"text/html"}),T=URL.createObjectURL(_),g=document.createElement("a");g.href=T,g.download=`onboarding-${s.orgName.replace(/\s+/g,"-")}.html`,g.click(),URL.revokeObjectURL(T)},v=()=>{const C=s.steps.findIndex(_=>!_.completed);C!==-1&&(y(C),document.getElementById(`step-${C}`)?.scrollIntoView({behavior:"smooth",block:"center"}))};if(!s)return null;const E=s.steps.filter(C=>C.completed).length,A=s.steps.length,D=Math.round(E/A*100),o=C=>s.steps.filter(_=>_.phase===C),N=C=>{const _=o(C),T=_.filter(g=>g.completed).length;return{completed:T,total:_.length,percentage:Math.round(T/_.length*100)}},k={1:"Welcome & Setup",2:"Pre-Event Prep",3:"Go-Live"},u=C=>{switch(C){case"complete":return"text-green-400 bg-green-600/20 border-green-500/30";case"overdue":return"text-red-400 bg-red-600/20 border-red-500/30";case"in-progress":return"text-yellow-400 bg-yellow-600/20 border-yellow-500/30";default:return"text-gray-400 bg-gray-800/30 border-gray-700/30"}},F=C=>{switch(C){case"complete":return e.jsx(Ge,{size:18,className:"text-green-400"});case"overdue":return e.jsx(Ze,{size:18,className:"text-red-400"});case"in-progress":return e.jsx(He,{size:18,className:"text-yellow-400"});default:return e.jsx(At,{size:18,className:"text-gray-400"})}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0d0d1a] to-[#1a1a2e]",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#1a1a2e] to-[#16162a] border-b border-gray-800/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("button",{onClick:()=>a("/portal/onboarding"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-4",children:[e.jsx(Ie,{size:20}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-white mb-2",children:s.orgName}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(lt,{size:16}),s.contactName]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ce,{size:16}),s.email]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(et,{size:16}),s.phone]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(we,{size:16}),"Event: ",new Date(s.firstEventDate).toLocaleDateString("en-AU")]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(ye.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:v,disabled:E===A,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 text-white font-medium rounded-lg transition-all flex items-center gap-2",children:[e.jsx(He,{size:18}),"Next Step"]}),e.jsxs(ye.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:f,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg transition-all flex items-center gap-2",children:[e.jsx(Ye,{size:18}),"Export"]}),e.jsxs(ye.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>j(!0),className:"px-4 py-2 bg-red-600/20 hover:bg-red-600/30 text-red-400 font-medium rounded-lg transition-all flex items-center gap-2 border border-red-500/30",children:[e.jsx(ke,{size:18}),"Delete"]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-400",children:["Overall Progress: ",E,"/",A," steps"]}),e.jsxs("span",{className:"text-lg font-bold text-white",children:[D,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-800 rounded-full h-3 overflow-hidden",children:e.jsx(ye.div,{initial:{width:0},animate:{width:`${D}%`},transition:{duration:.5},className:`h-full rounded-full ${D===100?"bg-gradient-to-r from-green-600 to-green-500":"bg-gradient-to-r from-red-600 to-red-500"}`})})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-gray-800/50 rounded-xl p-6 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Client Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Organization"}),e.jsx("span",{className:"text-white font-medium",children:s.orgName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Contact"}),e.jsx("span",{className:"text-white font-medium",children:s.contactName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Email"}),e.jsx("span",{className:"text-white font-medium break-all",children:s.email})]}),s.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Phone"}),e.jsx("span",{className:"text-white font-medium",children:s.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Sport"}),e.jsx("span",{className:"text-white font-medium",children:s.sport})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"First Event Date"}),e.jsx("span",{className:"text-white font-medium",children:new Date(s.firstEventDate).toLocaleDateString("en-AU",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Signing Date"}),e.jsx("span",{className:"text-white font-medium",children:new Date(s.signingDate).toLocaleDateString("en-AU")})]}),s.contractId&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Contract ID"}),e.jsx("span",{className:"text-white font-medium font-mono text-xs",children:s.contractId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Status"}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold ${s.status==="completed"?"bg-green-600/20 text-green-400 border border-green-500/30":"bg-blue-600/20 text-blue-400 border border-blue-500/30"}`,children:s.status==="completed"?"Completed":"Active"})]})]})]})}),e.jsx("div",{className:"lg:col-span-2 space-y-6",children:[1,2,3].map(C=>{const _=N(C),T=o(C);return e.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-gray-800/50 rounded-xl p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:["Phase ",C,": ",k[C]]}),e.jsxs("span",{className:"text-sm font-bold text-gray-400",children:[_.completed,"/",_.total]})]}),e.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${_.percentage===100?"bg-green-600":"bg-red-600"}`,style:{width:`${_.percentage}%`}})})]}),e.jsx("div",{className:"space-y-4",children:T.map((g,L)=>{const O=s.steps.findIndex($=>$.id===g.id),Y=ir(g,g.dueDate),B=l===O,X=new Date(g.dueDate),h=Math.ceil((X-new Date)/(1e3*60*60*24));return e.jsxs("div",{id:`step-${O}`,className:`border rounded-lg transition-all ${g.completed?"border-green-500/30 bg-green-600/5":Y==="overdue"?"border-red-500/30 bg-red-600/5":"border-gray-700/50"}`,children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:()=>w(O),className:"flex-shrink-0 mt-1",children:g.completed?e.jsx(Ge,{size:24,className:"text-green-400"}):e.jsx(At,{size:24,className:"text-gray-600 hover:text-gray-400 transition-colors"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-2",children:[e.jsxs("h3",{className:`text-lg font-bold ${g.completed?"text-green-400 line-through":"text-white"}`,children:[g.id,". ",g.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!g.completed&&e.jsx("button",{onClick:()=>z(O),className:`px-3 py-1 rounded-full text-xs font-bold transition-all ${g.inProgress?"bg-yellow-600/20 text-yellow-400 border border-yellow-500/30":"bg-gray-800 text-gray-500 border border-gray-700 hover:bg-gray-700"}`,children:g.inProgress?"In Progress":"Mark In Progress"}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold border flex items-center gap-1 ${u(Y)}`,children:[F(Y),g.completed?"Complete":Y==="overdue"?`${Math.abs(h)}d overdue`:Y==="in-progress"?"In Progress":h===0?"Due today":h===1?"Due tomorrow":`${h}d remaining`]})]})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:g.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(we,{size:14}),"Due: ",new Date(g.dueDate).toLocaleDateString("en-AU")]}),g.completedDate&&e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(Ge,{size:14}),"Completed: ",new Date(g.completedDate).toLocaleDateString("en-AU")]})]}),e.jsx("button",{onClick:()=>y(B?null:O),className:"mt-3 text-sm text-red-500 hover:text-red-400 font-medium flex items-center gap-1 transition-colors",children:B?e.jsxs(e.Fragment,{children:[e.jsx(Jt,{size:16}),"Hide Details"]}):e.jsxs(e.Fragment,{children:[e.jsx(jt,{size:16}),"Show Details & Notes"]})})]})]})}),e.jsx(at,{children:B&&e.jsx(ye.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-0 border-t border-gray-700/50 mt-4",children:[g.subTasks&&g.subTasks.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-2",children:"Checklist:"}),e.jsx("ul",{className:"space-y-1.5",children:g.subTasks.map(($,I)=>e.jsxs("li",{className:"text-sm text-gray-400 flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:$})]},I))})]}),g.emailTemplate&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(Ke,{size:14}),"Email Template:"]}),e.jsx("div",{className:"bg-gray-900/50 rounded-lg p-4 border border-gray-800",children:e.jsx("pre",{className:"text-xs text-gray-300 whitespace-pre-wrap font-mono",children:g.emailTemplate.replace("[CLIENT_NAME]",s.contactName).replace("[ORG_NAME]",s.orgName)})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm font-bold text-white mb-2 block flex items-center gap-2",children:[e.jsx(ze,{size:14}),"Notes:"]}),e.jsx("textarea",{value:g.notes,onChange:$=>p(O,$.target.value),placeholder:"Add notes, links, or details for this step...",className:"w-full bg-gray-900/50 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors text-sm min-h-[100px] resize-y"})]})]})})})]},g.id)})})]},C)})})]})}),e.jsx(at,{children:x&&e.jsx(ye.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:()=>j(!1),children:e.jsxs(ye.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:C=>C.stopPropagation(),className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-red-500/30 rounded-xl p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Delete Onboarding?"}),e.jsxs("p",{className:"text-gray-400 mb-6",children:["Are you sure you want to delete the onboarding workflow for ",e.jsx("strong",{className:"text-white",children:s.orgName}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:d,className:"flex-1 px-4 py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-lg transition-all",children:"Yes, Delete"}),e.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition-all",children:"Cancel"})]})]})})})]})}const dl=Object.freeze(Object.defineProperty({__proto__:null,default:cr},Symbol.toStringTag,{value:"Module"}));function xr(){const[t,a]=r.useState([]),[s,i]=r.useState(null),[l,y]=r.useState([]),[x,j]=r.useState([]),[c,w]=r.useState([]),[z,p]=r.useState([]),[d,f]=r.useState([]),[v,E]=r.useState([]),[A,D]=r.useState(!0),[o,N]=r.useState("events"),[k,u]=r.useState(!1),[F,C]=r.useState(null),[_,T]=r.useState(null),[g,L]=r.useState({}),[O,Y]=r.useState(null),[B,X]=r.useState([]),[P,h]=r.useState(!1),[$,I]=r.useState([]),[H,Q]=r.useState([]),V=new URLSearchParams(window.location.hash.split("?")[1]||"").get("org");r.useEffect(()=>{J()},[]),r.useEffect(()=>{s&&te(s.id)},[s]);async function J(){D(!0);const{data:n}=await U.from("organizations").select("*").order("name");if(a(n||[]),V&&n){const b=n.find(S=>S.id===V);b&&(i(b),window.location.hash.includes("galleries")&&N("galleries"))}D(!1)}async function te(n){const[b,S,q,K]=await Promise.all([U.from("events").select("*").eq("organization_id",n).order("date",{ascending:!0}),U.from("packages").select("*").eq("organization_id",n).order("sort_order"),U.from("content_orders").select("*, events(name), packages(name)").eq("organization_id",n).order("created_at",{ascending:!1}).limit(50),U.from("galleries").select("*, events(name), gallery_photos(count)").eq("organization_id",n).order("created_at",{ascending:!1})]);y(b.data||[]),j(S.data||[]),f(q.data||[]),E(K.data||[]);const le=(b.data||[]).map(se=>se.id);if(le.length>0){const[se,xe]=await Promise.all([U.from("division_categories").select("*").in("event_id",le).order("sort_order"),U.from("division_subdivisions").select("*").order("sort_order")]);w(se.data||[]);const be=(se.data||[]).map(ie=>ie.id);p((xe.data||[]).filter(ie=>be.includes(ie.category_id)))}else w([]),p([])}async function ae(){const{data:n,error:b}=await U.from("packages").select("*, organizations(name, display_name)").neq("organization_id",s?.id).order("name");!b&&n&&I(n)}async function ge(){if(H.length===0||!s)return;const b=$.filter(q=>H.includes(q.id)).map(q=>({name:q.name,description:q.description,price:q.price,sort_order:q.sort_order,active:q.active,organization_id:s.id})),{error:S}=await U.from("packages").insert(b);S?alert("Failed to import packages: "+S.message):(h(!1),Q([]),te(s.id))}function pe(n){return c.filter(b=>b.event_id===n)}function de(n){return z.filter(b=>b.category_id===n)}function re(n,b=null,S=null){C(n),T(b),n==="org"?L(b||{name:"",display_name:"",legal_name:"",slug:"",description:"",logo_url:"",active:!0}):n==="event"?L(b||{organization_id:s?.id,name:"",date:"",location:"",status:"upcoming",active:!0,divisions_required:!1}):n==="package"?L(b||{organization_id:s?.id,name:"",description:"",price:"",sort_order:0,active:!0}):n==="division-cat"?L(b||{event_id:S||O,name:"",sort_order:0,active:!0}):n==="division-sub"&&L(b||{category_id:S,name:"",sort_order:0,active:!0}),u(!0)}async function fe(){try{if(F==="org")_?.id?await U.from("organizations").update(g).eq("id",_.id):await U.from("organizations").insert(g),J();else if(F==="event"){const n={...g,organization_id:s.id};_?.id?await U.from("events").update(n).eq("id",_.id):await U.from("events").insert(n),te(s.id)}else if(F==="package"){const n={...g,organization_id:s.id,price:parseFloat(g.price)};_?.id?await U.from("packages").update(n).eq("id",_.id):await U.from("packages").insert(n),te(s.id)}else F==="division-cat"?(_?.id?await U.from("division_categories").update(g).eq("id",_.id):await U.from("division_categories").insert(g),te(s.id)):F==="division-sub"&&(_?.id?await U.from("division_subdivisions").update(g).eq("id",_.id):await U.from("division_subdivisions").insert(g),te(s.id));u(!1)}catch(n){console.error("Save error:",n),alert("Error saving. Check console.")}}async function ce(n,b){if(n==="organizations"){await ne(b);return}if(!confirm("Are you sure you want to delete this item?"))return;const{error:S}=await U.from(n).delete().eq("id",b);if(S){console.error("Delete error:",S),alert(`Failed to delete: ${S.message}`);return}te(s.id)}async function ne(n){const b=t.find(me=>me.id===n);if(!b)return;const[S,q,K,le]=await Promise.all([U.from("events").select("id, name").eq("organization_id",n),U.from("packages").select("id, name").eq("organization_id",n),U.from("content_orders").select("id").eq("organization_id",n),U.from("livestream_events").select("id, title").eq("organization_id",n)]),se=S.data||[],xe=q.data||[],be=K.data||[],ie=le.data||[];let he=`‚ö†Ô∏è DELETE "${b.display_name||b.name}"?

This will also delete:
`;if(se.length>0&&(he+=`
üìÖ ${se.length} event${se.length>1?"s":""}`,se.slice(0,3).forEach(me=>{he+=`
   ‚Ä¢ ${me.name}`}),se.length>3&&(he+=`
   ‚Ä¢ ...and ${se.length-3} more`)),xe.length>0&&(he+=`

üì¶ ${xe.length} package${xe.length>1?"s":""}`,xe.slice(0,3).forEach(me=>{he+=`
   ‚Ä¢ ${me.name}`}),xe.length>3&&(he+=`
   ‚Ä¢ ...and ${xe.length-3} more`)),ie.length>0&&(he+=`

üé¨ ${ie.length} livestream event${ie.length>1?"s":""}`,ie.slice(0,3).forEach(me=>{he+=`
   ‚Ä¢ ${me.title}`}),ie.length>3&&(he+=`
   ‚Ä¢ ...and ${ie.length-3} more`)),be.length>0&&(he+=`

üßæ ${be.length} order${be.length>1?"s":""}`),se.length+xe.length+be.length+ie.length===0?he=`Delete "${b.display_name||b.name}"?

No related items will be affected.`:he+=`

‚ö†Ô∏è THIS CANNOT BE UNDONE!`,!!confirm(he))try{be.length>0&&await U.from("content_orders").delete().eq("organization_id",n),xe.length>0&&await U.from("packages").delete().eq("organization_id",n);for(const Be of se){const{data:m}=await U.from("division_categories").select("id").eq("event_id",Be.id);if(m&&m.length>0){for(const W of m)await U.from("division_subdivisions").delete().eq("category_id",W.id);await U.from("division_categories").delete().eq("event_id",Be.id)}await U.from("events").delete().eq("id",Be.id)}ie.length>0&&await U.from("livestream_events").update({organization_id:null}).eq("organization_id",n);const{error:me}=await U.from("organizations").delete().eq("id",n);if(me)throw me;J(),s?.id===n&&i(null)}catch(me){console.error("Cascade delete error:",me),alert(`Failed to delete: ${me.message}`)}}async function M(n,b,S){await U.from(n).update({active:!S}).eq("id",b),n==="organizations"?J():te(s.id)}if(A)return e.jsx("div",{className:"p-8 text-gray-400",children:"Loading..."});if(!s)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Content Management"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select an organization to manage its events, packages, and divisions"})]}),e.jsx("button",{onClick:()=>re("org"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm font-medium",children:"+ Add Organization"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(n=>e.jsxs("div",{onClick:()=>i(n),className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6 cursor-pointer hover:border-red-500/50 hover:bg-gray-900/80 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n.logo_url?e.jsx("img",{src:zt(n.logo_url),alt:n.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center text-xl font-bold",children:n.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg group-hover:text-red-400 transition-colors",children:n.display_name||n.name}),n.display_name&&n.display_name!==n.name&&e.jsx("p",{className:"text-xs text-gray-400",children:n.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",n.slug]})]})]}),!n.active&&e.jsx("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded",children:"Inactive"})]}),n.description&&e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:n.description}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:b=>{b.stopPropagation(),re("org",n)},className:"text-xs text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:b=>{b.stopPropagation(),M("organizations",n.id,n.active)},className:"text-xs text-gray-400 hover:text-white",children:n.active?"Deactivate":"Activate"}),e.jsx("button",{onClick:b=>{b.stopPropagation(),ce("organizations",n.id)},className:"text-xs text-red-400 hover:text-red-300",children:"Delete"})]})]},n.id))}),k&&G()]});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-white transition-colors",children:"‚Üê Back"}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.logo_url?e.jsx("img",{src:zt(s.logo_url),alt:s.name,className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center text-lg font-bold",children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",s.slug]})]})]})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-gray-700 pb-2",children:["events","packages","divisions","galleries","orders"].map(n=>e.jsxs("button",{onClick:()=>N(n),className:`px-4 py-2 rounded-t-lg capitalize transition-colors ${o===n?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:[n," ",n==="events"&&`(${l.length})`,n==="packages"&&`(${x.length})`,n==="galleries"&&`(${v.length})`,n==="orders"&&`(${d.length})`]},n))}),o==="events"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Upcoming Events"}),e.jsx("button",{onClick:()=>re("event"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Event"})]}),l.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No events yet. Add one to get started."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Event Name"}),e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Location"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-center p-3",children:"Active"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(n=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:n.name}),e.jsx("td",{className:"p-3 text-gray-400",children:n.date&&new Date(n.date).toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{className:"p-3 text-gray-400",children:n.location}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${n.status==="upcoming"?"bg-blue-600":n.status==="active"?"bg-green-600":"bg-gray-600"}`,children:n.status})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>M("events",n.id,n.active),className:`px-2 py-1 rounded text-xs ${n.active?"bg-green-600":"bg-gray-600"}`,children:n.active?"Yes":"No"})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>re("event",n),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>ce("events",n.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},n.id))})]})})]}),o==="packages"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Content Packages"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{ae(),h(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm",children:"Import from..."}),e.jsx("button",{onClick:()=>re("package"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Package"})]})]}),x.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No packages yet. Add one to get started, or import from another organization."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Package Name"}),e.jsx("th",{className:"text-left p-3",children:"Description"}),e.jsx("th",{className:"text-right p-3",children:"Price"}),e.jsx("th",{className:"text-center p-3",children:"Active"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:x.map(n=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:n.name}),e.jsx("td",{className:"p-3 text-gray-400 truncate max-w-xs",children:n.description}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",n.price]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>M("packages",n.id,n.active),className:`px-2 py-1 rounded text-xs ${n.active?"bg-green-600":"bg-gray-600"}`,children:n.active?"Yes":"No"})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>re("package",n),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>ce("packages",n.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},n.id))})]})})]}),o==="divisions"&&e.jsx("div",{children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Divisions by Event"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Select an event to manage its division categories and subdivisions"}),l.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"Add events first, then you can manage their divisions."}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:O||"",onChange:n=>Y(n.target.value),className:"w-full max-w-md px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"",children:"Select an event..."}),l.map(n=>e.jsxs("option",{value:n.id,children:[n.name," (",n.date&&new Date(n.date).toLocaleDateString("en-AU"),")"]},n.id))]}),O&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Division Categories (",pe(O).length,")"]}),e.jsx("button",{onClick:()=>re("division-cat",null,O),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Category"})]}),pe(O).length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No division categories for this event yet."}):e.jsx("div",{className:"space-y-3",children:pe(O).map(n=>e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>X(b=>b.includes(n.id)?b.filter(S=>S!==n.id):[...b,n.id]),className:"text-gray-400 hover:text-white",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${B.includes(n.id)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("span",{className:"font-semibold",children:n.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",de(n.id).length," subdivisions)"]}),!n.active&&e.jsx("span",{className:"text-xs bg-gray-600 px-2 py-0.5 rounded",children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>re("division-cat",n),className:"text-blue-400 hover:text-blue-300 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>ce("division_categories",n.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})]})]}),B.includes(n.id)&&e.jsxs("div",{className:"p-4 border-t border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Subdivisions:"}),e.jsx("button",{onClick:()=>re("division-sub",null,n.id),className:"text-sm text-green-400 hover:text-green-300",children:"+ Add Subdivision"})]}),de(n.id).length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No subdivisions yet"}):e.jsx("div",{className:"flex flex-wrap gap-2",children:de(n.id).map(b=>e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm ${b.active?"bg-gray-800 border-gray-600":"bg-gray-900 border-gray-700 opacity-50"}`,children:[e.jsx("span",{children:b.name}),e.jsx("button",{onClick:()=>re("division-sub",b,n.id),className:"text-blue-400 hover:text-blue-300",children:"‚úé"}),e.jsx("button",{onClick:()=>ce("division_subdivisions",b.id),className:"text-red-400 hover:text-red-300",children:"√ó"})]},b.id))})]})]},n.id))}),s.slug==="nba"&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-900/20 border border-blue-800 rounded-xl",children:[e.jsx("h4",{className:"font-semibold text-blue-400 mb-2",children:"Quick Add: Standard NBA Divisions"}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Add all standard NBA bodybuilding divisions for this event"}),e.jsx("button",{onClick:async n=>{const b=n.target,S=b.innerText;if(!O){alert("Please select an event first");return}if(window.confirm("Add all standard NBA divisions to this event?")){b.disabled=!0,b.innerText="Adding divisions...";try{const q={"Men's Physique":["Novice","Open","Masters 40+","Masters 50+","Junior"],"Classic Physique":["Novice","Open","Masters 40+","Masters 50+"],Bodybuilding:["Novice","Open","Masters 40+","Masters 50+","Junior"],Figure:["Novice","Open","Masters 35+","Masters 45+","Junior"],Bikini:["Novice","Open","Masters 35+","Masters 45+","Junior"],Wellness:["Novice","Open","Masters 35+","Masters 45+"],"Fitness Model":["Open","Masters"],"Sports Model":["Open","Masters"],Transformation:["Open"]};let K=0,le=0;for(const[se,xe]of Object.entries(q)){const{data:be,error:ie}=await U.from("division_categories").insert({event_id:O,name:se,sort_order:K++,active:!0}).select().single();if(ie){console.error("Error adding category:",se,ie);continue}if(be){le++;let he=0;for(const Te of xe){const{error:me}=await U.from("division_subdivisions").insert({category_id:be.id,name:Te,sort_order:he++,active:!0});me&&console.error("Error adding subdivision:",Te,me)}}}alert(`Added ${le} division categories with subdivisions!`),await te(s.id)}catch(q){console.error("Error adding divisions:",q),alert("Error adding divisions: "+q.message)}finally{b.disabled=!1,b.innerText=S}}},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm disabled:opacity-50",children:"Add Standard NBA Divisions"})]})]})]})]})}),o==="galleries"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Photo Galleries"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`/#/portal/galleries?org=${s.id}&create=true`,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ New Gallery"}),v.length>0&&e.jsx("a",{href:`/#/portal/galleries?org=${s.id}`,className:"px-4 py-2 bg-dark-600 hover:bg-dark-500 rounded-lg text-sm",children:"Manage All"})]})]}),v.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No galleries yet. Create one to start selling event photos."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Gallery Name"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-center p-3",children:"Photos"}),e.jsx("th",{className:"text-right p-3",children:"Price/Photo"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:v.map(n=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:n.title}),e.jsx("td",{className:"p-3 text-gray-400",children:n.events?.name||"‚Äî"}),e.jsx("td",{className:"p-3 text-center",children:n.gallery_photos?.[0]?.count||0}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",(n.price_per_photo/100).toFixed(2)]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${n.status==="published"?"bg-green-600":n.status==="draft"?"bg-yellow-600":"bg-gray-600"}`,children:n.status})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("a",{href:`/#/portal/galleries?edit=${n.id}`,className:"text-blue-400 hover:text-blue-300",children:"Edit"}),n.status==="published"&&e.jsx("a",{href:`/#/gallery/${n.slug}`,target:"_blank",className:"text-green-400 hover:text-green-300",children:"View"})]})]},n.id))})]})})]}),o==="orders"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Orders"}),e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Athlete"}),e.jsx("th",{className:"text-left p-3",children:"Email"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-left p-3",children:"Package"}),e.jsx("th",{className:"text-right p-3",children:"Amount"}),e.jsx("th",{className:"text-center p-3",children:"Status"})]})}),e.jsx("tbody",{children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-400",children:"No orders yet"})}):d.map(n=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 text-gray-400",children:new Date(n.created_at).toLocaleDateString("en-AU")}),e.jsxs("td",{className:"p-3 font-medium",children:[n.first_name," ",n.last_name]}),e.jsx("td",{className:"p-3 text-gray-400",children:n.email}),e.jsx("td",{className:"p-3 text-gray-400",children:n.events?.name}),e.jsx("td",{className:"p-3 text-gray-400",children:n.packages?.name}),e.jsxs("td",{className:"p-3 text-right font-semibold",children:["$",n.amount]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${n.status==="paid"?"bg-green-600":n.status==="delivered"?"bg-blue-600":n.status==="pending"?"bg-yellow-600":"bg-gray-600"}`,children:n.status})})]},n.id))})]})})]}),k&&G(),P&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-lg max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Import Packages from Other Organizations"}),$.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No packages available to import from other organizations."}):e.jsx("div",{className:"flex-1 overflow-y-auto mb-4 space-y-2",children:Object.entries($.reduce((n,b)=>{const S=b.organizations?.display_name||b.organizations?.name||"Unknown";return n[S]||(n[S]=[]),n[S].push(b),n},{})).map(([n,b])=>e.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-800 px-3 py-2 font-medium text-sm",children:n}),e.jsx("div",{className:"divide-y divide-gray-800",children:b.map(S=>e.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-800/50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:H.includes(S.id),onChange:q=>{q.target.checked?Q(K=>[...K,S.id]):Q(K=>K.filter(le=>le!==S.id))},className:"w-4 h-4 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:S.name}),S.description&&e.jsx("div",{className:"text-xs text-gray-400 truncate",children:S.description})]}),e.jsxs("div",{className:"text-green-400 font-semibold",children:["$",S.price]})]},S.id))})]},n))}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>{h(!1),Q([])},className:"flex-1 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:ge,disabled:H.length===0,className:"flex-1 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:["Import ",H.length>0&&`(${H.length})`]})]})]})})]});function G(){return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[_?"Edit":"Add"," ",F==="org"?"Organization":F==="event"?"Event":F==="package"?"Package":F==="division-cat"?"Division Category":F==="division-sub"?"Subdivision":""]}),e.jsxs("div",{className:"space-y-4",children:[F==="org"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization Name *"}),e.jsx("input",{type:"text",value:g.name||"",onChange:n=>L({...g,name:n.target.value}),placeholder:"e.g., World Ninja Games",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name (Short)"}),e.jsx("input",{type:"text",value:g.display_name||"",onChange:n=>L({...g,display_name:n.target.value}),placeholder:"e.g., WNG",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown on livestream cards & filters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Legal Name"}),e.jsx("input",{type:"text",value:g.legal_name||"",onChange:n=>L({...g,legal_name:n.target.value}),placeholder:"e.g., World Ninja Games Pty Ltd",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For contracts & invoices"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Slug (URL-friendly)"}),e.jsx("input",{type:"text",value:g.slug||"",onChange:n=>L({...g,slug:n.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Logo URL"}),e.jsx("input",{type:"text",value:g.logo_url||"",onChange:n=>L({...g,logo_url:n.target.value}),placeholder:"https://...",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:g.description||"",onChange:n=>L({...g,description:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",rows:3})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4 mt-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3 font-medium",children:"Contact / Organizer"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:g.contact_name||"",onChange:n=>L({...g,contact_name:n.target.value}),placeholder:"e.g., Phil Cassidy",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Email"}),e.jsx("input",{type:"email",value:g.contact_email||"",onChange:n=>L({...g,contact_email:n.target.value}),placeholder:"email@example.com",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:g.contact_phone||"",onChange:n=>L({...g,contact_phone:n.target.value}),placeholder:"+61 400 000 000",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]})]})]})]}),F==="event"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{type:"text",value:g.name||"",onChange:n=>L({...g,name:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:g.date||"",onChange:n=>L({...g,date:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:g.location||"",onChange:n=>L({...g,location:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:g.status||"upcoming",onChange:n=>L({...g,status:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.divisions_required||!1,onChange:n=>L({...g,divisions_required:n.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-white",children:"Require Divisions"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Athletes must select a division when ordering"})]})]})]}),F==="package"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Package Name"}),e.jsx("input",{type:"text",value:g.name||"",onChange:n=>L({...g,name:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:g.description||"",onChange:n=>L({...g,description:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Price (AUD)"}),e.jsx("input",{type:"number",value:g.price||"",onChange:n=>L({...g,price:n.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:g.sort_order||0,onChange:n=>L({...g,sort_order:parseInt(n.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]})]}),F==="division-cat"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category Name"}),e.jsx("input",{type:"text",value:g.name||"",onChange:n=>L({...g,name:n.target.value}),placeholder:"e.g., Men's Physique, Bikini, Figure",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:g.sort_order||0,onChange:n=>L({...g,sort_order:parseInt(n.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),F==="division-sub"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Subdivision Name"}),e.jsx("input",{type:"text",value:g.name||"",onChange:n=>L({...g,name:n.target.value}),placeholder:"e.g., Novice, Open, Masters 40+",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:g.sort_order||0,onChange:n=>L({...g,sort_order:parseInt(n.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:g.active??!0,onChange:n=>L({...g,active:n.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-400",children:"Active"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 py-2 border border-gray-600 rounded-lg hover:bg-gray-800",children:"Cancel"}),e.jsx("button",{onClick:fe,className:"flex-1 py-2 bg-red-600 hover:bg-red-700 rounded-lg",children:"Save"})]})]})})}}const cl=Object.freeze(Object.defineProperty({__proto__:null,default:xr},Symbol.toStringTag,{value:"Module"}));function mr(){const[t,a]=r.useState([]),[s,i]=r.useState([]),[l,y]=r.useState([]),[x,j]=r.useState([]),[c,w]=r.useState(!0),[z,p]=r.useState("all"),[d,f]=r.useState("all"),[v,E]=r.useState(""),[A,D]=r.useState(""),[o,N]=r.useState(""),[k,u]=r.useState(null);r.useEffect(()=>{F()},[]);async function F(){w(!0);const{data:B}=await U.from("organizations").select("*").order("name");i(B||[]);const{data:X}=await U.from("events").select("*").order("date",{ascending:!1});y(X||[]);const{data:P}=await U.from("packages").select("*").order("name");j(P||[]);const{data:h}=await U.from("content_orders").select("*").order("created_at",{ascending:!1});a(h||[]),w(!1)}async function C(B){const{error:X}=await U.from("content_orders").update({status:"delivered",delivered_at:new Date().toISOString()}).eq("id",B);X?alert("Failed to update order status"):F()}function _(B){return s.find(X=>X.id===B)?.name||"Unknown"}function T(B){return l.find(X=>X.id===B)?.name||"Unknown"}function g(B){return x.find(X=>X.id===B)?.name||"Unknown"}const L=t.filter(B=>{if(z!=="all"&&B.organization_id!==z||d!=="all"&&B.status!==d||v&&new Date(B.created_at)<new Date(v)||A&&new Date(B.created_at)>new Date(A+"T23:59:59"))return!1;if(o){const X=o.toLowerCase(),P=`${B.first_name} ${B.last_name}`.toLowerCase(),h=B.email?.toLowerCase()||"",$=B.phone?.toLowerCase()||"";if(!P.includes(X)&&!h.includes(X)&&!$.includes(X))return!1}return!0}),O=L.filter(B=>B.status==="paid"||B.status==="delivered").reduce((B,X)=>B+(parseFloat(X.amount)||0),0);function Y(){const B=["Date","Customer","Email","Phone","Organization","Event","Package","Amount","Status"],X=L.map(H=>[new Date(H.created_at).toLocaleDateString(),`${H.first_name} ${H.last_name}`,H.email,H.phone||"",_(H.organization_id),T(H.event_id),g(H.package_id),H.amount,H.status]),P=[B,...X].map(H=>H.join(",")).join(`
`),h=new Blob([P],{type:"text/csv"}),$=URL.createObjectURL(h),I=document.createElement("a");I.href=$,I.download=`orders-${new Date().toISOString().split("T")[0]}.csv`,I.click()}return c?e.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:e.jsx("div",{className:"text-gray-400",children:"Loading orders..."})}):e.jsxs("div",{className:"min-h-screen bg-black text-white p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Order Management"}),e.jsxs("p",{className:"text-gray-400 mt-1",children:[L.length," orders ‚Ä¢ $",O.toFixed(2)," AUD revenue"]})]}),e.jsxs("button",{onClick:Y,className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg hover:bg-gray-700 flex items-center gap-2",children:[e.jsx("span",{children:"üì•"}),"Export CSV"]})]}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 mb-6 border border-gray-800",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization"}),e.jsxs("select",{value:z,onChange:B=>p(B.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"all",children:"All Organizations"}),s.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:d,onChange:B=>f(B.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"refunded",children:"Refunded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:v,onChange:B=>E(B.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:A,onChange:B=>D(B.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Search (Name, Email, Phone)"}),e.jsx("input",{type:"text",value:o,onChange:B=>N(B.target.value),placeholder:"Search orders...",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsx("div",{className:"bg-gray-900 rounded-lg overflow-hidden border border-gray-800",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-sm font-semibold",children:"Date"}),e.jsx("th",{className:"text-left p-4 text-sm font-semibold",children:"Customer"}),e.jsx("th",{className:"text-left p-4 text-sm font-semibold",children:"Organization"}),e.jsx("th",{className:"text-left p-4 text-sm font-semibold",children:"Event"}),e.jsx("th",{className:"text-left p-4 text-sm font-semibold",children:"Package"}),e.jsx("th",{className:"text-right p-4 text-sm font-semibold",children:"Amount"}),e.jsx("th",{className:"text-center p-4 text-sm font-semibold",children:"Status"}),e.jsx("th",{className:"text-center p-4 text-sm font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:L.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center p-8 text-gray-500",children:"No orders found"})}):L.map(B=>e.jsxs("tr",{className:"border-t border-gray-800 hover:bg-gray-800/50",children:[e.jsxs("td",{className:"p-4 text-sm",children:[new Date(B.created_at).toLocaleDateString(),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(B.created_at).toLocaleTimeString()})]}),e.jsxs("td",{className:"p-4",children:[e.jsxs("div",{className:"font-medium",children:[B.first_name," ",B.last_name]}),e.jsx("div",{className:"text-sm text-gray-400",children:B.email}),B.phone&&e.jsx("div",{className:"text-xs text-gray-500",children:B.phone})]}),e.jsx("td",{className:"p-4 text-sm",children:_(B.organization_id)}),e.jsx("td",{className:"p-4 text-sm",children:T(B.event_id)}),e.jsx("td",{className:"p-4 text-sm",children:g(B.package_id)}),e.jsxs("td",{className:"p-4 text-right font-semibold",children:["$",B.amount]}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${B.status==="delivered"?"bg-green-500/20 text-green-400":B.status==="paid"?"bg-blue-500/20 text-blue-400":B.status==="processing"?"bg-yellow-500/20 text-yellow-400":B.status==="refunded"?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:B.status})}),e.jsxs("td",{className:"p-4 text-center",children:[e.jsx("button",{onClick:()=>u(B),className:"text-blue-400 hover:text-blue-300 text-sm mr-3",children:"View"}),B.status==="paid"&&e.jsx("button",{onClick:()=>C(B.id),className:"text-green-400 hover:text-green-300 text-sm",children:"Mark Delivered"})]})]},B.id))})]})})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>u(null),children:e.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full p-6 border border-gray-800",onClick:B=>B.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Order Details"}),e.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-white",children:"‚úï"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-3 text-red-500",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Name:"}),e.jsxs("div",{className:"font-medium",children:[k.first_name," ",k.last_name]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Email:"}),e.jsx("div",{className:"font-medium",children:k.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Phone:"}),e.jsx("div",{className:"font-medium",children:k.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Instagram:"}),e.jsxs("div",{className:"font-medium",children:["@",k.instagram||"N/A"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Division:"}),e.jsx("div",{className:"font-medium",children:k.division||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Coach:"}),e.jsxs("div",{className:"font-medium",children:[k.coach_name||"N/A"," (@",k.coach_instagram||"N/A",")"]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-3 text-red-500",children:"Order Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Organization:"}),e.jsx("div",{className:"font-medium",children:_(k.organization_id)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Event:"}),e.jsx("div",{className:"font-medium",children:T(k.event_id)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Package:"}),e.jsx("div",{className:"font-medium",children:g(k.package_id)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Amount:"}),e.jsxs("div",{className:"font-medium text-lg",children:["$",k.amount," ",k.currency]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"font-medium",children:k.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Order Date:"}),e.jsx("div",{className:"font-medium",children:new Date(k.created_at).toLocaleString()})]}),k.paid_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Paid At:"}),e.jsx("div",{className:"font-medium",children:new Date(k.paid_at).toLocaleString()})]}),k.delivered_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Delivered At:"}),e.jsx("div",{className:"font-medium",children:new Date(k.delivered_at).toLocaleString()})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-3 text-red-500",children:"Payment Information"}),e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Stripe Session ID:"}),e.jsx("div",{className:"font-mono text-xs break-all",children:k.stripe_session_id})]}),k.stripe_payment_id&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Payment Intent ID:"}),e.jsx("div",{className:"font-mono text-xs break-all",children:k.stripe_payment_id})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[k.status==="paid"&&e.jsx("button",{onClick:()=>{C(k.id),u(null)},className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-medium",children:"Mark as Delivered"}),e.jsx("button",{onClick:()=>u(null),className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg font-medium",children:"Close"})]})]})]})})]})}const xl=Object.freeze(Object.defineProperty({__proto__:null,default:mr},Symbol.toStringTag,{value:"Module"})),gr={1:1,2:1.8,3:2.4,4:2.9},hr={1:"Base rate",2:"+80% for 2nd person",3:"+60% for 3rd person",4:"+50% for 4th person"},Vt=[{id:"teleprompter",name:"Teleprompter",price:150},{id:"drone",name:"Drone Footage",price:300,perDay:!0},{id:"music",name:"Licensed Music",price:75},{id:"script",name:"Script Writing",price:250},{id:"skin",name:"Skin Smoothing",price:100},{id:"rush",name:"Rush Delivery",price:0,multiplier:1.5},{id:"revisions",name:"Extra Revisions",price:150,note:"3 rounds"}],Gt=[{id:"horizontal",name:"Horizontal (16:9)",icon:"üì∫"},{id:"vertical",name:"Vertical (9:16)",icon:"üì±"},{id:"square",name:"Square (1:1)",icon:"‚¨ú"}];function ur(){const[t,a]=r.useState(1e3),[s,i]=r.useState(2),[l,y]=r.useState(1),[x,j]=r.useState(4),[c,w]=r.useState(0),[z,p]=r.useState([{id:1,name:"Main Video",length:2,format:"horizontal"}]),[d,f]=r.useState(500),[v,E]=r.useState(300),[A,D]=r.useState(200),[o,N]=r.useState("none"),[k,u]=r.useState(0),[F,C]=r.useState({}),[_,T]=r.useState({}),g=()=>{const P=Math.max(...z.map(h=>h.id),0)+1;p([...z,{id:P,name:`Video ${P}`,length:1,format:"horizontal"}])},L=P=>{z.length>1&&p(z.filter(h=>h.id!==P))},O=(P,h,$)=>{p(z.map(I=>I.id===P?{...I,[h]:$}:I))},Y=r.useCallback(()=>{const P=t*.4,h=t*.6/7,$=Math.max(0,x-1),I=P+$*h,H=gr[s],R=I*H*l,V=c*2,J=Math.ceil(V/50)*50,te=c>0?J:0;let ae=0;const ge=z.map((n,b)=>{const S=b===0?d:v,q=Math.max(0,n.length-1)*A,K=S+q;return ae+=K,{...n,cost:K}});let pe=0,de=[],re=1;Object.entries(F).forEach(([n,b])=>{if(!b)return;const S=Vt.find(q=>q.id===n);if(S){if(S.multiplier)re=S.multiplier,de.push("Rush (+50%)");else if(S.price>0){const q=S.perDay?S.price*l:S.price;pe+=q,de.push(S.name)}}});let fe=(R+te+ae+pe)*re,ce=0;o==="percent"&&k>0?ce=fe*(k/100):o==="fixed"&&k>0&&(ce=k);const ne=fe-ce,M=ne/1.1,G=ne-M;T({baseRate:Math.round(P),hourlyRate:Math.round(h),shootTotal:Math.round(R),roundTripKm:V,travelTotal:te,deliverablesTotal:Math.round(ae),deliverableBreakdown:ge,addonsTotal:Math.round(pe),addonsItems:de,discountAmount:Math.round(ce),grandTotal:Math.round(ne),exGst:Math.round(M),gstAmount:Math.round(G)})},[t,s,l,x,c,z,d,v,A,o,k,F]);r.useEffect(()=>{Y()},[Y]);const B=P=>{C(h=>({...h,[P]:!h[P]}))},X=()=>{const P=z.map(($,I)=>{const H=Gt.find(Q=>Q.id===$.format);return`‚Ä¢ ${$.name}: ${$.length} min ${H?.name||""} ‚Äî $${_.deliverableBreakdown?.[I]?.cost?.toLocaleString()||0}`}).join(`
`),h=`
FFM PROJECT QUOTE
==================

PRODUCTION
‚Ä¢ Crew: ${s} person${s>1?"s":""}
‚Ä¢ Duration: ${l} day${l>1?"s":""} √ó ${x} hours
‚Ä¢ Production: $${_.shootTotal?.toLocaleString()}

TRAVEL
‚Ä¢ ${_.roundTripKm>0?`${_.roundTripKm}km round trip`:"Local (no charge)"}
‚Ä¢ Travel: $${_.travelTotal?.toLocaleString()}

DELIVERABLES (${z.length} video${z.length>1?"s":""})
${P}
‚Ä¢ Total Editing: $${_.deliverablesTotal?.toLocaleString()}

${_.addonsItems?.length>0?`ADD-ONS
‚Ä¢ ${_.addonsItems.join(`
‚Ä¢ `)}
‚Ä¢ Add-ons: $${_.addonsTotal?.toLocaleString()}
`:""}
==================
TOTAL: $${_.grandTotal?.toLocaleString()} (Inc. GST)
Ex. GST: $${_.exGst?.toLocaleString()}

Valid for 30 days.
    `.trim();navigator.clipboard.writeText(h).then(()=>{alert("Quote copied to clipboard!")})};return e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-500",children:"Project Pricing Calculator"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Structure-based pricing for video production"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üí∞"})," Base Day Rate"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Day Rate (AUD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:"$"}),e.jsx("input",{type:"number",value:t,onChange:P=>a(parseFloat(P.target.value)||0),min:"100",step:"50",className:"w-full bg-gray-700 border border-gray-600 rounded-lg pl-8 pr-4 py-3 text-lg font-semibold focus:border-red-500 focus:outline-none transition"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All prices auto-scale from this"})]}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Calculated Rates:"}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Base Rate (40%):"}),e.jsxs("span",{className:"font-semibold text-green-400",children:["$",_.baseRate]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Hourly Rate:"}),e.jsxs("span",{className:"font-semibold text-green-400",children:["$",_.hourlyRate,"/hr"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üë•"})," Crew & Shooting Time"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Crew Size"}),e.jsxs("select",{value:s,onChange:P=>i(parseInt(P.target.value)),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:border-red-500 focus:outline-none",children:[e.jsx("option",{value:"1",children:"1 Person"}),e.jsx("option",{value:"2",children:"2 People"}),e.jsx("option",{value:"3",children:"3 People"}),e.jsx("option",{value:"4",children:"4 People"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:hr[s]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Shoot Days"}),e.jsx("input",{type:"number",value:l,onChange:P=>y(parseInt(P.target.value)||1),min:"1",max:"30",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:border-red-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Hours Per Day"}),e.jsx("input",{type:"number",value:x,onChange:P=>j(parseFloat(P.target.value)||1),min:"1",max:"12",step:"0.5",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:border-red-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üöó"})," Travel"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Distance (KM, one way)"}),e.jsx("input",{type:"number",value:c,onChange:P=>w(parseFloat(P.target.value)||0),min:"0",step:"10",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:border-red-500 focus:outline-none"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"$50 per 50km (round trip calculated)"})]}),e.jsx("div",{className:"bg-gray-700/50 rounded-lg p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-400",children:"Round Trip"}),e.jsxs("div",{className:"text-2xl font-bold text-red-400",children:[_.roundTripKm||0," km"]})]})})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üé¨"})," Deliverables"]}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition",children:"+ Add Video"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6 p-4 bg-gray-700/30 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"First Video Base"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx("input",{type:"number",value:d,onChange:P=>f(parseFloat(P.target.value)||0),className:"w-full bg-gray-700 border border-gray-600 rounded-lg pl-6 pr-2 py-2 text-sm focus:border-red-500 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Additional Videos"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx("input",{type:"number",value:v,onChange:P=>E(parseFloat(P.target.value)||0),className:"w-full bg-gray-700 border border-gray-600 rounded-lg pl-6 pr-2 py-2 text-sm focus:border-red-500 focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Per Extra Minute"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"$"}),e.jsx("input",{type:"number",value:A,onChange:P=>D(parseFloat(P.target.value)||0),className:"w-full bg-gray-700 border border-gray-600 rounded-lg pl-6 pr-2 py-2 text-sm focus:border-red-500 focus:outline-none"})]})]})]}),e.jsx("div",{className:"space-y-3",children:z.map((P,h)=>e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${h===0?"bg-red-600 text-white":"bg-gray-600 text-gray-300"}`,children:h===0?"Primary":`+${h}`}),e.jsx("input",{type:"text",value:P.name,onChange:$=>O(P.id,"name",$.target.value),className:"bg-transparent border-b border-gray-600 focus:border-red-500 outline-none text-white font-medium",placeholder:"Video name"})]}),z.length>1&&e.jsx("button",{onClick:()=>L(P.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Length (min)"}),e.jsx("input",{type:"number",value:P.length,onChange:$=>O(P.id,"length",parseInt($.target.value)||1),min:"1",max:"60",className:"w-full bg-gray-600 border border-gray-500 rounded px-3 py-2 text-sm focus:border-red-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Format"}),e.jsx("select",{value:P.format,onChange:$=>O(P.id,"format",$.target.value),className:"w-full bg-gray-600 border border-gray-500 rounded px-3 py-2 text-sm focus:border-red-500 focus:outline-none",children:Gt.map($=>e.jsxs("option",{value:$.id,children:[$.icon," ",$.name]},$.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Cost"}),e.jsxs("div",{className:"bg-gray-600/50 rounded px-3 py-2 text-sm font-semibold text-green-400",children:["$",_.deliverableBreakdown?.[h]?.cost?.toLocaleString()||0]})]})]})]},P.id))}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-700/50 rounded-lg text-sm text-gray-400",children:[e.jsx("strong",{children:"Each video includes:"})," Color correction, color grading, audio mixing, lower thirds, file conversion"]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"‚ú®"})," Add-Ons"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Vt.map(P=>e.jsxs("label",{className:`flex items-center gap-3 rounded-lg p-3 cursor-pointer transition ${F[P.id]?"bg-red-600/20 border border-red-500/50":"bg-gray-700/50 hover:bg-gray-700"}`,children:[e.jsx("input",{type:"checkbox",checked:F[P.id]||!1,onChange:()=>B(P.id),className:"w-5 h-5 rounded accent-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:P.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[P.multiplier?"+50%":`$${P.price}${P.perDay?"/day":""}`,P.note&&` (${P.note})`]})]})]},P.id))})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700/50",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üéÅ"})," Package Discount"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Discount Type"}),e.jsxs("select",{value:o,onChange:P=>{N(P.target.value),P.target.value==="none"&&u(0)},className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:border-red-500 focus:outline-none",children:[e.jsx("option",{value:"none",children:"No Discount"}),e.jsx("option",{value:"percent",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Discount Value"}),e.jsx("input",{type:"number",value:k,onChange:P=>u(parseFloat(P.target.value)||0),min:"0",disabled:o==="none",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:border-red-500 focus:outline-none disabled:opacity-50"})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-gradient-to-br from-red-600 to-red-800 rounded-xl p-6 sticky top-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Quote Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-red-200",children:"Production (Shoot)"}),e.jsxs("div",{className:"text-2xl font-bold",children:["$",_.shootTotal?.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-red-300 mt-1",children:[s," crew √ó ",x,"h √ó ",l," day",l>1?"s":""]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-red-200",children:"Travel"}),e.jsxs("div",{className:"text-2xl font-bold",children:["$",_.travelTotal?.toLocaleString()]}),e.jsx("div",{className:"text-xs text-red-300 mt-1",children:c>0?`${_.roundTripKm}km round trip`:"Local (no charge)"})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[e.jsxs("div",{className:"text-sm text-red-200",children:["Deliverables (",z.length," video",z.length>1?"s":"",")"]}),e.jsxs("div",{className:"text-2xl font-bold",children:["$",_.deliverablesTotal?.toLocaleString()]}),e.jsx("div",{className:"text-xs text-red-300 mt-1 space-y-0.5",children:_.deliverableBreakdown?.map((P,h)=>e.jsxs("div",{children:[P.name,": ",P.length,"min ‚Äî $",P.cost?.toLocaleString()]},h))})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-red-200",children:"Add-Ons"}),e.jsxs("div",{className:"text-2xl font-bold",children:["$",_.addonsTotal?.toLocaleString()]}),e.jsx("div",{className:"text-xs text-red-300 mt-1",children:_.addonsItems?.length>0?_.addonsItems.join(", "):"None selected"})]}),_.discountAmount>0&&e.jsxs("div",{className:"bg-black/20 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-red-200",children:"Discount"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:["-$",_.discountAmount?.toLocaleString()]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-red-400/30",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-red-200",children:"TOTAL QUOTE"}),e.jsx("div",{className:"text-xs text-red-300",children:"Inc. GST"})]}),e.jsxs("div",{className:"text-4xl font-bold",children:["$",_.grandTotal?.toLocaleString()]})]})}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-red-400/30",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-red-200",children:"Ex. GST:"}),e.jsxs("span",{className:"font-semibold",children:["$",_.exGst?.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm mt-1",children:[e.jsx("span",{className:"text-red-200",children:"GST (10%):"}),e.jsxs("span",{className:"font-semibold",children:["$",_.gstAmount?.toLocaleString()]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:X,className:"w-full bg-white text-red-600 font-semibold py-3 rounded-lg hover:bg-red-100 transition",children:"üìã Copy Quote Text"})})]})})]}),e.jsx("div",{className:"mt-12 text-center text-gray-500 text-sm",children:e.jsx("p",{children:"Pricing based on structure-based methodology. All prices in AUD."})})]})}const ml=Object.freeze(Object.defineProperty({__proto__:null,default:ur},Symbol.toStringTag,{value:"Module"}));function pr({event:t,crew:a,equipment:s,onClose:i}){if(!t)return null;const l=p=>(p||[]).map(d=>a.find(f=>f.id===d)).filter(Boolean),y=p=>(p||[]).map(d=>s.find(f=>f.id===d)).filter(Boolean);function x(p){return new Date(p).toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}const j=l(t.crew_ids),c=y(t.equipment_ids),w=c.reduce((p,d)=>{const f=d.category||"Other";return p[f]||(p[f]=[]),p[f].push(d),p},{}),z={confirmed:"#10b981",tentative:"#f59e0b",completed:"#6b7280",cancelled:"#ef4444"};return e.jsxs("div",{className:"fixed inset-0 bg-black/80 flex items-start justify-center z-50 p-4 overflow-y-auto",children:[e.jsxs("div",{className:"print:hidden fixed top-4 right-4 flex items-center gap-3 z-10",children:[e.jsxs("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 rounded-lg text-white font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Brief"]}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Close"})]}),e.jsxs("div",{id:"event-brief",className:"bg-white text-gray-900 w-full max-w-3xl my-4 rounded-xl overflow-hidden print:m-0 print:rounded-none print:shadow-none",style:{fontFamily:"system-ui, -apple-system, sans-serif"},children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",color:"white",padding:"32px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"2px",color:"#e5383b",fontWeight:"700",marginBottom:"8px"},children:"FIT FOCUS MEDIA ‚Äî PRODUCTION BRIEF"}),e.jsx("h1",{style:{fontSize:"28px",fontWeight:"800",margin:"0 0 8px"},children:t.name}),e.jsx("p",{style:{fontSize:"16px",color:"#e5383b",margin:"0"},children:t.client})]}),e.jsx("div",{style:{textAlign:"right"},children:e.jsx("span",{style:{background:z[t.status]||"#6b7280",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px"},children:t.status})})]})}),e.jsxs("div",{style:{padding:"32px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"24px",marginBottom:"32px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",textTransform:"uppercase",letterSpacing:"1px",color:"#9ca3af",marginBottom:"6px"},children:"DATE"}),e.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:x(t.date)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",textTransform:"uppercase",letterSpacing:"1px",color:"#9ca3af",marginBottom:"6px"},children:"LOCATION"}),e.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:t.location||"TBC"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"10px",textTransform:"uppercase",letterSpacing:"1px",color:"#9ca3af",marginBottom:"6px"},children:"CLIENT"}),e.jsx("div",{style:{fontSize:"15px",fontWeight:"600",color:"#111827"},children:t.client})]})]}),e.jsx("div",{style:{borderTop:"1px solid #e5e7eb",marginBottom:"28px"}}),e.jsxs("div",{style:{marginBottom:"28px"},children:[e.jsxs("h2",{style:{fontSize:"14px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",color:"#374151",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:["üë• Crew (",j.length,")"]}),j.length>0?e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#f9fafb"},children:[e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Name"}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Role"}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Phone"}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Email"})]})}),e.jsx("tbody",{children:j.map((p,d)=>e.jsxs("tr",{style:{background:d%2===0?"white":"#f9fafb"},children:[e.jsx("td",{style:{padding:"10px 12px",fontWeight:"600",fontSize:"14px",borderBottom:"1px solid #f3f4f6"},children:p.name}),e.jsx("td",{style:{padding:"10px 12px",fontSize:"13px",color:"#6b7280",borderBottom:"1px solid #f3f4f6"},children:p.role||"‚Äî"}),e.jsx("td",{style:{padding:"10px 12px",fontSize:"13px",borderBottom:"1px solid #f3f4f6"},children:p.phone||"‚Äî"}),e.jsx("td",{style:{padding:"10px 12px",fontSize:"13px",borderBottom:"1px solid #f3f4f6"},children:p.email||"‚Äî"})]},p.id))})]}):e.jsx("p",{style:{color:"#9ca3af",fontSize:"14px",fontStyle:"italic"},children:"No crew assigned yet. Assign crew from the Crew & Logistics portal."})]}),c.length>0&&e.jsxs("div",{style:{marginBottom:"28px"},children:[e.jsxs("h2",{style:{fontSize:"14px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",color:"#374151",marginBottom:"12px"},children:["üì∑ Equipment (",c.length," items)"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:Object.entries(w).map(([p,d])=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",color:"#9ca3af",marginBottom:"6px"},children:p}),d.map(f=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px solid #f3f4f6",fontSize:"13px"},children:[e.jsx("span",{style:{color:"#111827"},children:f.name}),e.jsxs("span",{style:{color:"#6b7280"},children:["√ó",f.quantity]})]},f.id))]},p))})]}),(t.flight_links?.length||0)+(t.accommodation_links?.length||0)+(t.rental_links?.length||0)>0&&e.jsxs("div",{style:{marginBottom:"28px"},children:[e.jsx("h2",{style:{fontSize:"14px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",color:"#374151",marginBottom:"12px"},children:"‚úàÔ∏è Travel & Logistics"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px"},children:[t.flight_links?.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"700",color:"#9ca3af",textTransform:"uppercase",marginBottom:"6px"},children:"Flights"}),t.flight_links.map((p,d)=>e.jsxs("a",{href:p,style:{display:"block",color:"#2563eb",fontSize:"13px",marginBottom:"4px",wordBreak:"break-all"},children:["üîó Flight ",d+1]},d))]}),t.accommodation_links?.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"700",color:"#9ca3af",textTransform:"uppercase",marginBottom:"6px"},children:"Accommodation"}),t.accommodation_links.map((p,d)=>e.jsxs("a",{href:p,style:{display:"block",color:"#2563eb",fontSize:"13px",marginBottom:"4px",wordBreak:"break-all"},children:["üîó Booking ",d+1]},d))]}),t.rental_links?.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"700",color:"#9ca3af",textTransform:"uppercase",marginBottom:"6px"},children:"Rental Cars"}),t.rental_links.map((p,d)=>e.jsxs("a",{href:p,style:{display:"block",color:"#2563eb",fontSize:"13px",marginBottom:"4px",wordBreak:"break-all"},children:["üîó Rental ",d+1]},d))]})]})]}),t.notes&&e.jsxs("div",{style:{marginBottom:"28px"},children:[e.jsx("h2",{style:{fontSize:"14px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",color:"#374151",marginBottom:"12px"},children:"üìù Notes"}),e.jsx("div",{style:{background:"#f9fafb",borderLeft:"3px solid #e5383b",padding:"12px 16px",borderRadius:"4px",fontSize:"14px",lineHeight:"1.6",color:"#374151"},children:t.notes})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"14px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"1px",color:"#374151",marginBottom:"12px"},children:"üé¨ Shot List / Run Sheet"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"#f9fafb"},children:[e.jsx("th",{style:{width:"60px",padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"#"}),e.jsx("th",{style:{width:"80px",padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Time"}),e.jsx("th",{style:{padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Shot / Activity"}),e.jsx("th",{style:{width:"80px",padding:"8px 12px",textAlign:"left",fontSize:"11px",color:"#6b7280",textTransform:"uppercase",borderBottom:"1px solid #e5e7eb"},children:"Done"})]})}),e.jsx("tbody",{children:[1,2,3,4,5,6,7,8].map(p=>e.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[e.jsx("td",{style:{padding:"12px",color:"#9ca3af",fontSize:"13px"},children:p}),e.jsx("td",{style:{padding:"12px"}}),e.jsx("td",{style:{padding:"12px"}}),e.jsx("td",{style:{padding:"12px",textAlign:"center"},children:"‚òê"})]},p))})]})]}),e.jsxs("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:"11px",color:"#9ca3af"},children:["Generated by FIT FOCUS MEDIA Portal ¬∑ ",new Date().toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]}),e.jsx("div",{style:{fontSize:"11px",color:"#9ca3af"},children:"fitfocusmedia.com.au"})]})]})]})]})}function Ht({id:t,children:a,data:s}){const{attributes:i,listeners:l,setNodeRef:y,transform:x,isDragging:j}=Sa({id:t,data:s}),c=x?{transform:`translate3d(${x.x}px, ${x.y}px, 0)`}:void 0;return e.jsx("div",{ref:y,style:c,...l,...i,className:`cursor-grab active:cursor-grabbing ${j?"opacity-50":""}`,children:a})}function br({event:t,children:a,isOver:s}){const{setNodeRef:i}=Ca({id:`event-${t.id}`,data:{event:t}});return e.jsx("div",{ref:i,className:`bg-gray-800/50 rounded-xl border-2 transition-all ${s?"border-orange-500 bg-orange-500/10":"border-gray-700/50"}`,children:a})}function fr({events:t,crewMembers:a,equipment:s,onAssignCrew:i,onUnassignCrew:l,onAssignEquipment:y,onUnassignEquipment:x}){const[j,c]=r.useState(null),[w,z]=r.useState(null),[p,d]=r.useState(null),f=ya(dt(ka,{activationConstraint:{distance:8}}),dt(_a,{activationConstraint:{delay:250,tolerance:5}}),dt(wa)),v=new Date;v.setHours(0,0,0,0);const E=t.filter(u=>new Date(u.date)>=v&&u.status!=="cancelled"&&u.status!=="completed").sort((u,F)=>new Date(u.date)-new Date(F.date));function A(u){c(u.active.id),z(u.active.data.current)}function D(u){d(u.over?.id||null)}function o(u){const{active:F,over:C}=u;if(C&&C.id.toString().startsWith("event-")){const _=C.id.toString().replace("event-",""),T=t.find(g=>g.id===_);if(T&&F.data.current){const{type:g,item:L}=F.data.current;g==="crew"?i(T,L):g==="equipment"&&y(T,L)}}c(null),z(null),d(null)}function N(){c(null),z(null),d(null)}function k(u){return new Date(u+"T00:00:00").toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short"})}return new Set(E.flatMap(u=>u.crew_ids||[])),new Set(E.flatMap(u=>u.equipment_ids||[])),e.jsxs(va,{sensors:f,collisionDetection:ja,onDragStart:A,onDragOver:D,onDragEnd:o,onDragCancel:N,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:["üìÖ Upcoming Events",e.jsx("span",{className:"text-sm font-normal text-gray-400",children:"Drop crew & equipment here"})]}),e.jsxs("div",{className:"space-y-3 max-h-[600px] overflow-y-auto pr-2",children:[E.map(u=>{const F=p===`event-${u.id}`,C=a.filter(T=>(u.crew_ids||[]).includes(T.id)),_=s.filter(T=>(u.equipment_ids||[]).includes(T.id));return e.jsx(br,{event:u,isOver:F,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white",children:u.name}),e.jsx("p",{className:"text-orange-500 text-sm",children:u.client})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-400",children:k(u.date)}),e.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full inline-block mt-1 ${u.status==="confirmed"?"bg-green-500/20 text-green-400":u.status==="tentative"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:u.status})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["üë• Crew (",C.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:C.length===0?e.jsx("span",{className:"text-xs text-gray-600 italic",children:"No crew assigned"}):C.map(T=>e.jsxs("span",{className:"text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded flex items-center gap-1 group",children:[T.name,e.jsx("button",{onClick:()=>l(u,T),className:"opacity-0 group-hover:opacity-100 hover:text-red-400 transition",children:"√ó"})]},T.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["üì∑ Equipment (",_.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:_.length===0?e.jsx("span",{className:"text-xs text-gray-600 italic",children:"No equipment assigned"}):_.map(T=>e.jsxs("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-1 rounded flex items-center gap-1 group",children:[T.name,e.jsx("button",{onClick:()=>x(u,T),className:"opacity-0 group-hover:opacity-100 hover:text-red-400 transition",children:"√ó"})]},T.id))})]})]})},u.id)}),E.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-12",children:"No upcoming events to assign"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:"üë• Crew Pool"}),e.jsxs("div",{className:"space-y-2 max-h-[250px] overflow-y-auto",children:[a.map(u=>e.jsx(Ht,{id:`crew-${u.id}`,data:{type:"crew",item:u},children:e.jsxs("div",{className:"p-2 bg-gray-700/50 rounded-lg border border-gray-600/50 hover:border-green-500/50 transition",children:[e.jsx("div",{className:"font-medium text-white text-sm",children:u.name}),e.jsx("div",{className:"text-xs text-gray-400",children:u.role||"No role"})]})},u.id)),a.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No crew members"})]})]}),e.jsxs("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3 flex items-center gap-2",children:"üì∑ Equipment Pool"}),e.jsxs("div",{className:"space-y-2 max-h-[250px] overflow-y-auto",children:[s.map(u=>e.jsx(Ht,{id:`equip-${u.id}`,data:{type:"equipment",item:u},children:e.jsxs("div",{className:"p-2 bg-gray-700/50 rounded-lg border border-gray-600/50 hover:border-blue-500/50 transition",children:[e.jsx("div",{className:"font-medium text-white text-sm",children:u.name}),e.jsxs("div",{className:"text-xs text-gray-400",children:[u.category," √ó ",u.quantity]})]})},u.id)),s.length===0&&e.jsx("p",{className:"text-gray-500 text-sm text-center py-4",children:"No equipment"})]})]})]})]}),e.jsx(Na,{children:j&&w&&e.jsx("div",{className:`p-2 rounded-lg border shadow-xl ${w.type==="crew"?"bg-green-600 border-green-500":"bg-blue-600 border-blue-500"}`,children:e.jsx("div",{className:"font-medium text-white text-sm",children:w.item.name})})})]})}function yr(){const[t,a]=r.useState([]),[s,i]=r.useState([]),[l,y]=r.useState([]),[x,j]=r.useState(!0),[c,w]=r.useState("grid"),[z,p]=r.useState(null),[d,f]=r.useState("events"),[v,E]=r.useState(!1),[A,D]=r.useState(!1),[o,N]=r.useState(!1),[k,u]=r.useState(null),[F,C]=r.useState(null),[_,T]=r.useState(null),[g,L]=r.useState(null),[O,Y]=r.useState({name:"",client:"",date:"",location:"",status:"tentative",notes:"",crew_ids:[],equipment_ids:[],flight_links:"",accommodation_links:"",rental_links:""}),[B,X]=r.useState({name:"",role:"",phone:"",email:""}),[P,h]=r.useState({name:"",category:"Camera",quantity:1,notes:""}),[$,I]=r.useState("upcoming"),[H,Q]=r.useState(new Date);r.useEffect(()=>{R()},[]);async function R(){j(!0);const[m,W,Z]=await Promise.all([U.from("production_events").select("*").order("date",{ascending:!0}),U.from("crew_members").select("*").order("name"),U.from("equipment_inventory").select("*").order("category, name")]);a(m.data||[]),i(W.data||[]),y(Z.data||[]),j(!1)}const V=new Date;V.setHours(0,0,0,0);const J=t.filter(m=>new Date(m.date)>=V&&m.status!=="cancelled").length,te=t.filter(m=>{const W=new Date(m.date);return W.getMonth()===V.getMonth()&&W.getFullYear()===V.getFullYear()&&m.status!=="cancelled"}).length,ae=t.filter(m=>new Date(m.date)>=V&&(!m.crew_ids||m.crew_ids.length===0)).length,ge=t.filter(m=>{const W=new Date(m.date);return $==="upcoming"?W>=V&&m.status!=="completed"&&m.status!=="cancelled":$==="completed"?m.status==="completed":$==="thisMonth"?W.getMonth()===V.getMonth()&&W.getFullYear()===V.getFullYear():!0});async function pe(m){m.preventDefault();const W={name:O.name,client:O.client,date:O.date,location:O.location,status:O.status,notes:O.notes,crew_ids:O.crew_ids,equipment_ids:O.equipment_ids,flight_links:O.flight_links.split(",").map(Z=>Z.trim()).filter(Boolean),accommodation_links:O.accommodation_links.split(",").map(Z=>Z.trim()).filter(Boolean),rental_links:O.rental_links.split(",").map(Z=>Z.trim()).filter(Boolean)};F?await U.from("production_events").update(W).eq("id",F.id):await U.from("production_events").insert([W]),E(!1),C(null),fe(),R()}async function de(m){confirm("Delete this event? This cannot be undone.")&&(await U.from("production_events").delete().eq("id",m),u(null),R())}function re(m){C(m),Y({name:m.name,client:m.client,date:m.date,location:m.location||"",status:m.status,notes:m.notes||"",crew_ids:m.crew_ids||[],equipment_ids:m.equipment_ids||[],flight_links:(m.flight_links||[]).join(", "),accommodation_links:(m.accommodation_links||[]).join(", "),rental_links:(m.rental_links||[]).join(", ")}),E(!0)}function fe(){Y({name:"",client:"",date:"",location:"",status:"tentative",notes:"",crew_ids:[],equipment_ids:[],flight_links:"",accommodation_links:"",rental_links:""})}async function ce(m){m.preventDefault(),_?await U.from("crew_members").update(B).eq("id",_.id):await U.from("crew_members").insert([B]),D(!1),T(null),X({name:"",role:"",phone:"",email:""}),R()}function ne(m){T(m),X({name:m.name,role:m.role||"",phone:m.phone||"",email:m.email||""}),D(!0)}async function M(m){confirm("Delete this crew member?")&&(await U.from("crew_members").delete().eq("id",m),R())}async function G(m){m.preventDefault(),g?await U.from("equipment_inventory").update(P).eq("id",g.id):await U.from("equipment_inventory").insert([P]),N(!1),L(null),h({name:"",category:"Camera",quantity:1,notes:""}),R()}function n(m){L(m),h({name:m.name,category:m.category||"Camera",quantity:m.quantity||1,notes:m.notes||""}),N(!0)}async function b(m){confirm("Delete this equipment?")&&(await U.from("equipment_inventory").delete().eq("id",m),R())}async function S(m,W,Z){const ee=t.find(oe=>oe.id===m);if(!ee)return;const ue=Z?[...ee.crew_ids||[],W]:(ee.crew_ids||[]).filter(oe=>oe!==W);await U.from("production_events").update({crew_ids:ue}).eq("id",m),R(),k?.id===m&&u({...k,crew_ids:ue})}async function q(m,W,Z){const ee=t.find(oe=>oe.id===m);if(!ee)return;const ue=Z?[...ee.equipment_ids||[],W]:(ee.equipment_ids||[]).filter(oe=>oe!==W);await U.from("production_events").update({equipment_ids:ue}).eq("id",m),R(),k?.id===m&&u({...k,equipment_ids:ue})}function K(m){return new Date(m).toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short"})}function le(m){return new Date(m).toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}function se(m){return(m||[]).map(W=>s.find(Z=>Z.id===W)).filter(Boolean)}function xe(m){return(m||[]).map(W=>l.find(Z=>Z.id===W)).filter(Boolean)}function be(m){const[W,Z,ee]=m.split("-").map(Number),ue=new Date(W,Z-1,ee),oe=new Date;oe.setHours(0,0,0,0);const Ee=Math.round((ue-oe)/(1e3*60*60*24));return Ee===0?"Today":Ee===1?"Tomorrow":Ee<0?`${Math.abs(Ee)}d ago`:`${Ee}d`}const ie={confirmed:"bg-green-500",tentative:"bg-yellow-500",completed:"bg-gray-500",cancelled:"bg-red-500"},he={confirmed:"border-green-500/30",tentative:"border-yellow-500/30",completed:"border-gray-500/30",cancelled:"border-red-500/30"},Te=["Camera","Lens","Audio","Lighting","Support","Monitor","Power","Media","Transport","Other"];function me(){const m=H.getFullYear(),W=H.getMonth(),Z=new Date(m,W,1),ee=new Date(m,W+1,0),ue=Z.getDay(),oe=[];for(let je=ue-1;je>=0;je--){const hs=new Date(m,W,-je);oe.push({date:hs,isCurrentMonth:!1})}for(let je=1;je<=ee.getDate();je++)oe.push({date:new Date(m,W,je),isCurrentMonth:!0});const Ee=42-oe.length;for(let je=1;je<=Ee;je++)oe.push({date:new Date(m,W+1,je),isCurrentMonth:!1});return oe}function Be(m){const W=m.getFullYear(),Z=String(m.getMonth()+1).padStart(2,"0"),ee=String(m.getDate()).padStart(2,"0"),ue=`${W}-${Z}-${ee}`;return t.filter(oe=>oe.date===ue)}return x?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-pulse text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Crew & Logistics"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Manage teams, equipment, and travel for events"})]}),d==="events"&&e.jsxs("button",{onClick:()=>{fe(),C(null),E(!0)},className:"bg-orange-600 hover:bg-orange-700 px-4 py-2.5 rounded-lg font-medium flex items-center justify-center sm:justify-start",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Event"]}),d==="crew"&&e.jsxs("button",{onClick:()=>{T(null),X({name:"",role:"",phone:"",email:""}),D(!0)},className:"bg-green-600 hover:bg-green-700 px-4 py-2.5 rounded-lg font-medium flex items-center justify-center sm:justify-start",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Crew"]}),d==="equipment"&&e.jsxs("button",{onClick:()=>{L(null),h({name:"",category:"Camera",quantity:1,notes:""}),N(!0)},className:"bg-blue-600 hover:bg-blue-700 px-4 py-2.5 rounded-lg font-medium flex items-center justify-center sm:justify-start",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Equipment"]})]}),e.jsxs("div",{className:"flex space-x-1 bg-gray-800/50 rounded-xl p-1 border border-gray-700/50",children:[e.jsxs("button",{onClick:()=>f("events"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2 ${d==="events"?"bg-orange-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx("span",{children:"üìÖ"}),e.jsx("span",{children:"Events"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${d==="events"?"bg-orange-700":"bg-gray-700"}`,children:J})]}),e.jsxs("button",{onClick:()=>f("crew"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2 ${d==="crew"?"bg-green-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx("span",{children:"üë•"}),e.jsx("span",{children:"Crew"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${d==="crew"?"bg-green-700":"bg-gray-700"}`,children:s.length})]}),e.jsxs("button",{onClick:()=>f("equipment"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2 ${d==="equipment"?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx("span",{children:"üì∑"}),e.jsx("span",{children:"Equipment"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${d==="equipment"?"bg-blue-700":"bg-gray-700"}`,children:l.length})]}),e.jsxs("button",{onClick:()=>f("assign"),className:`flex-1 px-4 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2 ${d==="assign"?"bg-purple-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx("span",{children:"üéØ"}),e.jsx("span",{className:"hidden sm:inline",children:"Assign"})]})]}),d==="events"&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-orange-500",children:J}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:"Upcoming Events"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-green-500",children:s.length}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:"Crew Members"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-blue-500",children:l.length}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:"Equipment Items"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700/50",children:[e.jsx("div",{className:`text-2xl sm:text-3xl font-bold ${ae>0?"text-red-500":"text-purple-500"}`,children:ae>0?ae:te}),e.jsx("div",{className:"text-gray-400 text-xs sm:text-sm",children:ae>0?"‚ö†Ô∏è Need Crew":"This Month"})]})]}),d==="events"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center overflow-x-auto pb-2 sm:pb-0 -mx-1 px-1",children:[e.jsx("span",{className:"text-gray-400 text-sm mr-3 whitespace-nowrap",children:"Filter:"}),e.jsx("div",{className:"flex space-x-2",children:[{key:"upcoming",label:"Upcoming"},{key:"all",label:"All"},{key:"thisMonth",label:"This Month"},{key:"completed",label:"Completed"}].map(m=>e.jsx("button",{onClick:()=>I(m.key),className:`px-3 py-1.5 rounded-lg text-sm whitespace-nowrap transition ${$===m.key?"bg-orange-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:m.label},m.key))})]}),e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-800 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>w("grid"),className:`p-2 rounded ${c==="grid"?"bg-gray-700 text-white":"text-gray-400 hover:text-white"}`,title:"Grid View",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx("button",{onClick:()=>w("list"),className:`p-2 rounded ${c==="list"?"bg-gray-700 text-white":"text-gray-400 hover:text-white"}`,title:"List View",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),e.jsx("button",{onClick:()=>w("calendar"),className:`p-2 rounded ${c==="calendar"?"bg-gray-700 text-white":"text-gray-400 hover:text-white"}`,title:"Calendar View",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})]}),c==="grid"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[ge.map(m=>e.jsxs("div",{onClick:()=>u(m),className:`bg-gray-800/50 rounded-xl border ${he[m.status]} p-4 sm:p-5 hover:border-orange-500/50 transition cursor-pointer`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("span",{className:`${ie[m.status]} px-2 py-0.5 rounded text-xs font-medium capitalize`,children:m.status}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:K(m.date)}),e.jsx("div",{className:`text-xs ${new Date(m.date)<V?"text-gray-500":"text-orange-400"}`,children:be(m.date)})]})]}),e.jsx("h3",{className:"font-bold text-white mb-1 line-clamp-1",children:m.name}),e.jsx("p",{className:"text-orange-500 text-sm mb-3",children:m.client}),m.location&&e.jsxs("p",{className:"text-gray-400 text-sm mb-3 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),e.jsx("span",{className:"truncate",children:m.location})]}),e.jsxs("div",{className:"flex items-center flex-wrap gap-2 text-xs",children:[e.jsxs("span",{className:`px-2 py-1 rounded ${(m.crew_ids?.length||0)>0?"bg-green-500/20 text-green-400":"bg-gray-700 text-gray-500"}`,children:["üë• ",m.crew_ids?.length||0," crew"]}),e.jsxs("span",{className:`px-2 py-1 rounded ${(m.equipment_ids?.length||0)>0?"bg-blue-500/20 text-blue-400":"bg-gray-700 text-gray-500"}`,children:["üì∑ ",m.equipment_ids?.length||0," items"]}),(m.flight_links?.length||0)+(m.accommodation_links?.length||0)+(m.rental_links?.length||0)>0&&e.jsx("span",{className:"px-2 py-1 rounded bg-purple-500/20 text-purple-400",children:"‚úàÔ∏è Travel"})]})]},m.id)),ge.length===0&&e.jsx("div",{className:"col-span-full text-center py-12 text-gray-500",children:e.jsx("p",{children:"No events found."})})]}),c==="list"&&e.jsxs("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-gray-800/50",children:e.jsxs("tr",{className:"text-left text-gray-400 text-xs uppercase",children:[e.jsx("th",{className:"px-4 py-3",children:"Date"}),e.jsx("th",{className:"px-4 py-3",children:"Event"}),e.jsx("th",{className:"px-4 py-3 hidden sm:table-cell",children:"Client"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Crew"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Gear"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700/50",children:ge.map(m=>e.jsxs("tr",{onClick:()=>u(m),className:"hover:bg-gray-800/50 cursor-pointer transition",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-white text-sm",children:K(m.date)}),e.jsx("div",{className:`text-xs ${new Date(m.date)<V?"text-gray-500":"text-orange-400"}`,children:be(m.date)})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium text-white",children:m.name}),e.jsx("div",{className:"text-sm text-gray-400 sm:hidden",children:m.client})]}),e.jsx("td",{className:"px-4 py-3 text-orange-500 text-sm hidden sm:table-cell",children:m.client}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`${ie[m.status]} px-2 py-0.5 rounded text-xs font-medium capitalize`,children:m.status})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:`text-sm ${(m.crew_ids?.length||0)>0?"text-green-400":"text-gray-500"}`,children:m.crew_ids?.length||0})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:`text-sm ${(m.equipment_ids?.length||0)>0?"text-blue-400":"text-gray-500"}`,children:m.equipment_ids?.length||0})})]},m.id))})]})}),ge.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No events found."})]}),c==="calendar"&&e.jsxs("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>Q(new Date(H.getFullYear(),H.getMonth()-1)),className:"p-2 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h3",{className:"text-lg font-bold text-white",children:H.toLocaleDateString("en-AU",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:()=>Q(new Date(H.getFullYear(),H.getMonth()+1)),className:"p-2 hover:bg-gray-700 rounded-lg text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(m=>e.jsx("div",{className:"text-center text-xs text-gray-500 py-2 font-medium",children:m},m)),me().map((m,W)=>{const Z=Be(m.date),ee=m.date.toDateString()===new Date().toDateString();return e.jsxs("div",{className:`min-h-[80px] sm:min-h-[100px] p-1 border border-gray-700/30 rounded ${m.isCurrentMonth?"bg-gray-800/30":"bg-gray-900/30"} ${ee?"ring-2 ring-orange-500":""}`,children:[e.jsx("div",{className:`text-xs mb-1 ${m.isCurrentMonth?"text-gray-400":"text-gray-600"} ${ee?"text-orange-500 font-bold":""}`,children:m.date.getDate()}),e.jsxs("div",{className:"space-y-1",children:[Z.slice(0,2).map(ue=>e.jsx("div",{onClick:oe=>{oe.stopPropagation(),u(ue)},className:`text-xs px-1 py-0.5 rounded truncate cursor-pointer ${ie[ue.status]} text-white`,children:ue.name},ue.id)),Z.length>2&&e.jsxs("div",{className:"text-xs text-gray-500 px-1",children:["+",Z.length-2," more"]})]})]},W)})]})]})]}),d==="crew"&&e.jsxs("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-bold text-white",children:"üë• Crew Members"})}),e.jsxs("div",{className:"space-y-2",children:[s.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700/30 rounded-lg hover:bg-gray-700/50 cursor-pointer transition",onClick:()=>ne(m),children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-white",children:m.name}),e.jsx("div",{className:"text-sm text-gray-400 truncate",children:m.role||"No role assigned"})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[m.phone&&e.jsx("a",{href:`tel:${m.phone}`,onClick:W=>W.stopPropagation(),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded",children:"üìû"}),m.email&&e.jsx("a",{href:`mailto:${m.email}`,onClick:W=>W.stopPropagation(),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded",children:"‚úâÔ∏è"}),e.jsx("button",{onClick:W=>{W.stopPropagation(),M(m.id)},className:"p-2 text-red-500/50 hover:text-red-500 hover:bg-red-500/10 rounded",children:"üóëÔ∏è"})]})]},m.id)),s.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:'No crew members yet. Click "Add Crew" to add one.'})]})]}),d==="equipment"&&e.jsxs("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-bold text-white",children:"üì∑ Equipment Inventory"})}),e.jsxs("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:[Te.filter(m=>l.some(W=>W.category===m)).map(m=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2 sticky top-0 bg-gray-800/90 py-1",children:m}),l.filter(W=>W.category===m).map(W=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-700/30 rounded mb-1 hover:bg-gray-700/50 cursor-pointer transition",onClick:()=>n(W),children:[e.jsx("span",{className:"text-white text-sm",children:W.name}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-gray-400",children:["√ó",W.quantity]}),e.jsx("button",{onClick:Z=>{Z.stopPropagation(),b(W.id)},className:"text-red-500/50 hover:text-red-500 text-xs",children:"üóëÔ∏è"})]})]},W.id))]},m)),l.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:'No equipment yet. Click "Add Equipment" to add some.'})]})]}),d==="assign"&&e.jsx(fr,{events:t,crewMembers:s,equipment:l,onAssignCrew:async(m,W)=>{const Z=[...m.crew_ids||[],W.id];await U.from("production_events").update({crew_ids:Z}).eq("id",m.id),a(t.map(ee=>ee.id===m.id?{...ee,crew_ids:Z}:ee))},onUnassignCrew:async(m,W)=>{const Z=(m.crew_ids||[]).filter(ee=>ee!==W.id);await U.from("production_events").update({crew_ids:Z}).eq("id",m.id),a(t.map(ee=>ee.id===m.id?{...ee,crew_ids:Z}:ee))},onAssignEquipment:async(m,W)=>{const Z=[...m.equipment_ids||[],W.id];await U.from("production_events").update({equipment_ids:Z}).eq("id",m.id),a(t.map(ee=>ee.id===m.id?{...ee,equipment_ids:Z}:ee))},onUnassignEquipment:async(m,W)=>{const Z=(m.equipment_ids||[]).filter(ee=>ee!==W.id);await U.from("production_events").update({equipment_ids:Z}).eq("id",m.id),a(t.map(ee=>ee.id===m.id?{...ee,equipment_ids:Z}:ee))}}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-start sm:items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-2xl my-4",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-700 flex items-center justify-between sticky top-0 bg-gray-800 rounded-t-xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:F?"Edit Event":"New Event"}),e.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),e.jsxs("form",{onSubmit:pe,className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name *"}),e.jsx("input",{type:"text",required:!0,value:O.name,onChange:m=>Y({...O,name:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Client *"}),e.jsx("input",{type:"text",required:!0,value:O.client,onChange:m=>Y({...O,client:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Date *"}),e.jsx("input",{type:"date",required:!0,value:O.date,onChange:m=>Y({...O,date:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:O.status,onChange:m=>Y({...O,status:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none",children:[e.jsx("option",{value:"tentative",children:"Tentative"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:O.location,onChange:m=>Y({...O,location:m.target.value}),placeholder:"Venue, City",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("textarea",{rows:"2",value:O.notes,onChange:m=>Y({...O,notes:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Assign Crew"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-32 overflow-y-auto bg-gray-900/50 rounded-lg p-2",children:[s.map(m=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 bg-gray-700/30 rounded cursor-pointer hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:O.crew_ids.includes(m.id),onChange:W=>{const Z=W.target.checked?[...O.crew_ids,m.id]:O.crew_ids.filter(ee=>ee!==m.id);Y({...O,crew_ids:Z})},className:"rounded border-gray-600 text-orange-500 focus:ring-orange-500"}),e.jsx("span",{className:"text-white text-sm",children:m.name})]},m.id)),s.length===0&&e.jsx("p",{className:"text-gray-500 text-sm col-span-2 text-center py-2",children:"No crew members to assign"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Assign Equipment"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-40 overflow-y-auto bg-gray-900/50 rounded-lg p-2",children:[l.map(m=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 bg-gray-700/30 rounded cursor-pointer hover:bg-gray-700/50",children:[e.jsx("input",{type:"checkbox",checked:O.equipment_ids.includes(m.id),onChange:W=>{const Z=W.target.checked?[...O.equipment_ids,m.id]:O.equipment_ids.filter(ee=>ee!==m.id);Y({...O,equipment_ids:Z})},className:"rounded border-gray-600 text-blue-500 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-white truncate",children:m.name})]},m.id)),l.length===0&&e.jsx("p",{className:"text-gray-500 text-sm col-span-2 text-center py-2",children:"No equipment to assign"})]})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-medium text-white mb-3",children:"‚úàÔ∏è Travel & Logistics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Flight Links"}),e.jsx("input",{type:"text",value:O.flight_links,onChange:m=>Y({...O,flight_links:m.target.value}),placeholder:"Comma-separated URLs",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white text-sm focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Accommodation Links"}),e.jsx("input",{type:"text",value:O.accommodation_links,onChange:m=>Y({...O,accommodation_links:m.target.value}),placeholder:"Comma-separated URLs",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white text-sm focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Rental Car Links"}),e.jsx("input",{type:"text",value:O.rental_links,onChange:m=>Y({...O,rental_links:m.target.value}),placeholder:"Comma-separated URLs",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white text-sm focus:border-orange-500 focus:outline-none"})]})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-orange-600 hover:bg-orange-700 rounded-lg font-medium text-white",children:F?"Save Changes":"Create Event"})]})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-start sm:items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-3xl my-4",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-700 flex items-center justify-between sticky top-0 bg-gray-800 rounded-t-xl",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:k.name}),e.jsx("p",{className:"text-orange-500 text-sm",children:k.client})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{p(k),u(null)},className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium flex items-center gap-1",children:"üìã Brief"}),e.jsx("button",{onClick:()=>{re(k),u(null)},className:"px-3 py-1.5 bg-orange-600 hover:bg-orange-700 rounded text-sm font-medium",children:"Edit"}),e.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-white text-2xl leading-none",children:"√ó"})]})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Date"}),e.jsx("p",{className:"font-medium text-white",children:le(k.date)}),e.jsx("p",{className:`text-sm ${new Date(k.date)<V?"text-gray-500":"text-orange-400"}`,children:be(k.date)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Location"}),e.jsx("p",{className:"font-medium text-white",children:k.location||"TBD"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Status"}),e.jsx("p",{children:e.jsx("span",{className:`${ie[k.status]} px-2 py-0.5 rounded text-xs font-medium capitalize`,children:k.status})})]})]}),k.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Notes"}),e.jsx("p",{className:"mt-1 text-gray-300 text-sm",children:k.notes})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h4",{className:"font-medium text-white",children:["üë• Crew (",se(k.crew_ids).length,")"]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:s.map(m=>{const W=(k.crew_ids||[]).includes(m.id);return e.jsxs("div",{onClick:()=>S(k.id,m.id,!W),className:`p-3 rounded-lg cursor-pointer transition flex items-center justify-between ${W?"bg-green-500/20 border border-green-500/50":"bg-gray-700/30 border border-gray-700 hover:border-gray-600"}`,children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white",children:m.name}),e.jsx("span",{className:"text-gray-400 text-sm ml-2",children:m.role})]}),W?e.jsx("span",{className:"text-green-400 text-sm",children:"‚úì Assigned"}):e.jsx("span",{className:"text-gray-500 text-sm",children:"+ Add"})]},m.id)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h4",{className:"font-medium text-white",children:["üì∑ Equipment (",xe(k.equipment_ids).length,")"]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-48 overflow-y-auto",children:l.map(m=>{const W=(k.equipment_ids||[]).includes(m.id);return e.jsxs("div",{onClick:()=>q(k.id,m.id,!W),className:`p-2 rounded-lg cursor-pointer transition flex items-center justify-between ${W?"bg-blue-500/20 border border-blue-500/50":"bg-gray-700/30 border border-gray-700 hover:border-gray-600"}`,children:[e.jsx("span",{className:"text-white text-sm truncate",children:m.name}),W?e.jsx("span",{className:"text-blue-400 text-xs ml-2",children:"‚úì"}):e.jsx("span",{className:"text-gray-500 text-xs ml-2",children:"+"})]},m.id)})})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4",children:[e.jsx("h4",{className:"font-medium text-white mb-4",children:"‚úàÔ∏è Travel & Logistics"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Flights"}),k.flight_links?.length?k.flight_links.map((m,W)=>e.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"block text-blue-400 hover:underline text-sm truncate mt-1",children:["üîó Flight ",W+1]},W)):e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"None added"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Accommodation"}),k.accommodation_links?.length?k.accommodation_links.map((m,W)=>e.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"block text-blue-400 hover:underline text-sm truncate mt-1",children:["üîó Booking ",W+1]},W)):e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"None added"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs uppercase",children:"Rental Cars"}),k.rental_links?.length?k.rental_links.map((m,W)=>e.jsxs("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"block text-blue-400 hover:underline text-sm truncate mt-1",children:["üîó Rental ",W+1]},W)):e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"None added"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-700",children:e.jsx("button",{onClick:()=>de(k.id),className:"px-4 py-2 text-red-500 hover:bg-red-500/10 rounded-lg text-sm",children:"üóëÔ∏è Delete Event"})})]})]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:_?"Edit Crew Member":"Add Crew Member"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),e.jsxs("form",{onSubmit:ce,className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:B.name,onChange:m=>X({...B,name:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Role"}),e.jsx("input",{type:"text",value:B.role,onChange:m=>X({...B,role:m.target.value}),placeholder:"e.g. Camera Operator, Director, Audio",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:B.phone,onChange:m=>X({...B,phone:m.target.value}),placeholder:"0400 000 000",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:B.email,onChange:m=>X({...B,email:m.target.value}),placeholder:"name@email.com",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-orange-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>D(!1),className:"px-4 py-2.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-orange-600 hover:bg-orange-700 rounded-lg font-medium text-white",children:_?"Save Changes":"Add Crew"})]})]})]})}),z&&e.jsx(pr,{event:z,crew:s,equipment:l,onClose:()=>p(null)}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:g?"Edit Equipment":"Add Equipment"}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-white text-2xl leading-none",children:"√ó"})]}),e.jsxs("form",{onSubmit:G,className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Equipment Name *"}),e.jsx("input",{type:"text",required:!0,value:P.name,onChange:m=>h({...P,name:m.target.value}),placeholder:"e.g. Sony FX6",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category"}),e.jsx("select",{value:P.category,onChange:m=>h({...P,category:m.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-blue-500 focus:outline-none",children:Te.map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:P.quantity,onChange:m=>h({...P,quantity:parseInt(m.target.value)||1}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("input",{type:"text",value:P.notes||"",onChange:m=>h({...P,notes:m.target.value}),placeholder:"Serial number, condition, etc.",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2.5 text-white focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),className:"px-4 py-2.5 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-white",children:g?"Save Changes":"Add Equipment"})]})]})]})})]})}const gl=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"}));delete ls.Icon.Default.prototype._getIconUrl;ls.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});function vr({center:t,zoom:a}){const s=As();return r.useEffect(()=>{t&&s.setView(t,a)},[t,a,s]),null}function jr({onMapClick:t}){return Ps({click:a=>{t&&t(a.latlng)}}),null}function Nr({latitude:t,longitude:a,radius:s=50,address:i="",onLocationChange:l,onRadiusChange:y,className:x=""}){const[j,c]=r.useState(i),[w,z]=r.useState(!1),[p,d]=r.useState(null),[f,v]=r.useState([t||-27.4698,a||153.0251]),[E,A]=r.useState(t&&a?[t,a]:null),[D,o]=r.useState(s),N=async()=>{if(j.trim()){z(!0),d(null);try{const C=await(await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(j)}&format=json&limit=1&countrycodes=au`)).json();if(C.length===0){d("Location not found. Try a more specific address.");return}const _=C[0],T=parseFloat(_.lat),g=parseFloat(_.lon);v([T,g]),A([T,g]),l&&l({latitude:T,longitude:g,address:_.display_name})}catch(F){d("Search failed. Please try again."),console.error("Geocoding error:",F)}finally{z(!1)}}},k=F=>{A([F.lat,F.lng]),l&&l({latitude:F.lat,longitude:F.lng,address:""})},u=F=>{const C=parseInt(F.target.value)||50;o(C),y&&y(C)};return r.useEffect(()=>{t&&a&&(v([t,a]),A([t,a]))},[t,a]),r.useEffect(()=>{o(s||50)},[s]),e.jsxs("div",{className:`space-y-4 ${x}`,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search Venue Address"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(es,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",value:j,onChange:F=>c(F.target.value),onKeyDown:F=>F.key==="Enter"&&N(),placeholder:"Enter venue address (e.g., '8 Annerley Rd, Woolloongabba QLD')",className:"w-full pl-10 pr-4 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-500"})]}),e.jsx("button",{type:"button",onClick:N,disabled:w||!j.trim(),className:"px-4 py-2 bg-red-500 hover:bg-red-600 disabled:bg-dark-700 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:w?"Searching...":"Search"})]}),p&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:p}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Or click on the map to manually place the venue marker"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Geo-Blocking Radius: ",D,"km"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"1",max:"200",step:"1",value:D,onChange:u,className:"flex-1 h-2 bg-dark-700 rounded-lg appearance-none cursor-pointer slider"}),e.jsx("input",{type:"number",min:"1",max:"200",value:D,onChange:u,className:"w-20 px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white text-center focus:outline-none focus:border-red-500"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Viewers within this radius will be blocked from purchasing online access"})]}),e.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-dark-700",style:{height:"400px"},children:[e.jsxs(Es,{center:f,zoom:E?11:10,style:{height:"100%",width:"100%"},className:"z-0",children:[e.jsx(Ds,{attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(vr,{center:f,zoom:E?11:10}),e.jsx(jr,{onMapClick:k}),E&&e.jsxs(e.Fragment,{children:[e.jsx($s,{position:E}),e.jsx(Ts,{center:E,radius:(D||50)*1e3,pathOptions:{color:"#e63946",fillColor:"#e63946",fillOpacity:.2,weight:2}})]})]}),!E&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-dark-900/50 pointer-events-none z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(rt,{className:"w-12 h-12 text-gray-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-400",children:"Search for a venue or click on the map"})]})})]}),E&&e.jsxs("div",{className:"p-4 bg-dark-800 rounded-lg border border-dark-700",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"Current Settings"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Latitude:"}),e.jsx("span",{className:"ml-2 text-white font-mono",children:E[0].toFixed(6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Longitude:"}),e.jsx("span",{className:"ml-2 text-white font-mono",children:E[1].toFixed(6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Radius:"}),e.jsxs("span",{className:"ml-2 text-white font-mono",children:[D,"km"]})]})]})]})]})}function wr({event:t,onStatusUpdate:a,compact:s=!1}){const[i,l]=r.useState(!1),[y,x]=r.useState(!1),[j,c]=r.useState(0),[w,z]=r.useState(0),[p,d]=r.useState(!1);r.useEffect(()=>{if(!t?.id)return;const v=async()=>{try{if(t.is_multi_stream){const A=await bt(t.id);if(c(A?.length||0),d(A&&A.length>0),A&&A.length>0){const D=A.filter(N=>N.mux_stream_id);let o=0;for(const N of D)try{const{data:k,error:u}=await U.functions.invoke("mux-stream",{body:{action:"stream-status",mux_stream_id:N.mux_stream_id}});!u&&k?.isLive&&o++}catch(k){console.warn("Stream status check failed:",k)}z(o),x(o>0)}}else{const A=t.mux_stream_id||t.mux_live_stream_id;if(d(!!A||!!t.mux_stream_key),A)try{const{data:D,error:o}=await U.functions.invoke("mux-stream",{body:{action:"stream-status",mux_stream_id:A}});!o&&D&&(x(D.isLive||!1),a&&a(D))}catch(D){console.warn("Single stream status check failed:",D),x(!1)}else x(!1)}}catch(A){console.error("Status check failed:",A)}};v();const E=setInterval(v,3e4);return()=>clearInterval(E)},[t?.id,t?.is_multi_stream,t?.mux_stream_id]);const f=async()=>{l(!0);try{if(t.is_multi_stream){const v=await bt(t.id);if(c(v?.length||0),v&&v.length>0){const E=v.filter(D=>D.mux_stream_id);let A=0;for(const D of E)try{const{data:o,error:N}=await U.functions.invoke("mux-stream",{body:{action:"stream-status",mux_stream_id:D.mux_stream_id}});!N&&o?.isLive&&A++}catch(o){console.warn("Stream status check failed:",o)}z(A),x(A>0)}}else{const v=t.mux_stream_id||t.mux_live_stream_id;if(v){const{data:E,error:A}=await U.functions.invoke("mux-stream",{body:{action:"stream-status",mux_stream_id:v}});!A&&E&&(x(E.isLive||!1),a&&a(E))}}}catch(v){console.error("Manual status check failed:",v)}finally{l(!1)}};return!p&&!t?.mux_stream_key?e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium bg-gray-500/20 text-gray-400 ${s?"":"mr-2"}`,children:[e.jsx(Ls,{className:"w-3 h-3"}),!s&&"No Stream"]}):t?.is_multi_stream?e.jsxs("div",{className:`inline-flex items-center gap-2 ${s?"":"mr-2"}`,children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${y?"bg-red-500 text-white":"bg-purple-500/20 text-purple-400"}`,children:[e.jsx(tt,{className:`w-3 h-3 ${y?"animate-pulse":""}`}),y?`LIVE (${w}/${j})`:`${j} streams`]}),!s&&e.jsx("button",{onClick:f,disabled:i,className:"p-1 text-gray-500 hover:text-white transition-colors disabled:opacity-50",title:"Check stream status",children:e.jsx(De,{className:`w-3.5 h-3.5 ${i?"animate-spin":""}`})})]}):e.jsxs("div",{className:`inline-flex items-center gap-2 ${s?"":"mr-2"}`,children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${y?"bg-red-500 text-white":"bg-yellow-500/20 text-yellow-500"}`,children:[e.jsx(tt,{className:`w-3 h-3 ${y?"animate-pulse":""}`}),y?"LIVE":"Ready"]}),!s&&e.jsx("button",{onClick:f,disabled:i,className:"p-1 text-gray-500 hover:text-white transition-colors disabled:opacity-50",title:"Check stream status",children:e.jsx(De,{className:`w-3.5 h-3.5 ${i?"animate-spin":""}`})})]})}function _r(){const[t,a]=r.useState([]),[s,i]=r.useState([]),[l,y]=r.useState({demo_mode:!1}),[x,j]=r.useState(!0),[c,w]=r.useState(!1),[z,p]=r.useState(null),[d,f]=r.useState("events"),[v,E]=r.useState({funnel:[],blockedLocations:[],recentEvents:[]}),[A,D]=r.useState("all"),[o,N]=r.useState([]),[k,u]=r.useState(!1),[F,C]=r.useState("all");r.useEffect(()=>{_()},[]);const _=async()=>{try{const[h,$,I]=await Promise.all([rs(),Zs(),ea()]);a(h||[]),i($||[]),y(I||{demo_mode:!1}),await T()}catch(h){console.error("Failed to load data:",h)}finally{j(!1)}},T=async(h=null)=>{try{let $=U.from("livestream_funnel_summary").select("*");h&&h!=="all"&&($=$.eq("event_id",h));const{data:I}=await $;let H=U.from("livestream_blocked_locations").select("*").limit(50);h&&h!=="all"&&(H=H.eq("event_id",h));const{data:Q}=await H;let R=U.from("livestream_analytics").select("*").order("created_at",{ascending:!1}).limit(100);h&&h!=="all"&&(R=R.eq("event_id",h));const{data:V}=await R;E({funnel:I||[],blockedLocations:Q||[],recentEvents:V||[]})}catch($){console.error("Failed to load analytics:",$)}},g=async()=>{u(!0);try{const{data:h,error:$}=await U.functions.invoke("mux-assets",{body:{action:"list"}});if($)throw $;N(h?.assets||[])}catch(h){console.error("Failed to load recordings:",h)}finally{u(!1)}},L=async h=>{if(confirm("End this stream? This will finalize the recording."))try{await Le(h,{status:"ended",is_live:!1,ended_at:new Date().toISOString()});const $=t.find(I=>I.id===h);$?.mux_stream_id&&await U.functions.invoke("mux-stream",{body:{action:"disable",stream_id:$.mux_stream_id}}),_()}catch($){console.error("Failed to end stream:",$),alert("Failed to end stream")}},O=async()=>{try{const h=!l.demo_mode,$=await sa({demo_mode:h});$&&y($)}catch(h){console.error("Failed to toggle demo mode:",h),alert("Failed to toggle demo mode: "+h.message)}},Y=async h=>{if(confirm("Delete this event? This cannot be undone."))try{await aa(h),a(t.filter($=>$.id!==h))}catch{alert("Failed to delete event")}},B=s.filter(h=>h.status==="completed").reduce((h,$)=>h+Number($.amount),0),X=s.filter(h=>h.status==="completed").length,P=t.filter(h=>h.status==="live"||h.is_live).length;return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Livestream Events"}),e.jsx("p",{className:"text-gray-400",children:"Manage PPV events and view orders"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:O,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${l.demo_mode?"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30":"bg-dark-800 text-gray-400 border border-dark-700"}`,children:[l.demo_mode?e.jsx(Fs,{className:"w-5 h-5"}):e.jsx(Ms,{className:"w-5 h-5"}),"Demo Mode ",l.demo_mode?"ON":"OFF"]}),e.jsxs("button",{onClick:()=>{p(null),w(!0)},className:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:[e.jsx(_e,{className:"w-5 h-5"}),"New Event"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-dark-900 rounded-xl p-5 border border-dark-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-500/10 rounded-lg",children:e.jsx(Se,{className:"w-6 h-6 text-green-500"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",B.toFixed(2)]}),e.jsx("p",{className:"text-sm text-gray-400",children:"Total Revenue"})]})]})}),e.jsx("div",{className:"bg-dark-900 rounded-xl p-5 border border-dark-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-500/10 rounded-lg",children:e.jsx(We,{className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:X}),e.jsx("p",{className:"text-sm text-gray-400",children:"Total Orders"})]})]})}),e.jsx("div",{className:"bg-dark-900 rounded-xl p-5 border border-dark-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-red-500/10 rounded-lg",children:e.jsx(we,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:t.length}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Total Events (",P," live)"]})]})]})})]}),e.jsx("div",{className:"border-b border-dark-800",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("button",{onClick:()=>f("events"),className:`pb-3 px-1 font-medium transition-colors ${d==="events"?"text-red-500 border-b-2 border-red-500":"text-gray-400 hover:text-white"}`,children:["Events (",t.length,")"]}),e.jsxs("button",{onClick:()=>f("orders"),className:`pb-3 px-1 font-medium transition-colors ${d==="orders"?"text-red-500 border-b-2 border-red-500":"text-gray-400 hover:text-white"}`,children:["Orders (",s.length,")"]}),e.jsxs("button",{onClick:()=>{f("analytics"),T(A)},className:`pb-3 px-1 font-medium transition-colors flex items-center gap-2 ${d==="analytics"?"text-red-500 border-b-2 border-red-500":"text-gray-400 hover:text-white"}`,children:[e.jsx(st,{size:16})," Analytics"]}),e.jsxs("button",{onClick:()=>{f("recordings"),g()},className:`pb-3 px-1 font-medium transition-colors flex items-center gap-2 ${d==="recordings"?"text-red-500 border-b-2 border-red-500":"text-gray-400 hover:text-white"}`,children:[e.jsx(Je,{size:16})," Recordings"]})]})}),d==="events"&&e.jsx("div",{className:"flex gap-2",children:["all","upcoming","live","ended"].map(h=>e.jsx("button",{onClick:()=>C(h),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${F===h?"bg-red-500 text-white":"bg-dark-800 text-gray-400 hover:text-white"}`,children:h.charAt(0).toUpperCase()+h.slice(1)},h))}),d==="events"&&e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No events yet. Create your first event!"}):t.filter(h=>F==="all"?!0:F==="live"?h.is_live||h.status==="live":F==="ended"?h.status==="ended":F==="upcoming"?!h.is_live&&h.status!=="ended"&&new Date(h.start_time)>new Date:!0).map(h=>e.jsx("div",{className:"bg-dark-900 rounded-xl p-5 border border-dark-800",children:e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:h.title}),e.jsx(wr,{event:h,compact:!0}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${h.status==="live"?"bg-red-500 text-white":h.status==="published"?"bg-green-500/20 text-green-500":h.status==="ended"?"bg-gray-500/20 text-gray-400":"bg-yellow-500/20 text-yellow-500"}`,children:h.status||"draft"}),h.category&&e.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded bg-purple-500/20 text-purple-400 flex items-center gap-1",children:[e.jsx(Xt,{className:"w-3 h-3"}),h.category]}),h.vod_enabled&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded bg-blue-500/20 text-blue-400",children:"VOD"})]}),e.jsx("p",{className:"text-gray-400 mb-2",children:h.org_display_name||h.organization}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500",children:[e.jsx("span",{children:new Date(h.start_time).toLocaleDateString("en-AU")}),e.jsx("span",{children:h.venue}),e.jsxs("span",{className:"font-medium text-green-500",children:["$",h.price," AUD"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[h.status!=="ended"&&e.jsx("button",{onClick:async()=>{const $=!h.doors_open;await Le(h.id,{doors_open:$}),_()},className:`p-2 rounded-lg transition-colors ${h.doors_open?"text-green-500 bg-green-500/20 hover:bg-green-500/30":"text-gray-400 hover:text-green-500 hover:bg-dark-800"}`,title:h.doors_open?"Close Doors (block viewers)":"Open Doors (allow viewers)",children:h.doors_open?e.jsx(Os,{className:"w-5 h-5"}):e.jsx(zs,{className:"w-5 h-5"})}),h.status!=="ended"?e.jsx("button",{onClick:async()=>{const $=!h.is_live;await Le(h.id,{is_live:$,status:$?"live":"published"}),_()},className:`p-2 rounded-lg transition-colors ${h.is_live?"text-red-500 bg-red-500/20 hover:bg-red-500/30":"text-gray-400 hover:text-red-500 hover:bg-dark-800"}`,title:h.is_live?"Stop Live":"Go Live",children:e.jsx(tt,{className:"w-5 h-5"})}):e.jsx("span",{className:"p-2 text-gray-600",title:"Event Ended",children:e.jsx(Zt,{className:"w-5 h-5"})}),(h.is_live||h.status==="live"||h.status==="published")&&e.jsx("button",{onClick:()=>L(h.id),className:"p-2 text-gray-400 hover:text-orange-500 hover:bg-dark-800 rounded-lg transition-colors",title:"End & Archive Stream",children:e.jsx(Rs,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`https://fitfocusmedia.com.au/#/live/${h.id}`),alert("Event link copied!")},className:"p-2 text-gray-400 hover:text-white hover:bg-dark-800 rounded-lg transition-colors",title:"Copy Link",children:e.jsx(Me,{className:"w-5 h-5"})}),e.jsx("a",{href:`#/live/${h.id}`,target:"_blank",className:"p-2 text-gray-400 hover:text-white hover:bg-dark-800 rounded-lg transition-colors",title:"View Event Page",children:e.jsx(Re,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{p(h),w(!0)},className:"p-2 text-gray-400 hover:text-white hover:bg-dark-800 rounded-lg transition-colors",title:"Edit",children:e.jsx(Is,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Y(h.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-dark-800 rounded-lg transition-colors",title:"Delete",children:e.jsx(ke,{className:"w-5 h-5"})})]})]})},h.id))}),d==="orders"&&e.jsxs("div",{className:"bg-dark-900 rounded-xl border border-dark-800 overflow-hidden",children:[s.length>0&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-800",children:[e.jsxs("p",{className:"text-sm text-gray-400",children:[s.filter(h=>h.status==="completed").length," completed orders",e.jsxs("span",{className:"text-green-500 ml-2",children:["$",s.filter(h=>h.status==="completed").reduce((h,$)=>h+parseFloat($.amount||0),0).toFixed(2)," total"]})]}),e.jsxs("button",{onClick:()=>{const h=["Order ID","Email","Event","Amount","Status","Date","Payment Method"],$=s.map(V=>[V.id,V.email,V.event?.title||"",V.amount,V.status,new Date(V.created_at).toLocaleString("en-AU"),V.payment_method||"stripe"]),I=[h,...$].map(V=>V.map(J=>`"${J}"`).join(",")).join(`
`),H=new Blob([I],{type:"text/csv"}),Q=URL.createObjectURL(H),R=document.createElement("a");R.href=Q,R.download=`livestream-orders-${new Date().toISOString().slice(0,10)}.csv`,R.click(),URL.revokeObjectURL(Q)},className:"flex items-center gap-2 px-3 py-1.5 bg-dark-800 hover:bg-dark-700 text-gray-300 hover:text-white rounded-lg text-sm transition-colors",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Export CSV"]})]}),s.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No orders yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-dark-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Order"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Event"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Date"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-800",children:s.map(h=>e.jsxs("tr",{className:"hover:bg-dark-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("code",{className:"text-xs text-gray-400",children:h.id.slice(0,8)})}),e.jsx("td",{className:"px-4 py-3 text-white",children:h.email}),e.jsx("td",{className:"px-4 py-3 text-gray-400",children:h.event?.title||"Unknown"}),e.jsxs("td",{className:"px-4 py-3 text-green-500 font-medium",children:["$",h.amount]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${h.status==="completed"?"bg-green-500/20 text-green-500":h.status==="pending"?"bg-yellow-500/20 text-yellow-500":"bg-red-500/20 text-red-500"}`,children:h.payment_method==="demo"?"üß™ Demo":h.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:new Date(h.created_at).toLocaleString("en-AU")})]},h.id))})]})})]}),d==="analytics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-gray-400",children:"Filter by Event:"}),e.jsxs("select",{value:A,onChange:h=>{D(h.target.value),T(h.target.value)},className:"bg-dark-800 border border-dark-700 rounded-lg px-3 py-2 text-white",children:[e.jsx("option",{value:"all",children:"All Events"}),t.map(h=>e.jsx("option",{value:h.id,children:h.title},h.id))]})]}),e.jsxs("div",{className:"bg-dark-900 rounded-xl border border-dark-800 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx($e,{className:"text-red-500"})," Conversion Funnel"]}),v.funnel.length===0?e.jsx("p",{className:"text-gray-400",children:"No analytics data yet. Data will appear after users visit event pages."}):e.jsx("div",{className:"space-y-4",children:v.funnel.map((h,$)=>{const I=t.find(H=>H.id===h.event_id)?.title||"Unknown Event";return e.jsxs("div",{className:"bg-dark-800 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-white mb-3",children:I}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:h.page_views||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Page Views"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:h.geo_blocked||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Geo Blocked"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-500",children:h.geo_passed||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Geo Passed"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-500",children:h.purchase_views||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Saw Checkout"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-purple-500",children:h.checkout_starts||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Started Checkout"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:h.purchases||0}),e.jsx("p",{className:"text-xs text-gray-400",children:"Purchased"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-red-500",children:[h.checkout_conversion_pct||0,"%"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Conversion"})]})]})]},$)})})]}),e.jsxs("div",{className:"bg-dark-900 rounded-xl border border-dark-800 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(rt,{className:"text-yellow-500"})," Blocked User Locations"]}),v.blockedLocations.length===0?e.jsx("p",{className:"text-gray-400",children:"No blocked users yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-dark-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-400",children:"City"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-400",children:"Region"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-400",children:"Country"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-400",children:"Blocked Count"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-400",children:"Avg Distance"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-800",children:v.blockedLocations.map((h,$)=>e.jsxs("tr",{className:"hover:bg-dark-800/50",children:[e.jsx("td",{className:"px-4 py-2 text-white",children:h.city||"‚Äî"}),e.jsx("td",{className:"px-4 py-2 text-gray-400",children:h.region||"‚Äî"}),e.jsx("td",{className:"px-4 py-2 text-gray-400",children:h.country||"‚Äî"}),e.jsx("td",{className:"px-4 py-2 text-yellow-500 font-medium",children:h.blocked_count}),e.jsx("td",{className:"px-4 py-2 text-gray-400",children:h.avg_distance_km?`${h.avg_distance_km}km`:"‚Äî"})]},$))})]})})]}),e.jsxs("div",{className:"bg-dark-900 rounded-xl border border-dark-800 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(st,{className:"text-blue-500"})," Recent Activity (Last 100)"]}),v.recentEvents.length===0?e.jsx("p",{className:"text-gray-400",children:"No recent activity."}):e.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-dark-800 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-400",children:"Time"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-400",children:"Event Type"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-400",children:"Device"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-400",children:"Location"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-400",children:"Accuracy"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-400",children:"Email"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-800",children:v.recentEvents.map((h,$)=>e.jsxs("tr",{className:"hover:bg-dark-800/50",children:[e.jsx("td",{className:"px-3 py-2 text-gray-400 whitespace-nowrap",children:new Date(h.created_at).toLocaleString("en-AU",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${h.event_type==="purchase_complete"?"bg-green-500/20 text-green-500":h.event_type==="geo_blocked"?"bg-yellow-500/20 text-yellow-500":h.event_type==="geo_passed"?"bg-blue-500/20 text-blue-500":h.event_type==="checkout_start"?"bg-purple-500/20 text-purple-500":"bg-gray-500/20 text-gray-400"}`,children:h.event_type})}),e.jsx("td",{className:"px-3 py-2 text-gray-400",children:h.device_type||"‚Äî"}),e.jsx("td",{className:"px-3 py-2 text-gray-400",children:h.latitude&&h.longitude?`${h.latitude.toFixed(4)}, ${h.longitude.toFixed(4)}`:"‚Äî"}),e.jsx("td",{className:"px-3 py-2 text-gray-400",children:h.accuracy_meters?`¬±${Math.round(h.accuracy_meters)}m`:"‚Äî"}),e.jsx("td",{className:"px-3 py-2 text-gray-400",children:h.customer_email||"‚Äî"})]},$))})]})})]})]}),d==="recordings"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-400",children:"Video recordings from your livestreams"}),e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-1.5 bg-dark-800 hover:bg-dark-700 text-gray-300 rounded-lg text-sm transition-colors",children:[e.jsx(De,{className:"w-4 h-4"}),"Refresh"]})]}),k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-500"})}):o.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Je,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No recordings yet."}),e.jsx("p",{className:"text-sm",children:"Recordings appear here after streams end."})]}):e.jsx("div",{className:"grid gap-4",children:o.map(h=>e.jsx("div",{className:"bg-dark-900 rounded-xl p-5 border border-dark-800",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[h.thumbnail_url?e.jsx("img",{src:h.thumbnail_url,alt:"",className:"w-32 h-20 object-cover rounded-lg"}):e.jsx("div",{className:"w-32 h-20 bg-dark-800 rounded-lg flex items-center justify-center",children:e.jsx(Je,{className:"w-8 h-8 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:h.event_title||"Untitled Recording"}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400 mt-1",children:[e.jsx("span",{children:h.duration?`${Math.floor(h.duration/60)}m ${Math.round(h.duration%60)}s`:"‚Äî"}),e.jsx("span",{children:h.created_at?new Date(h.created_at*1e3).toLocaleDateString("en-AU"):"‚Äî"}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${h.status==="ready"?"bg-green-500/20 text-green-500":h.status==="preparing"?"bg-yellow-500/20 text-yellow-500":"bg-gray-500/20 text-gray-400"}`,children:h.status})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:h.playback_id&&h.status==="ready"&&e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`https://stream.mux.com/${h.playback_id}.m3u8`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-dark-800 hover:bg-dark-700 text-gray-300 rounded-lg text-sm transition-colors",children:[e.jsx(Nt,{className:"w-4 h-4"}),"Preview"]}),e.jsxs("a",{href:`https://stream.mux.com/${h.playback_id}/high.mp4`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm transition-colors",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Download MP4"]})]})})]})},h.id))})]}),c&&e.jsx(kr,{event:z,onClose:()=>{w(!1),p(null)},onSave:async h=>{try{let $=z?.id;const{category:I,crew_bypass_token:H,bypass_created_at:Q,geo_venue_address:R,...V}=h;if(V.start_time===""&&(V.start_time=null),V.end_time===""&&(V.end_time=null),V.vod_available_until===""&&(V.vod_available_until=null),(V.vod_price===""||V.vod_price===void 0)&&(V.vod_price=null),(V.price===""||V.price===void 0)&&(V.price=null),z)await Le(z.id,V);else{$=(await ta(V)).id;try{const{data:te,error:ae}=await U.functions.invoke("mux-stream",{body:{action:"create",event_id:$}});if(ae)console.error("MUX stream creation failed:",ae);else if(te?.stream_key){const ge=`Server: ${te.rtmp_url}
Stream Key: ${te.stream_key}`;navigator.clipboard.writeText(te.stream_key).then(()=>{alert(`MUX Stream Created! ‚úÖ

Stream Key copied to clipboard!

For OBS:
‚Ä¢ Server: ${te.rtmp_url}
‚Ä¢ Stream Key: (already copied)

Just paste (Cmd+V) in OBS Stream Key field.`)}).catch(()=>{prompt("MUX Stream Created! Copy this Stream Key:",te.stream_key)})}}catch(te){console.error("MUX stream creation failed:",te)}}await _(),w(!1),p(null)}catch($){console.error("Save event error:",$),alert(`Failed to save event: ${$.message||$}`)}}})]})}function kr({event:t,onClose:a,onSave:s}){const[i,l]=r.useState(t),[y,x]=r.useState({title:t?.title||"",organization:t?.organization||"",organization_id:t?.organization_id||null,venue:t?.venue||"",start_time:t?.start_time?.slice(0,16)||"",end_time:t?.end_time?.slice(0,16)||"",price:t?.price||29.99,description:t?.description||"",category:t?.category||"",thumbnail_url:t?.thumbnail_url||"",player_poster_url:t?.player_poster_url||"",ticket_url:t?.ticket_url||"",vod_enabled:t?.vod_enabled??!0,vod_asset_id:t?.vod_asset_id||"",vod_playback_id:t?.vod_playback_id||"",vod_price:t?.vod_price||"",vod_available_until:t?.vod_available_until||"",status:t?.status||"draft",mux_playback_id:t?.mux_playback_id||"",mux_stream_key:t?.mux_stream_key||"",geo_blocking_enabled:t?.geo_blocking_enabled||!1,geo_lat:t?.geo_lat||null,geo_lng:t?.geo_lng||null,geo_radius_km:t?.geo_radius_km||50,geo_venue_address:t?.geo_venue_address||"",crew_bypass_token:t?.crew_bypass_token||null,bypass_created_at:t?.bypass_created_at||null}),[j,c]=r.useState(!1),[w,z]=r.useState([]),[p,d]=r.useState(!0),f=async()=>{if(t?.id)try{const{data:o,error:N}=await U.from("livestream_events").select("*").eq("id",t.id).single();o&&!N&&(l(o),x(k=>({...k,mux_playback_id:o.mux_playback_id||"",mux_stream_key:o.mux_stream_key||""})))}catch(o){console.error("Failed to reload event:",o)}};r.useEffect(()=>{i?d(!1):(async()=>{try{const N=await ra(),k=await rs(),u=N.map(F=>{const C=k.find(_=>_.title?.toLowerCase().trim()===F.name?.toLowerCase().trim());return{id:`content-${F.id}`,source:"Content",title:F.name,organization:F.org_display_name,organizationId:F.organization_id,venue:C?.venue||F.location||"",geo_venue_address:C?.geo_venue_address||"",date:F.date,status:F.status}});z(u)}catch(N){console.error("Failed to load existing events:",N)}finally{d(!1)}})()},[i]);const v=o=>{const N=k=>k.toString().padStart(2,"0");return`${o.getFullYear()}-${N(o.getMonth()+1)}-${N(o.getDate())}T${N(o.getHours())}:${N(o.getMinutes())}`},E=o=>{if(!o)return;const N=w.find(F=>F.id===o);if(!N)return;let k="",u="";if(N.date){const F=new Date(N.date);isNaN(F.getTime())||(F.setHours(18,0,0,0),k=v(F),F.setHours(22,0,0,0),u=v(F))}x(F=>({...F,title:N.title||F.title,organization:N.organization||F.organization,organization_id:N.organizationId||F.organization_id,venue:N.venue||F.venue,geo_venue_address:N.geo_venue_address||N.venue||F.geo_venue_address,start_time:k||F.start_time,end_time:u||F.end_time}))},A=o=>{if(!o||o.trim()==="")return"";const N=o.trim();return N.startsWith("http://")||N.startsWith("https://")?N:"https://"+N},D=async o=>{o.preventDefault(),c(!0);const N={...y,thumbnail_url:A(y.thumbnail_url),ticket_url:A(y.ticket_url)};await s(N),c(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-dark-900 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-dark-800",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:i?"Edit Event":"Create Event"})}),e.jsxs("form",{onSubmit:D,className:"p-6 space-y-4",children:[!i&&w.length>0&&e.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsxs("label",{className:"block text-sm font-medium text-blue-400 mb-2 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Import from existing event"]}),e.jsxs("select",{onChange:o=>E(o.target.value),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",defaultValue:"",children:[e.jsx("option",{value:"",children:"‚Äî Select to auto-fill ‚Äî"}),w.map(o=>e.jsxs("option",{value:o.id,children:["[",o.source,"] ",o.title," ‚Äî ",o.organization]},o.id))]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:y.title,onChange:o=>x(N=>({...N,title:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Organization (Legal Name) *"}),e.jsx("input",{type:"text",value:y.organization,onChange:o=>x(N=>({...N,organization:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"Queensland Brazilian Jiu Jitsu Circuit Pty Ltd",required:!0})]})]}),e.jsx("p",{className:"text-xs text-gray-500 -mt-2",children:"Display name is set in Content ‚Üí Organizations"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Venue *"}),e.jsx("input",{type:"text",value:y.venue,onChange:o=>x(N=>({...N,venue:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",required:!0})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Start Time *"}),e.jsx("input",{type:"datetime-local",value:y.start_time,onChange:o=>x(N=>({...N,start_time:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"End Time *"}),e.jsx("input",{type:"datetime-local",value:y.end_time,onChange:o=>{const N=o.target.value;let k="";if(N){const u=new Date(N);u.setDate(u.getDate()+7),k=u.toISOString()}x(u=>({...u,end_time:N,vod_available_until:u.vod_available_until||k}))},className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",required:!0})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Price (AUD) *"}),e.jsx("input",{type:"number",step:"0.01",value:y.price,onChange:o=>x(N=>({...N,price:parseFloat(o.target.value)})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:y.status,onChange:o=>x(N=>({...N,status:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"ended",children:"Ended"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Category"}),e.jsxs("select",{value:y.category,onChange:o=>x(N=>({...N,category:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"boxing",children:"Boxing"}),e.jsx("option",{value:"mma",children:"MMA"}),e.jsx("option",{value:"kickboxing",children:"Kickboxing"}),e.jsx("option",{value:"muay-thai",children:"Muay Thai"}),e.jsx("option",{value:"bjj",children:"BJJ / Grappling"}),e.jsx("option",{value:"wrestling",children:"Wrestling"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.vod_enabled,onChange:o=>x(N=>({...N,vod_enabled:o.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-dark-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-red-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-500"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"VOD Replay"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Allow replay after event ends"})]})]})]}),y.vod_enabled&&e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 space-y-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-blue-400 flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4"}),"VOD Replay Settings"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"VOD Price (leave empty = same as live)"}),e.jsx("input",{type:"number",step:"0.01",value:y.vod_price,onChange:o=>x(N=>({...N,vod_price:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"e.g., 19.99"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"VOD Available Until (optional)"}),e.jsx("input",{type:"datetime-local",value:y.vod_available_until?y.vod_available_until.slice(0,16):"",onChange:o=>x(N=>({...N,vod_available_until:o.target.value?new Date(o.target.value).toISOString():""})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"VOD Asset ID (from MUX)"}),e.jsx("input",{type:"text",value:y.vod_asset_id,onChange:o=>x(N=>({...N,vod_asset_id:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"Auto-linked after event ends"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"VOD Playback ID"}),e.jsx("input",{type:"text",value:y.vod_playback_id,onChange:o=>x(N=>({...N,vod_playback_id:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"Auto-linked after event ends"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"VOD assets are automatically created by MUX when the livestream ends. Live ticket purchasers automatically get VOD access."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"MUX Playback ID"}),e.jsx("input",{type:"text",value:y.mux_playback_id,onChange:o=>x(N=>({...N,mux_playback_id:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"Auto-generated on create"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"MUX Stream Key (for OBS)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:y.mux_stream_key,readOnly:!0,className:"flex-1 px-3 py-2 bg-dark-900 border border-dark-700 rounded-lg text-gray-400 font-mono text-sm",placeholder:y.mux_stream_key?"":"Click Generate to create"}),y.mux_stream_key?e.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(y.mux_stream_key),alert("Stream Key copied!")},className:"px-3 py-2 bg-dark-700 hover:bg-dark-600 text-white rounded-lg transition-colors",children:"Copy"}):i?.id&&e.jsx("button",{type:"button",onClick:async()=>{try{const{data:o,error:N}=await U.functions.invoke("mux-stream",{body:{action:"create",event_id:i.id}});if(N){alert("Failed to create stream: "+N.message);return}o?.stream_key&&(x(k=>({...k,mux_stream_key:o.stream_key,mux_playback_id:o.playback_id})),navigator.clipboard.writeText(o.stream_key),alert("MUX Stream created! Stream Key copied to clipboard."))}catch(o){alert("Failed to create stream: "+o.message)}},className:"px-3 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors whitespace-nowrap",children:"Generate"})]}),e.jsx("p",{className:"text-sm text-amber-400 mt-1 font-medium",children:"üì° RTMP Server: rtmps://global-live.mux.com:443/app"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:y.description,onChange:o=>x(N=>({...N,description:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",rows:3})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Thumbnail URL"}),e.jsx("input",{type:"text",value:y.thumbnail_url,onChange:o=>x(N=>({...N,thumbnail_url:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"For event cards"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used on event listing cards"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Player Poster URL"}),e.jsx("input",{type:"text",value:y.player_poster_url,onChange:o=>x(N=>({...N,player_poster_url:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"For video player (optional)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shows before/after stream. Falls back to thumbnail if empty."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Ticket URL"}),e.jsx("input",{type:"text",value:y.ticket_url,onChange:o=>x(N=>({...N,ticket_url:o.target.value})),className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white",placeholder:"www.instagram.com/fitfocusmedia"})]}),e.jsxs("div",{className:"pt-6 border-t border-dark-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Geo-Blocking"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Block online streaming near the venue"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.geo_blocking_enabled,onChange:o=>x(N=>({...N,geo_blocking_enabled:o.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-dark-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-red-500 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-500"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-400",children:y.geo_blocking_enabled?"Enabled":"Disabled"})]})]}),y.geo_blocking_enabled&&e.jsx(Nr,{latitude:y.geo_lat,longitude:y.geo_lng,radius:y.geo_radius_km,address:y.geo_venue_address||y.venue,onLocationChange:({latitude:o,longitude:N,address:k})=>{x({...y,geo_lat:o,geo_lng:N,geo_venue_address:k||y.venue})},onRadiusChange:o=>{x(N=>({...N,geo_radius_km:o}))}}),i?.id&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(pt,{className:"w-5 h-5 text-blue-500"}),e.jsx("h4",{className:"font-semibold text-white",children:"Crew Access"})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Generate a bypass link for crew members at the venue who need to access the stream."}),y.crew_bypass_token?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"üì° Live Stream (for monitoring during event)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:`https://fitfocusmedia.com.au/#/watch/${i.id}?bypass=${y.crew_bypass_token}`,className:"flex-1 px-3 py-2 bg-dark-900 border border-dark-700 rounded-lg text-gray-400 font-mono text-xs"}),e.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(`https://fitfocusmedia.com.au/#/watch/${i.id}?bypass=${y.crew_bypass_token}`),alert("Live stream link copied!")},className:"px-3 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",title:"Copy Link",children:e.jsx(Me,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"üé® Preview Player (for design testing before event)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:`https://fitfocusmedia.com.au/#/watch/${i.id}?bypass=${y.crew_bypass_token}&preview=player`,className:"flex-1 px-3 py-2 bg-dark-900 border border-dark-700 rounded-lg text-gray-400 font-mono text-xs"}),e.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(`https://fitfocusmedia.com.au/#/watch/${i.id}?bypass=${y.crew_bypass_token}&preview=player`),alert("Preview player link copied!")},className:"px-3 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition-colors",title:"Copy Link",children:e.jsx(Me,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-dark-700",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Created: ",y.bypass_created_at?new Date(y.bypass_created_at).toLocaleString("en-AU"):"Unknown"]}),e.jsxs("button",{type:"button",onClick:async()=>{if(!confirm("Regenerate bypass token? Both links will stop working immediately."))return;const o=crypto.randomUUID(),N=new Date().toISOString();await Le(i.id,{crew_bypass_token:o,bypass_created_at:N}),x(k=>({...k,crew_bypass_token:o,bypass_created_at:N})),alert("New bypass token generated!")},className:"flex items-center gap-1 px-3 py-1.5 bg-yellow-600 hover:bg-yellow-500 text-white text-sm rounded-lg transition-colors",children:[e.jsx(De,{className:"w-3 h-3"}),"Regenerate"]})]})]}):e.jsxs("button",{type:"button",onClick:async()=>{const o=crypto.randomUUID(),N=new Date().toISOString();await Le(i.id,{crew_bypass_token:o,bypass_created_at:N}),x(k=>({...k,crew_bypass_token:o,bypass_created_at:N})),navigator.clipboard.writeText(`https://fitfocusmedia.com.au/#/watch/${i.id}?bypass=${o}`),alert("Crew bypass link generated and copied to clipboard!")},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(pt,{className:"w-4 h-4"}),"Generate Crew Bypass Link"]})]})]}),i?.id&&e.jsx(Cr,{eventId:i.id,event:i,onEventUpdate:f}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-800",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:j,className:"px-6 py-2 bg-red-500 hover:bg-red-600 disabled:bg-dark-700 text-white font-medium rounded-lg transition-colors",children:j?"Saving...":i?"Update Event":"Create Event"})]})]})]})})}function Cr({eventId:t,event:a,onEventUpdate:s}){const[i,l]=r.useState([]),[y,x]=r.useState(!0),[j,c]=r.useState(!1),[w,z]=r.useState(!1),[p,d]=r.useState(""),[f,v]=r.useState(""),[E,A]=r.useState(!1),[D,o]=r.useState(null),N=a?.mux_stream_id&&!a?.is_multi_stream;r.useEffect(()=>{k()},[t]);const k=async()=>{try{const g=await bt(t);l(g||[])}catch(g){console.error("Failed to load streams:",g)}finally{x(!1)}},u=async()=>{if(p.trim()){c(!0);try{const g=await fetch("https://gonalgubgldgpkcekaxe.supabase.co/functions/v1/mux-stream/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:p.trim(),event_id:t})});let L=null;g.ok?(L=await g.json(),console.log("MUX stream created:",L)):console.warn("Failed to auto-create MUX stream, creating without MUX");const O={event_id:t,name:p.trim(),display_order:i.length,is_default:i.length===0,...L&&{mux_stream_id:L.mux_stream_id,mux_stream_key:L.mux_stream_key,mux_playback_id:L.mux_playback_id,status:"idle"}};await la(O),i.length===0&&await Rt(t,!0),d(""),await k(),L?.mux_stream_key&&(navigator.clipboard.writeText(L.mux_stream_key),alert(`‚úÖ Stream "${p.trim()}" created!

RTMP Server: rtmps://global-live.mux.com:443/app
Stream Key: ${L.mux_stream_key}

(Stream key copied to clipboard)`))}catch(g){console.error("Failed to add stream:",g),alert("Failed to add stream: "+g.message)}finally{c(!1)}}},F=async g=>{if(confirm("Delete this stream? This cannot be undone."))try{await na(g),i.length<=1&&await Rt(t,!1),await k()}catch(L){console.error("Failed to delete stream:",L),alert("Failed to delete stream")}},C=async g=>{try{const L=await fetch("https://gonalgubgldgpkcekaxe.supabase.co/functions/v1/mux-stream/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:g.name,event_id:t})});if(!L.ok){const Y=await L.json();alert("Failed to create MUX stream: "+(Y.error||"Unknown error"));return}const O=await L.json();O?.mux_stream_key&&(await ot(g.id,{mux_stream_key:O.mux_stream_key,mux_playback_id:O.mux_playback_id,mux_stream_id:O.mux_stream_id,status:"idle"}),navigator.clipboard.writeText(O.mux_stream_key),alert(`‚úÖ Stream Key for ${g.name} created and copied!

Server: rtmps://global-live.mux.com:443/app
Stream Key: ${O.mux_stream_key}`),await k())}catch(L){console.error("Failed to generate stream key:",L),alert("Failed to generate stream key: "+L.message)}},_=async g=>{try{for(const L of i)L.is_default&&await ot(L.id,{is_default:!1});await ot(g,{is_default:!0}),await k()}catch(L){console.error("Failed to set default stream:",L)}},T=async()=>{if(!f.trim()){alert("Please enter a name for the existing stream");return}z(!0);try{const{data:g,error:L}=await U.functions.invoke("mux-stream",{body:{action:"migrate",event_id:t,stream_name:f.trim()}});if(L)throw new Error(L.message||"Migration failed");if(g?.error)throw new Error(g.error);A(!1),v(""),await k(),s&&await s(),alert(`Successfully converted to multi-stream! "${f.trim()}" is now your first stream.`)}catch(g){console.error("Failed to convert to multi-stream:",g),alert("Failed to convert: "+g.message)}finally{z(!1)}};return e.jsxs("div",{className:"pt-6 border-t border-dark-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Multi-Stream"}),i.length>0&&e.jsxs("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 text-xs font-medium rounded-full",children:[i.length," stream",i.length!==1?"s":""]})]})}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Add multiple streams for events with multiple mats/stages. Each stream gets its own OBS stream key."}),N&&i.length===0&&e.jsx("div",{className:"mb-4 p-4 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg",children:e.jsx(Pt,{className:"w-5 h-5 text-amber-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-amber-400 mb-1",children:"Existing Stream Detected"}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"This event has a stream key already generated. To add multiple streams, convert it to multi-stream mode first."}),e.jsxs("button",{type:"button",onClick:()=>A(!0),className:"px-4 py-2 bg-amber-600 hover:bg-amber-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"Convert to Multi-Stream"]})]})]})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-900 rounded-xl border border-dark-700 p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Convert to Multi-Stream"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Name your existing stream. This will become the first stream in multi-stream mode."}),e.jsx("input",{type:"text",value:f,onChange:g=>v(g.target.value),placeholder:"e.g., Main Stage, Mat 1, Ring A",className:"w-full px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white placeholder-gray-500 mb-4",autoFocus:!0}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{A(!1),v("")},className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:T,disabled:w||!f.trim(),className:"px-4 py-2 bg-amber-600 hover:bg-amber-500 disabled:bg-dark-700 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Converting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"w-4 h-4"}),"Convert"]})})]})]})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:p,onChange:g=>d(g.target.value),placeholder:"Stream name (e.g., Mat 1, Main Stage)",className:"flex-1 px-3 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white placeholder-gray-500"}),e.jsxs("button",{type:"button",onClick:u,disabled:j||!p.trim(),className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 disabled:bg-dark-700 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:[j?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}):e.jsx(_e,{className:"w-4 h-4"}),"Add"]})]}),y?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-purple-500 border-t-transparent mx-auto"})}):i.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500 bg-dark-800/50 rounded-lg border border-dashed border-dark-700",children:[e.jsx(Pt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No streams configured yet."}),e.jsx("p",{className:"text-sm",children:"Add streams above for multi-mat/stage events."})]}):e.jsx("div",{className:"space-y-3",children:i.map((g,L)=>e.jsxs("div",{className:`bg-dark-800 rounded-lg border ${g.is_default?"border-purple-500/50":"border-dark-700"} overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-dark-700/50",onClick:()=>o(D===g.id?null:g.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-purple-500/20 rounded-lg",children:e.jsx(tt,{className:"w-4 h-4 text-purple-500"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:g.name}),g.is_default&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 text-xs rounded",children:"Default"}),g.mux_stream_key&&e.jsx("span",{className:"px-2 py-0.5 bg-green-500/20 text-green-400 text-xs rounded",children:"Ready"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:g.mux_stream_key?"Stream key configured":"No stream key yet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!g.is_default&&e.jsx("button",{type:"button",onClick:O=>{O.stopPropagation(),_(g.id)},className:"px-2 py-1 text-xs text-gray-400 hover:text-purple-400 transition-colors",children:"Set Default"}),e.jsx("button",{type:"button",onClick:O=>{O.stopPropagation(),F(g.id)},className:"p-1.5 text-gray-500 hover:text-red-500 transition-colors",children:e.jsx(ke,{className:"w-4 h-4"})})]})]}),D===g.id&&e.jsx("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-dark-700",children:g.mux_stream_key?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Stream Key (for OBS)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:g.mux_stream_key,className:"flex-1 px-3 py-2 bg-dark-900 border border-dark-700 rounded-lg text-gray-400 font-mono text-xs"}),e.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(g.mux_stream_key),alert("Stream key copied!")},className:"px-3 py-2 bg-dark-700 hover:bg-dark-600 text-white rounded-lg transition-colors",children:e.jsx(Me,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Playback ID"}),e.jsx("input",{type:"text",readOnly:!0,value:g.mux_playback_id||"‚Äî",className:"w-full px-3 py-2 bg-dark-900 border border-dark-700 rounded-lg text-gray-400 font-mono text-xs"})]}),e.jsx("p",{className:"text-xs text-amber-400 font-medium",children:"üì° RTMP Server: rtmps://global-live.mux.com:443/app"})]}):e.jsxs("button",{type:"button",onClick:()=>C(g),className:"w-full px-4 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Nt,{className:"w-4 h-4"}),"Generate MUX Stream Key"]})})]},g.id))}),i.length>0&&e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"üí° Viewers will see a stream selector to switch between streams during the event."})]})}const hl=Object.freeze(Object.defineProperty({__proto__:null,default:_r},Symbol.toStringTag,{value:"Module"}));function Sr(){const[t,a]=r.useState(!0),[s,i]=r.useState([]),[l,y]=r.useState([]),[x,j]=r.useState(null),[c,w]=r.useState(!0),[z,p]=r.useState(new Date),[d,f]=r.useState("all"),[v,E]=r.useState("all"),[A,D]=r.useState(!1);r.useEffect(()=>{if(o(),c){const u=setInterval(()=>{o()},3e4);return()=>clearInterval(u)}},[c,d,v]);const o=async()=>{try{a(!0);let u=U.from("livestream_events").select("*, organizations(id, name, display_name)").order("start_time",{ascending:!1});v!=="all"&&(u=u.eq("status",v));const{data:F,error:C}=await u;if(C)throw C;const{data:_,error:T}=await U.from("livestream_orders").select("*").eq("status","completed");if(T)throw T;const g=N(F||[],_||[]);i(F||[]),y(_||[]),j(g),p(new Date)}catch(u){console.error("Failed to load analytics:",u)}finally{a(!1)}},N=(u,F)=>{const C=F.reduce((O,Y)=>O+parseFloat(Y.amount||0),0),_=F.length,T=u.map(O=>{const Y=F.filter(P=>P.event_id===O.id),B=Y.reduce((P,h)=>P+parseFloat(h.amount||0),0),X=Y.length;return{...O,purchases:X,revenue:B,avgOrderValue:X>0?B/X:0}});T.sort((O,Y)=>Y.revenue-O.revenue);const g={};F.forEach(O=>{const Y=new Date(O.created_at).toISOString().split("T")[0];g[Y]=(g[Y]||0)+parseFloat(O.amount||0)});const L=Object.entries(g).sort((O,Y)=>O[0].localeCompare(Y[0])).slice(-30);return{totalRevenue:C,totalPurchases:_,totalEvents:u.length,avgOrderValue:_>0?C/_:0,eventStats:T,dailyRevenue:L}},k=()=>{if(!x)return;const u=[["Event","Organization","Purchases","Revenue","Avg Order Value","Status"].join(","),...x.eventStats.map(T=>[`"${T.title}"`,`"${T.organizations?.display_name||T.organization}"`,T.purchases,`$${T.revenue.toFixed(2)}`,`$${T.avgOrderValue.toFixed(2)}`,T.status].join(","))].join(`
`),F=new Blob([u],{type:"text/csv"}),C=URL.createObjectURL(F),_=document.createElement("a");_.href=C,_.download=`livestream-analytics-${new Date().toISOString().split("T")[0]}.csv`,_.click()};return t&&!x?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-red-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading analytics..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx(st,{className:"w-8 h-8 text-red-500"}),"Livestream Analytics"]}),e.jsx("p",{className:"text-gray-400",children:"Real-time performance metrics and insights"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>D(!A),className:"px-4 py-2 bg-gray-800/50 hover:bg-gray-700/50 rounded-lg text-gray-300 flex items-center gap-2 transition-all border border-gray-700",children:[e.jsx(Yt,{className:"w-4 h-4"}),A?"Hide":"Show"," Filters"]}),e.jsxs("button",{onClick:k,className:"px-4 py-2 bg-gray-800/50 hover:bg-gray-700/50 rounded-lg text-gray-300 flex items-center gap-2 transition-all border border-gray-700",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Export CSV"]}),e.jsxs("button",{onClick:o,disabled:t,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white flex items-center gap-2 transition-all disabled:opacity-50",children:[e.jsx(De,{className:`w-4 h-4 ${t?"animate-spin":""}`}),"Refresh"]})]})]}),A&&e.jsx("div",{className:"mb-6 p-4 bg-gray-800/30 backdrop-blur-md rounded-lg border border-gray-700",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Status"}),e.jsxs("select",{value:v,onChange:u=>E(u.target.value),className:"px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500",children:[e.jsx("option",{value:"all",children:"All Events"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"live",children:"Live"}),e.jsx("option",{value:"ended",children:"Ended"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-400 mb-2 block",children:"Auto-Refresh"}),e.jsx("button",{onClick:()=>w(!c),className:`px-4 py-2 rounded-lg border transition-all ${c?"bg-red-600 border-red-500 text-white":"bg-gray-900 border-gray-700 text-gray-400"}`,children:c?"ON (30s)":"OFF"})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"text-sm text-gray-500 self-end",children:["Last updated: ",z.toLocaleTimeString()]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-500/20 to-red-600/10 backdrop-blur-md rounded-xl p-6 border border-red-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Se,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl",children:"üí∞"})]}),e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["$",x?.totalRevenue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Revenue"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-blue-600/10 backdrop-blur-md rounded-xl p-6 border border-blue-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Bs,{className:"w-8 h-8 text-blue-400"}),e.jsx("span",{className:"text-2xl",children:"üéüÔ∏è"})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:x?.totalPurchases}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Purchases"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-green-600/10 backdrop-blur-md rounded-xl p-6 border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(we,{className:"w-8 h-8 text-green-400"}),e.jsx("span",{className:"text-2xl",children:"üìÖ"})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:x?.totalEvents}),e.jsx("div",{className:"text-sm text-gray-400",children:"Total Events"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-purple-600/10 backdrop-blur-md rounded-xl p-6 border border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx($e,{className:"w-8 h-8 text-purple-400"}),e.jsx("span",{className:"text-2xl",children:"üìä"})]}),e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:["$",x?.avgOrderValue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Avg Order Value"})]})]}),e.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-md rounded-xl border border-gray-700 overflow-hidden mb-8",children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5 text-red-500"}),"Event Performance"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Event"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Organization"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Purchases"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Avg Order"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:x?.eventStats.map(u=>e.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:u.title}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(u.start_time).toLocaleDateString()})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:u.organizations?.display_name||u.organization}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm font-medium text-white",children:u.purchases})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"text-sm font-bold text-green-400",children:["$",u.revenue.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"text-sm text-gray-300",children:["$",u.avgOrderValue.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${u.status==="live"?"bg-green-500/20 text-green-400":u.status==="published"?"bg-blue-500/20 text-blue-400":u.status==="ended"?"bg-gray-500/20 text-gray-400":"bg-yellow-500/20 text-yellow-400"}`,children:u.status})})]},u.id))})]})}),x?.eventStats.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No events found"})]}),e.jsxs("div",{className:"bg-gray-800/30 backdrop-blur-md rounded-xl border border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5 text-red-500"}),"Revenue Trend (Last 30 Days)"]}),x?.dailyRevenue&&x.dailyRevenue.length>0?e.jsx("div",{className:"space-y-2",children:x.dailyRevenue.map(([u,F])=>{const C=Math.max(...x.dailyRevenue.map(T=>T[1])),_=F/C*100;return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-xs text-gray-400 w-24",children:new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx("div",{className:"flex-1 bg-gray-700/30 rounded-full h-8 overflow-hidden relative",children:e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 h-full rounded-full transition-all duration-500 flex items-center px-3",style:{width:`${_}%`},children:F>0&&e.jsxs("span",{className:"text-xs font-medium text-white whitespace-nowrap",children:["$",F.toFixed(2)]})})})]},u)})}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No revenue data available"})]})]})})}const ul=Object.freeze(Object.defineProperty({__proto__:null,default:Sr},Symbol.toStringTag,{value:"Module"})),Er=[{id:"standard",name:"Standard",description:"Single-camera livestream coverage"},{id:"premium",name:"Premium",description:"Multi-camera with graphics package"},{id:"enterprise",name:"Enterprise",description:"Full production with replays & commentary"}],Wt={standard:["Professional single-camera livestream","Basic graphics overlay","YouTube/Facebook streaming","Post-event highlight reel (60-90s)"],premium:["Multi-camera setup (2-3 cameras)","Professional graphics package","Multi-platform streaming","On-screen score/time overlays","Post-event highlight reel (2-3 mins)","Full event replay access"],enterprise:["Full multi-camera production (4+ cameras)","Premium graphics & animations","Live instant replays","Commentary integration","Multi-platform streaming","Athlete social media clips","Full event replay with chapters","Dedicated production manager"]},Dr=["Combat Sports","MMA","Boxing","BJJ/Grappling","Muay Thai/Kickboxing","Bodybuilding/Fitness","Powerlifting","CrossFit","Other"],$r={draft:"bg-gray-500/20 text-gray-300",sent:"bg-blue-500/20 text-blue-300",viewed:"bg-yellow-500/20 text-yellow-300",accepted:"bg-green-500/20 text-green-300",declined:"bg-red-500/20 text-red-300"};function Tr(){const[t,a]=r.useState([]),[s,i]=r.useState(!0),[l,y]=r.useState(null),[x,j]=r.useState(""),[c,w]=r.useState("all"),[z,p]=r.useState(!1),[d,f]=r.useState(null),[v,E]=r.useState(null),[A,D]=r.useState(null),[o,N]=r.useState(!1);r.useEffect(()=>{k()},[]);async function k(){try{i(!0);const L=await ia();a(L||[])}catch(L){console.error("Error loading proposals:",L),y(L.message)}finally{i(!1)}}const u=t.filter(L=>{const O=L.org_name?.toLowerCase().includes(x.toLowerCase())||L.contact_name?.toLowerCase().includes(x.toLowerCase())||L.event_name?.toLowerCase().includes(x.toLowerCase()),Y=c==="all"||L.status===c;return O&&Y});function F(L){const O=`${window.location.origin}/#/proposals/${L}`;navigator.clipboard.writeText(O),E(L),setTimeout(()=>E(null),2e3)}async function C(L,O){try{await ca(L,O),a(Y=>Y.map(B=>B.id===L?{...B,status:O}:B))}catch(Y){console.error("Error updating status:",Y)}}async function _(L){if(confirm("Are you sure you want to delete this proposal?"))try{await xa(L),a(O=>O.filter(Y=>Y.id!==L))}catch(O){console.error("Error deleting proposal:",O)}}async function T(L,O=""){N(!0);try{await ma(L,null,O),a(Y=>Y.map(B=>B.id===L?{...B,status:"sent",sent_at:new Date().toISOString()}:B)),D(null),alert("Email sent successfully!")}catch(Y){console.error("Error sending email:",Y),alert("Failed to send email: "+Y.message)}finally{N(!1)}}const g={total:t.length,sent:t.filter(L=>L.status==="sent").length,viewed:t.filter(L=>L.status==="viewed").length,accepted:t.filter(L=>L.status==="accepted").length,totalViews:t.reduce((L,O)=>L+(O.views||0),0)};return e.jsx("div",{className:"min-h-screen bg-[#0a0a0f] text-white p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Proposal Generator"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Create and manage custom proposals for prospects"})]}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-red-600 to-orange-600 rounded-lg font-medium hover:opacity-90 transition-opacity",children:[e.jsx(_e,{size:20}),"New Proposal"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[e.jsx(Ve,{label:"Total",value:g.total,icon:ze}),e.jsx(Ve,{label:"Sent",value:g.sent,icon:Ke,color:"blue"}),e.jsx(Ve,{label:"Viewed",value:g.viewed,icon:Re,color:"yellow"}),e.jsx(Ve,{label:"Accepted",value:g.accepted,icon:Ne,color:"green"}),e.jsx(Ve,{label:"Total Views",value:g.totalViews,icon:$e,color:"purple"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(es,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search proposals...",value:x,onChange:L=>j(L.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50"})]}),e.jsxs("select",{value:c,onChange:L=>w(L.target.value),className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"viewed",children:"Viewed"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"declined",children:"Declined"})]})]}),s?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading proposals..."}):l?e.jsx("div",{className:"text-center py-12 text-red-400",children:l}):u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ze,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No proposals found"}),e.jsx("button",{onClick:()=>p(!0),className:"mt-4 text-red-400 hover:text-red-300",children:"Create your first proposal"})]}):e.jsx("div",{className:"space-y-4",children:u.map(L=>e.jsx(Ar,{proposal:L,onEdit:()=>f(L),onDelete:()=>_(L.id),onCopyLink:()=>F(L.slug),onStatusChange:O=>C(L.id,O),onSendEmail:()=>D(L),copied:v===L.slug},L.id))}),e.jsx(at,{children:(z||d)&&e.jsx(Pr,{proposal:d,onClose:()=>{p(!1),f(null)},onSave:async L=>{d?await oa(d.id,L):await da(L),k(),p(!1),f(null)}})}),e.jsx(at,{children:A&&e.jsx(Fr,{proposal:A,sending:o,onClose:()=>D(null),onSend:L=>T(A.id,L)})})]})})}function Ve({label:t,value:a,icon:s,color:i="gray"}){const l={gray:"from-gray-600 to-gray-700",blue:"from-blue-600 to-blue-700",yellow:"from-yellow-600 to-yellow-700",green:"from-green-600 to-green-700",purple:"from-purple-600 to-purple-700"};return e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${l[i]}`,children:e.jsx(s,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:a}),e.jsx("p",{className:"text-sm text-gray-400",children:t})]})]})})}function Ar({proposal:t,onEdit:a,onDelete:s,onCopyLink:i,onStatusChange:l,onSendEmail:y,copied:x}){const[j,c]=r.useState(!1);return e.jsx(ye.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white/5 border border-white/10 rounded-xl p-6 hover:border-white/20 transition-colors",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:t.org_name}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${$r[t.status]}`,children:t.status})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400",children:[t.event_name&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(we,{size:14}),t.event_name]}),t.contact_name&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(lt,{size:14}),t.contact_name]}),t.price&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Se,{size:14}),"$",t.price.toLocaleString()]}),t.views>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Re,{size:14}),t.views," view",t.views!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!j),className:"flex items-center gap-1 px-3 py-1.5 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-sm",children:["Status",e.jsx(jt,{size:14})]}),j&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-[#1a1a2e] border border-white/10 rounded-lg shadow-xl z-20 min-w-[120px]",children:["draft","sent","viewed","accepted","declined"].map(w=>e.jsx("button",{onClick:()=>{l(w),c(!1)},className:`w-full text-left px-3 py-2 hover:bg-white/5 text-sm capitalize ${t.status===w?"text-red-400":""}`,children:w},w))})]})]}),t.contact_email&&e.jsx("button",{onClick:y,className:"p-2 bg-white/5 rounded-lg hover:bg-blue-500/20 hover:text-blue-400 transition-colors",title:`Send to ${t.contact_email}`,children:e.jsx(Ke,{size:18})}),e.jsx("button",{onClick:i,className:"p-2 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",title:"Copy proposal link",children:x?e.jsx(Ne,{size:18,className:"text-green-400"}):e.jsx(Me,{size:18})}),e.jsx("a",{href:`/#/proposals/${t.slug}`,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",title:"View proposal",children:e.jsx(Oe,{size:18})}),e.jsx("button",{onClick:a,className:"p-2 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",title:"Edit proposal",children:e.jsx(ut,{size:18})}),e.jsx("button",{onClick:s,className:"p-2 bg-white/5 rounded-lg hover:bg-red-500/20 hover:text-red-400 transition-colors",title:"Delete proposal",children:e.jsx(ke,{size:18})})]})]})})}function Pr({proposal:t,onClose:a,onSave:s}){const[i,l]=r.useState(!1),[y,x]=r.useState("form"),[j,c]=r.useState({org_name:t?.org_name||"",contact_name:t?.contact_name||"",contact_email:t?.contact_email||"",contact_phone:t?.contact_phone||"",event_name:t?.event_name||"",event_date:t?.event_date||"",event_type:t?.event_type||"Combat Sports",package:t?.package||"premium",price:t?.price||"",inclusions:t?.inclusions||Wt.premium,custom_notes:t?.custom_notes||"",status:t?.status||"draft"});function w(v){c(E=>({...E,package:v,inclusions:Wt[v]||[]}))}function z(){c(v=>({...v,inclusions:[...v.inclusions||[],""]}))}function p(v,E){c(A=>({...A,inclusions:A.inclusions.map((D,o)=>o===v?E:D)}))}function d(v){c(E=>({...E,inclusions:E.inclusions.filter((A,D)=>D!==v)}))}async function f(v){v.preventDefault(),l(!0);try{await s({...j,price:j.price?parseFloat(j.price):null,inclusions:j.inclusions.filter(E=>E.trim())})}catch(E){console.error("Error saving proposal:",E),alert("Error saving proposal: "+E.message)}finally{l(!1)}}return e.jsx(ye.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 flex items-stretch z-50",onClick:a,children:e.jsxs(ye.div,{initial:{scale:.98,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.98,opacity:0},onClick:v=>v.stopPropagation(),className:"flex flex-col lg:flex-row w-full h-full",children:[e.jsxs("div",{className:"lg:hidden flex border-b border-white/10 bg-[#12121a]",children:[e.jsx("button",{onClick:()=>x("form"),className:`flex-1 py-3 text-center font-medium ${y==="form"?"text-red-400 border-b-2 border-red-400":"text-gray-400"}`,children:"Edit Form"}),e.jsx("button",{onClick:()=>x("preview"),className:`flex-1 py-3 text-center font-medium ${y==="preview"?"text-red-400 border-b-2 border-red-400":"text-gray-400"}`,children:"Live Preview"})]}),e.jsx("div",{className:`lg:w-1/2 bg-[#12121a] flex flex-col overflow-hidden ${y==="form"?"flex":"hidden lg:flex"}`,children:e.jsxs("form",{onSubmit:f,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"shrink-0 border-b border-white/10 p-4 lg:p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl lg:text-2xl font-bold",children:t?"Edit Proposal":"Create New Proposal"}),e.jsx("button",{type:"button",onClick:a,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:"‚úï"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 lg:p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ts,{size:20,className:"text-red-400"}),"Organization Details"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization Name *"}),e.jsx("input",{type:"text",required:!0,value:j.org_name,onChange:v=>c(E=>({...E,org_name:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",placeholder:"e.g., Inception Fight Series"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Type"}),e.jsx("select",{value:j.event_type,onChange:v=>c(E=>({...E,event_type:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",children:Dr.map(v=>e.jsx("option",{value:v,children:v},v))})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(lt,{size:20,className:"text-red-400"}),"Contact Details"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:j.contact_name,onChange:v=>c(E=>({...E,contact_name:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",placeholder:"John Smith"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:j.contact_email,onChange:v=>c(E=>({...E,contact_email:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",placeholder:"john@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:j.contact_phone,onChange:v=>c(E=>({...E,contact_phone:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",placeholder:"0400 000 000"})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(we,{size:20,className:"text-red-400"}),"Event Details"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{type:"text",value:j.event_name,onChange:v=>c(E=>({...E,event_name:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",placeholder:"e.g., Fight Night 12"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Date"}),e.jsx("input",{type:"date",value:j.event_date,onChange:v=>c(E=>({...E,event_date:v.target.value})),className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50"})]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Se,{size:20,className:"text-red-400"}),"Package & Pricing"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-3 mb-4",children:Er.map(v=>e.jsxs("button",{type:"button",onClick:()=>w(v.id),className:`p-3 rounded-xl border-2 text-left transition-all ${j.package===v.id?"border-red-500 bg-red-500/10":"border-white/10 hover:border-white/20"}`,children:[e.jsx("p",{className:"font-semibold text-sm",children:v.name}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:v.description})]},v.id))}),e.jsxs("div",{className:"max-w-xs",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Price (AUD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",children:"$"}),e.jsx("input",{type:"number",value:j.price,onChange:v=>c(E=>({...E,price:v.target.value})),className:"w-full pl-8 pr-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",placeholder:"0.00",step:"0.01",min:"0"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Leave blank for "Contact for pricing"'})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ge,{size:20,className:"text-red-400"}),"What's Included"]}),e.jsxs("div",{className:"space-y-2",children:[(j.inclusions||[]).map((v,E)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:v,onChange:A=>p(E,A.target.value),className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50 text-sm",placeholder:"Inclusion item..."}),e.jsx("button",{type:"button",onClick:()=>d(E),className:"p-2 text-gray-400 hover:text-red-400",children:e.jsx(ke,{size:18})})]},E)),e.jsxs("button",{type:"button",onClick:z,className:"text-sm text-red-400 hover:text-red-300 flex items-center gap-1",children:[e.jsx(_e,{size:16}),"Add inclusion"]})]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ze,{size:20,className:"text-red-400"}),"Custom Notes"]}),e.jsx("textarea",{value:j.custom_notes,onChange:v=>c(E=>({...E,custom_notes:v.target.value})),rows:3,className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50 resize-none text-sm",placeholder:"Any additional notes or custom terms..."})]}),e.jsxs("section",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:j.status,onChange:v=>c(E=>({...E,status:v.target.value})),className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-red-500/50",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"viewed",children:"Viewed"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"declined",children:"Declined"})]})]})]}),e.jsxs("div",{className:"shrink-0 border-t border-white/10 p-4 lg:p-6 flex justify-end gap-4 bg-[#12121a]",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i||!j.org_name,className:"px-6 py-2 bg-gradient-to-r from-red-600 to-orange-600 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50",children:i?"Saving...":t?"Update Proposal":"Create Proposal"})]})]})}),e.jsxs("div",{className:`lg:w-1/2 bg-[#0a0a0f] flex flex-col overflow-hidden border-l border-white/10 ${y==="preview"?"flex":"hidden lg:flex"}`,children:[e.jsx("div",{className:"shrink-0 border-b border-white/10 p-4 lg:p-6 bg-[#0a0a0f]",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(Re,{size:18}),e.jsx("span",{className:"font-medium",children:"Live Preview"}),e.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"Updates as you type"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Lr,{form:j})})]})]})})}function Lr({form:t}){const a=[{value:"25+",label:"Events",icon:Lt},{value:"4",label:"Countries",icon:Qt},{value:"50K+",label:"Viewers",icon:We},{value:"100%",label:"Satisfaction",icon:Us}];return e.jsxs("div",{className:"min-h-full bg-[#0a0a0f] text-white",children:[e.jsxs("section",{className:"relative py-12 px-6 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-red-600/10 via-transparent to-transparent"}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-red-600/20 rounded-full blur-3xl"}),e.jsxs("div",{className:"max-w-2xl mx-auto text-center relative z-10",children:[e.jsx("p",{className:"text-red-400 font-medium mb-3 tracking-wide text-sm",children:"PREPARED FOR"}),e.jsx("h1",{className:"text-2xl md:text-4xl font-bold mb-4 bg-gradient-to-r from-white via-gray-200 to-gray-400 bg-clip-text text-transparent",children:t.org_name||"Organization Name"}),(t.event_name||t.event_date)&&e.jsxs("p",{className:"text-lg text-gray-300 mb-6",children:[t.event_name||"Event Name",t.event_date&&e.jsxs("span",{className:"text-gray-500",children:[" ‚Ä¢ ",new Date(t.event_date).toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsx("p",{className:"text-sm text-gray-400 max-w-xl mx-auto",children:"Professional livestream production that brings your events to audiences worldwide ‚Äî at zero upfront cost to you."})]})]}),e.jsx("section",{className:"py-4 border-y border-white/10 bg-white/5",children:e.jsx("div",{className:"max-w-4xl mx-auto px-6",children:e.jsx("div",{className:"grid grid-cols-4 gap-4",children:a.map((s,i)=>e.jsxs("div",{className:"text-center",children:[e.jsx(s.icon,{className:"w-4 h-4 mx-auto mb-1 text-red-400"}),e.jsx("p",{className:"text-lg font-bold",children:s.value}),e.jsx("p",{className:"text-xs text-gray-400",children:s.label})]},i))})})}),e.jsx("section",{className:"py-8 px-6",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-gradient-to-br from-white/10 to-white/5 border border-white/20 rounded-2xl p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6 pb-6 border-b border-white/10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium mb-1 text-sm",children:"YOUR PACKAGE"}),e.jsxs("h2",{className:"text-xl font-bold capitalize",children:[t.package||"Custom"," Package"]}),t.event_type&&e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:t.event_type})]}),e.jsx("div",{className:"text-right",children:t.price?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",parseFloat(t.price).toLocaleString()]}),e.jsx("p",{className:"text-xs text-gray-400",children:"AUD"})]}):e.jsx("p",{className:"text-lg font-medium text-gray-300",children:"Contact for pricing"})})]}),t.inclusions&&t.inclusions.filter(s=>s.trim()).length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ge,{className:"text-green-400",size:16}),"What's Included"]}),e.jsx("ul",{className:"grid md:grid-cols-2 gap-2",children:t.inclusions.filter(s=>s.trim()).map((s,i)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(Ne,{className:"w-4 h-4 text-green-400 shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-300",children:s})]},i))})]}),t.custom_notes&&e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2 text-sm",children:"Additional Notes"}),e.jsx("p",{className:"text-gray-300 whitespace-pre-wrap text-sm",children:t.custom_notes})]}),e.jsx("div",{className:"bg-gradient-to-r from-green-600/20 to-emerald-600/20 border border-green-500/30 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(Se,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-green-400 mb-1",children:"Zero Upfront Cost Model"}),e.jsx("p",{className:"text-gray-300 text-xs",children:"FFM operates on a revenue-share model. You pay nothing upfront ‚Äî we earn through pay-per-view ticket sales."})]})]})})]})})}),e.jsx("section",{className:"py-8 px-6 bg-white/5",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-lg font-bold text-center mb-6",children:"How It Works"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{step:"1",title:"We Produce",icon:Lt},{step:"2",title:"Fans Watch",icon:We},{step:"3",title:"You Earn",icon:$e}].map((s,i)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 mx-auto mb-2 bg-gradient-to-br from-red-600 to-orange-600 rounded-xl flex items-center justify-center",children:e.jsx(s.icon,{size:18})}),e.jsx("h3",{className:"text-sm font-semibold",children:s.title})]},i))})]})}),e.jsx("section",{className:"py-8 px-6",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-gradient-to-br from-red-600/20 to-orange-600/20 border border-red-500/30 rounded-2xl p-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Ready to Get Started?"}),e.jsxs("p",{className:"text-gray-300 mb-4 text-sm",children:["Let's discuss how we can bring professional livestream production to ",t.org_name||"your organization","."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-red-600 to-orange-600 rounded-xl font-medium text-sm",children:[e.jsx(et,{size:16}),"0411 934 935"]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white/10 border border-white/20 rounded-xl font-medium text-sm",children:[e.jsx(Ce,{size:16}),"Email Us"]})]}),t.contact_name&&e.jsxs("p",{className:"mt-4 text-xs text-gray-400",children:["Prepared for ",t.contact_name,t.contact_email&&` (${t.contact_email})`]})]})})}),e.jsx("footer",{className:"py-4 px-6 border-t border-white/10 text-center text-gray-400 text-xs",children:e.jsxs("p",{children:["¬© ",new Date().getFullYear()," Fit Focus Media"]})})]})}function Fr({proposal:t,sending:a,onClose:s,onSend:i}){const[l,y]=r.useState("");return e.jsx(ye.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:s,children:e.jsxs(ye.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:x=>x.stopPropagation(),className:"bg-[#12121a] border border-white/10 rounded-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl",children:e.jsx(Ke,{size:24,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Send Proposal"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Email to ",t.contact_email]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-xl p-4",children:[e.jsx("p",{className:"font-semibold",children:t.org_name}),t.event_name&&e.jsx("p",{className:"text-sm text-gray-400",children:t.event_name}),t.price&&e.jsxs("p",{className:"text-lg font-bold text-red-400 mt-2",children:["$",t.price.toLocaleString()," AUD"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Add a personal message (optional)"}),e.jsx("textarea",{value:l,onChange:x=>y(x.target.value),rows:3,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:border-blue-500/50 resize-none text-sm",placeholder:"e.g., Looking forward to working with you on this event..."})]}),t.sent_at&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-yellow-400 bg-yellow-500/10 rounded-lg px-3 py-2",children:[e.jsx(He,{size:16}),"Previously sent ",new Date(t.sent_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:s,className:"flex-1 px-4 py-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>i(l),disabled:a,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{size:18}),"Send Email"]})})]})]})})}const pl=Object.freeze(Object.defineProperty({__proto__:null,default:Tr},Symbol.toStringTag,{value:"Module"}));async function Mr(t,a=1440){return new Promise(s=>{const i=new window.Image;i.onload=()=>{let l=i.width,y=i.height;const x=Math.max(l,y);if(x>a){const v=a/x;l=Math.round(i.width*v),y=Math.round(i.height*v)}const j=document.createElement("canvas");j.width=l,j.height=y;const c=j.getContext("2d");c.drawImage(i,0,0,l,y);const w="FIT FOCUS MEDIA",z=Math.max(l,y),p=Math.max(Math.floor(z/20),40);c.font=`bold ${p}px Arial`,c.textAlign="center",c.save(),c.translate(l/2,y/2),c.rotate(-30*Math.PI/180);const d=p*4,f=p*10;for(let v=-y;v<y*2;v+=d)for(let E=-l;E<l*2;E+=f)c.fillStyle="rgba(0, 0, 0, 0.4)",c.fillText(w,E+2,v+2),c.fillStyle="rgba(255, 255, 255, 0.5)",c.fillText(w,E,v);c.restore(),j.toBlob(v=>s(v),"image/jpeg",.7)},i.src=URL.createObjectURL(t)})}async function Or(t,a=400){return new Promise(s=>{const i=new window.Image;i.onload=()=>{const l=a/i.width,y=document.createElement("canvas");y.width=a,y.height=i.height*l,y.getContext("2d").drawImage(i,0,0,y.width,y.height),y.toBlob(j=>s(j),"image/jpeg",.8)},i.src=URL.createObjectURL(t)})}function zr(){const[t,a]=r.useState([]),[s,i]=r.useState(null),[l,y]=r.useState([]),[x,j]=r.useState(null),[c,w]=r.useState(!0),[z,p]=r.useState(!1),d=new URLSearchParams(window.location.hash.split("?")[1]||""),f=d.get("org"),v=d.get("create")==="true",E=d.get("edit");r.useEffect(()=>{E?A(E):D()},[]);const A=async N=>{try{const{data:k,error:u}=await U.from("galleries").select("*, organizations(*)").eq("id",N).single();if(u||!k){console.error("Gallery not found:",u),w(!1);return}k.organizations&&(i(k.organizations),a([k.organizations])),j(k),w(!1)}catch(k){console.error("Load gallery for edit error:",k),w(!1)}};r.useEffect(()=>{if(v&&s&&!z){p(!0);const N=window.location.hash.replace("&create=true","").replace("?create=true","");window.history.replaceState(null,"",N||"#/portal/galleries")}},[s,v]),r.useEffect(()=>{s&&o(s.id)},[s]);const D=async()=>{try{const{data:N,error:k}=await U.from("organizations").select("*").order("name");if(k)throw k;if(a(N||[]),f&&N){const u=N.find(F=>F.id===f);if(u){i(u);return}}N&&N.length===1&&i(N[0])}catch(N){console.error("Load organizations error:",N)}finally{w(!1)}},o=async N=>{try{const{data:k,error:u}=await U.from("galleries").select(`
          *,
          gallery_photos(count),
          events(id, name)
        `).eq("organization_id",N).order("created_at",{ascending:!1});if(u)throw u;y(k||[])}catch(k){console.error("Load galleries error:",k)}};return x?e.jsx(Br,{gallery:x,organization:s,onBack:()=>{j(null),s&&o(s.id)}}):c?e.jsx("div",{className:"p-8 text-center",children:e.jsx(Fe,{className:"w-8 h-8 text-red-500 animate-spin mx-auto"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("a",{href:s?`/#/portal/content-admin?org=${s.id}`:"/#/portal/content-admin",className:"text-gray-400 hover:text-white transition-colors",title:"Back to Content Admin",children:e.jsx(Ie,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Photo Galleries"}),s&&e.jsxs("span",{className:"text-gray-400 text-lg",children:["‚Äî ",s.display_name||s.name]})]}),s&&e.jsxs("button",{onClick:()=>p(!0),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"}),"New Gallery"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-400 mb-2",children:"Organization"}),e.jsxs("select",{value:s?.id||"",onChange:N=>{const k=t.find(u=>u.id===N.target.value);i(k||null),y([])},className:"w-full md:w-64 bg-dark-700 text-white rounded-lg px-4 py-3 border border-dark-600 focus:border-red-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Organization..."}),t.map(N=>e.jsx("option",{value:N.id,children:N.display_name||N.name},N.id))]})]}),s?l.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(nt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),"No galleries yet for ",s.display_name||s.name]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(N=>e.jsx(Rr,{gallery:N,onClick:()=>j(N)},N.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(ts,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),"Select an organization to manage galleries"]}),z&&s&&e.jsx(Ir,{organization:s,onClose:()=>p(!1),onCreate:N=>{y([N,...l]),p(!1),j(N)}})]})}function Rr({gallery:t,onClick:a}){const s=t.gallery_photos?.[0]?.count||0,i={draft:"bg-yellow-600",published:"bg-green-600",archived:"bg-gray-600"};return e.jsxs("div",{onClick:a,className:"bg-dark-800 rounded-lg overflow-hidden cursor-pointer hover:ring-2 hover:ring-red-500 transition-all",children:[e.jsx("div",{className:"h-40 bg-dark-700 flex items-center justify-center",children:e.jsx(nt,{className:"w-12 h-12 text-gray-600"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`${i[t.status]||"bg-gray-600"} px-2 py-0.5 rounded text-xs text-white`,children:t.status}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[s," photos"]})]}),e.jsx("h3",{className:"text-white font-semibold",children:t.title}),t.events&&e.jsxs("p",{className:"text-gray-400 text-sm mt-1 flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"}),t.events.name]}),e.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["$",(t.price_per_photo/100).toFixed(2)," per photo"]})]})]})}function Ir({organization:t,onClose:a,onCreate:s}){const[i,l]=r.useState([]),[y,x]=r.useState(!0),[j,c]=r.useState({title:"",description:"",event_id:"",price_per_photo:5,package_price:"",package_enabled:!1}),[w,z]=r.useState(!1);r.useEffect(()=>{p()},[t.id]);const p=async()=>{try{const{data:f,error:v}=await U.from("events").select("id, name, date").eq("organization_id",t.id).order("date",{ascending:!1});if(v)throw v;l(f||[])}catch(f){console.error("Load events error:",f)}finally{x(!1)}},d=async f=>{f.preventDefault(),z(!0);try{const v=j.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),{data:E,error:A}=await U.from("galleries").insert({organization_id:t.id,event_id:j.event_id||null,title:j.title,description:j.description,slug:v,price_per_photo:Math.round(j.price_per_photo*100),package_price:j.package_price?Math.round(parseFloat(j.package_price)*100):null,package_enabled:j.package_enabled,status:"draft"}).select().single();if(A)throw A;s(E)}catch(v){console.error("Create gallery error:",v),alert("Failed to create gallery: "+v.message)}finally{z(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-800 rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4",children:["Create Gallery for ",t.display_name||t.name]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:j.title,onChange:f=>c({...j,title:f.target.value}),className:"w-full bg-dark-700 text-white rounded-lg px-4 py-3 border border-dark-600 focus:border-red-500 focus:outline-none",placeholder:"e.g. South East Qld Championship Photos",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 mb-1",children:"Link to Event (Optional)"}),y?e.jsx("div",{className:"text-gray-500 py-2",children:"Loading events..."}):e.jsxs("select",{value:j.event_id,onChange:f=>c({...j,event_id:f.target.value}),className:"w-full bg-dark-700 text-white rounded-lg px-4 py-3 border border-dark-600 focus:border-red-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No specific event (org-wide gallery)"}),i.map(f=>e.jsxs("option",{value:f.id,children:[f.name," (",new Date(f.date).toLocaleDateString(),")"]},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:j.description,onChange:f=>c({...j,description:f.target.value}),className:"w-full bg-dark-700 text-white rounded-lg px-4 py-3 border border-dark-600 focus:border-red-500 focus:outline-none",rows:3,placeholder:"Optional description for the gallery"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 mb-1",children:"Price per Photo ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:j.price_per_photo,onChange:f=>c({...j,price_per_photo:parseFloat(f.target.value)||0}),className:"w-full bg-dark-700 text-white rounded-lg px-4 py-3 border border-dark-600 focus:border-red-500 focus:outline-none"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j.package_enabled,onChange:f=>c({...j,package_enabled:f.target.checked}),className:"w-4 h-4 rounded"}),'Enable "Buy All" Package Deal']})}),j.package_enabled&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 mb-1",children:"Package Price ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:j.package_price,onChange:f=>c({...j,package_price:f.target.value}),className:"w-full bg-dark-700 text-white rounded-lg px-4 py-3 border border-dark-600 focus:border-red-500 focus:outline-none",placeholder:"e.g. 49.99 for all photos"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 bg-dark-600 hover:bg-dark-500 text-white py-3 rounded-lg",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:w||!j.title,className:"flex-1 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 text-white py-3 rounded-lg flex items-center justify-center gap-2",children:[w?e.jsx(Fe,{className:"w-4 h-4 animate-spin"}):null,"Create Gallery"]})]})]})]})})}function Br({gallery:t,organization:a,onBack:s}){const[i,l]=r.useState(t),[y,x]=r.useState([]),[j,c]=r.useState(!0),[w,z]=r.useState(!1),[p,d]=r.useState({current:0,total:0}),[f,v]=r.useState(!1),[E,A]=r.useState(new Set),[D,o]=r.useState(!1),[N,k]=r.useState(""),u=N?y.filter(I=>I.filename.toLowerCase().includes(N.toLowerCase())):y;r.useEffect(()=>{F()},[t.id]);const F=async()=>{try{const{data:I,error:H}=await U.from("gallery_photos").select("*").eq("gallery_id",t.id).order("sort_order",{ascending:!0});if(H)throw H;const Q=await Promise.all((I||[]).map(async R=>{const{data:V}=await U.storage.from("galleries").createSignedUrl(R.thumbnail_path||R.watermarked_path,3600);return{...R,thumbnail_url:V?.signedUrl}}));x(Q)}catch(I){console.error("Load photos error:",I)}finally{c(!1)}},C=async I=>{const H=Array.from(I).filter(V=>V.type.startsWith("image/")&&V.size<=52428800);if(H.length===0)return;z(!0),d({current:0,total:H.length});const Q=[];let R=y.length;for(let V=0;V<H.length;V++){const J=H[V];d({current:V+1,total:H.length});try{const te=crypto.randomUUID(),ae=J.name.split(".").pop()||"jpg",ge=J.name.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9_-]/g,"_"),pe=Date.now(),de=`${ge}_${pe}`,re=await Mr(J),fe=await Or(J),ce=`${t.id}/originals/${de}.${ae}`,ne=`${t.id}/watermarked/${de}_wm.jpg`,M=`${t.id}/thumbnails/${de}_thumb.jpg`,{error:G}=await U.storage.from("galleries").upload(ce,J,{contentType:J.type});if(G)throw new Error(`Original upload failed: ${G.message}`);const{error:n}=await U.storage.from("galleries").upload(ne,re,{contentType:"image/jpeg"});if(n)throw new Error(`Watermarked upload failed: ${n.message}`);const{error:b}=await U.storage.from("galleries").upload(M,fe,{contentType:"image/jpeg"});if(b)throw new Error(`Thumbnail upload failed: ${b.message}`);const S=await new Promise(se=>{const xe=new window.Image;xe.onload=()=>se(xe),xe.src=URL.createObjectURL(J)}),{data:q,error:K}=await U.from("gallery_photos").insert({id:te,gallery_id:t.id,original_path:ce,watermarked_path:ne,thumbnail_path:M,filename:J.name,sort_order:R++,width:S.width,height:S.height,file_size:J.size}).select().single();if(K)throw K;const{data:le}=await U.storage.from("galleries").createSignedUrl(M,3600);Q.push({...q,thumbnail_url:le?.signedUrl})}catch(te){console.error(`Failed to upload ${J.name}:`,te),alert(`Failed to upload ${J.name}: ${te.message}`)}}x([...y,...Q]),z(!1),d({current:0,total:0})},_=async I=>{if(confirm("Delete this photo?"))try{const H=y.find(R=>R.id===I);if(!H)return;const Q=[H.original_path,H.watermarked_path,H.thumbnail_path].filter(Boolean);await U.storage.from("galleries").remove(Q),await U.from("gallery_photos").delete().eq("id",I),x(y.filter(R=>R.id!==I)),A(R=>(R.delete(I),new Set(R)))}catch(H){console.error("Delete photo error:",H)}},T=I=>{A(H=>{const Q=new Set(H);return Q.has(I)?Q.delete(I):Q.add(I),Q})},g=()=>A(new Set(u.map(I=>I.id))),L=()=>A(new Set),O=async()=>{if(E.size!==0&&confirm(`Delete ${E.size} selected photos?`)){o(!0);try{const I=y.filter(R=>E.has(R.id)),H=I.flatMap(R=>[R.original_path,R.watermarked_path,R.thumbnail_path].filter(Boolean));await U.storage.from("galleries").remove(H);const Q=I.map(R=>R.id);await U.from("gallery_photos").delete().in("id",Q),x(y.filter(R=>!E.has(R.id))),A(new Set)}catch(I){console.error("Delete selected error:",I),alert("Failed to delete some photos")}finally{o(!1)}}},Y=async I=>{try{const{data:H,error:Q}=await U.from("galleries").update(I).eq("id",t.id).select().single();if(Q)throw Q;l(H)}catch(H){console.error("Update gallery error:",H)}},B=()=>Y({status:"published",published_at:new Date().toISOString()}),X=()=>Y({status:"draft"}),P=I=>{I.preventDefault(),v(!1),I.dataTransfer.files&&C(I.dataTransfer.files)},h=I=>{I.preventDefault(),v(!0)},$=()=>{v(!1)};return j?e.jsx("div",{className:"p-8 text-center",children:e.jsx(Fe,{className:"w-8 h-8 text-red-500 animate-spin mx-auto"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ie,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:i.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:a.display_name||a.name})]}),e.jsx("span",{className:`px-2 py-1 rounded text-sm ${i.status==="published"?"bg-green-600":"bg-yellow-600"} text-white`,children:i.status})]}),e.jsx("div",{className:"flex gap-3",children:i.status==="draft"?e.jsxs("button",{onClick:B,disabled:y.length===0,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Publish"]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:X,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg",children:"Unpublish"}),e.jsxs("a",{href:`/#/gallery/${i.slug}`,target:"_blank",rel:"noopener noreferrer",className:"bg-dark-600 hover:bg-dark-500 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4"}),"View Public"]})]})})]}),e.jsxs("div",{onDrop:P,onDragOver:h,onDragLeave:$,className:`border-2 border-dashed rounded-xl p-8 mb-6 text-center cursor-pointer transition-colors ${f?"border-red-500 bg-red-500/10":"border-dark-600 hover:border-dark-500"} ${w?"opacity-50 pointer-events-none":""}`,onClick:()=>!w&&document.getElementById("photo-upload")?.click(),children:[e.jsx("input",{id:"photo-upload",type:"file",multiple:!0,accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:I=>I.target.files&&C(I.target.files)}),w?e.jsxs("div",{children:[e.jsx(Fe,{className:"w-8 h-8 text-red-500 animate-spin mx-auto mb-2"}),e.jsxs("div",{className:"text-white mb-2",children:["Uploading ",p.current," of ",p.total,"..."]}),e.jsx("div",{className:"w-64 mx-auto bg-dark-700 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all",style:{width:`${p.current/p.total*100}%`}})})]}):f?e.jsxs("div",{className:"text-red-400",children:[e.jsx(Ft,{className:"w-8 h-8 mx-auto mb-2"}),"Drop photos here..."]}):e.jsxs("div",{children:[e.jsx(Ft,{className:"w-8 h-8 text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-300 mb-1",children:"Drag & drop photos here, or click to select"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"JPEG, PNG, WebP up to 50MB each"})]})]}),y.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(nt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),"No photos yet. Upload some photos to get started!"]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-[300px]",children:[e.jsx("input",{type:"text",placeholder:"Search by filename...",value:N,onChange:I=>k(I.target.value),className:"w-full bg-dark-700 text-white rounded-lg px-3 py-1.5 pl-9 text-sm border border-dark-600 focus:border-red-500 focus:outline-none"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),N&&e.jsx("button",{onClick:()=>k(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:"‚úï"})]}),N&&e.jsxs("span",{className:"text-gray-400 text-sm",children:[u.length," of ",y.length]}),e.jsx("button",{onClick:E.size===u.length?L:g,className:"px-3 py-1.5 bg-dark-600 hover:bg-dark-500 text-white text-sm rounded-lg",children:E.size===u.length&&u.length>0?"Deselect All":"Select All"}),E.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400 text-sm",children:[E.size," selected"]}),e.jsxs("button",{onClick:O,disabled:D,className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 text-white text-sm rounded-lg flex items-center gap-2",children:[D?e.jsx(Fe,{className:"w-3 h-3 animate-spin"}):e.jsx(ke,{className:"w-3 h-3"}),"Delete Selected"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:u.map(I=>e.jsxs("div",{className:`relative group cursor-pointer ${E.has(I.id)?"ring-2 ring-red-500":""}`,onClick:()=>T(I.id),children:[e.jsx("img",{src:I.thumbnail_url,alt:I.filename,className:"w-full aspect-square object-cover rounded-lg bg-dark-700"}),e.jsx("div",{className:`absolute top-2 left-2 w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${E.has(I.id)?"bg-red-500 border-red-500":"border-white/50 bg-black/30 group-hover:border-white"}`,children:E.has(I.id)&&e.jsx(Ne,{className:"w-3 h-3 text-white"})}),e.jsx("button",{onClick:H=>{H.stopPropagation(),_(I.id)},className:"absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white p-1.5 rounded opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ke,{className:"w-3 h-3"})}),e.jsx("div",{className:"absolute bottom-1 left-1 right-1 text-xs text-white truncate bg-black/50 px-1 rounded",children:I.filename})]},I.id))})]}),e.jsxs("div",{className:"mt-8 bg-dark-800 rounded-xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Gallery Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Price per Photo ($)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",defaultValue:(i.price_per_photo/100).toFixed(2),onBlur:I=>{const H=Math.round(parseFloat(I.target.value||0)*100);Y({price_per_photo:H}),l({...i,price_per_photo:H})},className:"w-full bg-dark-700 text-white rounded-lg px-3 py-2 border border-dark-600 focus:border-red-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-gray-400 text-sm mb-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.package_enabled||!1,onChange:I=>{Y({package_enabled:I.target.checked}),l({...i,package_enabled:I.target.checked})},className:"w-4 h-4 rounded"}),'Enable "Buy All" Package']}),i.package_enabled&&e.jsx("input",{type:"number",step:"0.01",min:"0",placeholder:"Package price",defaultValue:i.package_price?(i.package_price/100).toFixed(2):"",onBlur:I=>{const H=Math.round(parseFloat(I.target.value||0)*100);Y({package_price:H}),l({...i,package_price:H})},className:"w-full bg-dark-700 text-white rounded-lg px-3 py-2 border border-dark-600 focus:border-red-500 focus:outline-none mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Total Photos"}),e.jsx("div",{className:"text-white text-lg font-semibold py-2",children:y.length})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-1",children:"Public URL"}),e.jsxs("div",{className:"text-white text-sm py-2 break-all",children:["/gallery/",i.slug]})]})]}),e.jsx(Ur,{gallery:i,onUpdate:I=>{Y(I),l({...i,...I})}})]})]})}function Ur({gallery:t,onUpdate:a}){const[s,i]=r.useState(t.pricing_tiers||[]),[l,y]=r.useState(t.tiered_pricing_enabled||!1),[x,j]=r.useState(!1),[c,w]=r.useState(!1),z=()=>{const A=s[s.length-1],D=A?(A.max_qty||A.min_qty)+1:1;i([...s,{min_qty:D,max_qty:D+9,price_per_photo:t.price_per_photo}]),w(!0)},p=(A,D,o)=>{const N=[...s];N[A]={...N[A],[D]:o},i(N),w(!0)},d=A=>{i(s.filter((D,o)=>o!==A)),w(!0)},f=async()=>{j(!0);try{const A=s.map(D=>({min_qty:parseInt(D.min_qty)||1,max_qty:D.max_qty?parseInt(D.max_qty):null,price_per_photo:parseInt(D.price_per_photo)||t.price_per_photo}));await a({pricing_tiers:A,tiered_pricing_enabled:l}),w(!1)}catch(A){console.error("Save tiers error:",A),alert("Failed to save pricing tiers")}finally{j(!1)}},v=()=>{y(!l),w(!0)},E=A=>{if(!l||s.length===0)return A*t.price_per_photo;let D=A,o=0;const N=[...s].sort((k,u)=>k.min_qty-u.min_qty);for(const k of N){if(D<=0)break;const u=k.max_qty||1/0,F=u===1/0?D:u-k.min_qty+1,C=Math.min(D,F);o+=C*k.price_per_photo,D-=C}return D>0&&(o+=D*t.price_per_photo),o};return e.jsxs("div",{className:"border-t border-dark-600 pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-md font-semibold text-white flex items-center gap-2",children:"üìä Volume Discount Tiers"}),e.jsx("button",{onClick:v,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${l?"bg-green-600 hover:bg-green-700 text-white":"bg-dark-600 hover:bg-dark-500 text-gray-300"}`,children:l?"‚úì Enabled":"Enable Discounts"})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Set volume discounts that automatically apply when customers buy more photos. Pricing is incremental (first 10 at tier 1 price, next 10 at tier 2, etc.)"}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-4",children:s.map((A,D)=>e.jsxs("div",{className:"flex items-center gap-3 bg-dark-700 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"From Qty"}),e.jsx("input",{type:"number",min:"1",defaultValue:A.min_qty,onBlur:o=>p(D,"min_qty",parseInt(o.target.value)||1),className:"w-full bg-dark-600 text-white rounded px-3 py-2 text-sm border border-dark-500 focus:border-red-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"To Qty (blank=‚àû)"}),e.jsx("input",{type:"number",min:"1",defaultValue:A.max_qty||"",placeholder:"‚àû",onBlur:o=>p(D,"max_qty",o.target.value?parseInt(o.target.value):null),className:"w-full bg-dark-600 text-white rounded px-3 py-2 text-sm border border-dark-500 focus:border-red-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Price per Photo"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-gray-400",children:"$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",defaultValue:(A.price_per_photo/100).toFixed(2),onBlur:o=>p(D,"price_per_photo",Math.round(parseFloat(o.target.value||0)*100)),className:"w-full bg-dark-600 text-white rounded pl-7 pr-3 py-2 text-sm border border-dark-500 focus:border-red-500 focus:outline-none"})]})]})]}),e.jsx("button",{onClick:()=>d(D),className:"text-red-400 hover:text-red-300 p-2",title:"Remove tier",children:e.jsx(ke,{className:"w-4 h-4"})})]},`tier-${D}-${A.min_qty}`))}),e.jsxs("button",{onClick:z,className:"text-red-400 hover:text-red-300 text-sm flex items-center gap-1 mb-4",children:[e.jsx(_e,{className:"w-4 h-4"})," Add Tier"]}),s.length>0&&e.jsxs("div",{className:"bg-dark-700 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-white mb-2",children:"Preview Calculator"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 text-sm",children:(()=>{const A=new Set;s.forEach(o=>{A.add(o.min_qty),o.max_qty&&(A.add(o.max_qty),A.add(o.max_qty+1))});const D=Math.max(...s.map(o=>o.max_qty||o.min_qty+20));return A.add(Math.ceil(D/2)),A.add(D),A.add(D+10),[...A].sort((o,N)=>o-N).slice(0,8).map(o=>{const N=E(o),u=o*t.price_per_photo-N;return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-gray-400",children:[o," photos"]}),e.jsxs("div",{className:"text-white font-medium",children:["$",(N/100).toFixed(2)]}),u>0&&e.jsxs("div",{className:"text-green-400 text-xs",children:["Save $",(u/100).toFixed(2)]})]},o)})})()})]})]}),l&&e.jsxs("button",{onClick:f,disabled:x||!c,className:`px-4 py-2 rounded-lg flex items-center gap-2 ${c?"bg-red-600 hover:bg-red-700 text-white":"bg-dark-600 text-gray-400 cursor-not-allowed"}`,children:[x?e.jsx(Fe,{className:"w-4 h-4 animate-spin"}):e.jsx(Ne,{className:"w-4 h-4"}),c?"Save Pricing":"Saved ‚úì"]})]})}const bl=Object.freeze(Object.defineProperty({__proto__:null,default:zr},Symbol.toStringTag,{value:"Module"}));export{Kr as A,Zr as C,bl as G,Jr as L,nl as O,Qr as P,Xr as a,el as b,tl as c,sl as d,al as e,rl as f,ll as g,il as h,ol as i,dl as j,cl as k,xl as l,ml as m,gl as n,hl as o,ul as p,pl as q};
