import{c as J,j as e,A as Y,aX as K,i as Q,Q as V,m as $,H as c,k as P,D as X,aZ as Z,a_ as q,b5 as E,b6 as ee}from"./index-Bz4mH0bH.js";import{f as te,h as se,b as u}from"./vendor-react-q0iRXJvs.js";import{T as ae}from"./trash-2-DC1HA86d.js";import{C as y}from"./circle-check-UQ01o5uA.js";import{F as re}from"./file-text-S9uhpBRp.js";import{C as ne}from"./circle-alert-C8AoczGh.js";import"./vendor-supabase-DhDedaeW.js";const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],z=J("circle",le),D="ffm_onboarding_workflows";function oe(n,r){if(n.completed)return"complete";if(n.inProgress)return"in-progress";const t=new Date;t.setHours(0,0,0,0);const i=new Date(r);return i.setHours(0,0,0,0),i<t?"overdue":"pending"}function C(){const n=localStorage.getItem(D);return n?JSON.parse(n):[]}function T(n){return C().find(t=>t.id===n)}function k(n,r,t){const i=C(),l=i.find(g=>g.id===n);return l?(l.steps[r]={...l.steps[r],...t},t.completed&&!l.steps[r].completedDate&&(l.steps[r].completedDate=new Date().toISOString().split("T")[0]),l.steps.every(g=>g.completed)&&l.status==="active"&&(l.status="completed"),localStorage.setItem(D,JSON.stringify(i)),l):null}function ie(n){const t=C().filter(i=>i.id!==n);return localStorage.setItem(D,JSON.stringify(t)),!0}function de(n){const r=T(n);return r?`
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Onboarding Checklist - ${r.orgName}</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
    h1 { color: #e51d1d; }
    .header { border-bottom: 2px solid #e51d1d; padding-bottom: 20px; margin-bottom: 30px; }
    .info { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 30px; }
    .phase { margin-bottom: 40px; }
    .phase-title { background: #f5f5f5; padding: 10px; font-weight: bold; margin-bottom: 15px; }
    .step { margin-bottom: 25px; padding-left: 30px; position: relative; }
    .step-number { position: absolute; left: 0; font-weight: bold; }
    .checkbox { display: inline-block; width: 18px; height: 18px; border: 2px solid #333; margin-right: 10px; }
    .subtasks { margin-top: 10px; padding-left: 20px; font-size: 0.9em; color: #666; }
    .subtasks li { margin-bottom: 5px; }
  </style>
</head>
<body>
  <div class="header">
    <h1>Client Onboarding Checklist</h1>
    <div class="info">
      <div><strong>Organization:</strong> ${r.orgName}</div>
      <div><strong>Contact:</strong> ${r.contactName}</div>
      <div><strong>Email:</strong> ${r.email}</div>
      <div><strong>Phone:</strong> ${r.phone}</div>
      <div><strong>Sport:</strong> ${r.sport}</div>
      <div><strong>First Event:</strong> ${r.firstEventDate}</div>
      <div><strong>Signing Date:</strong> ${r.signingDate}</div>
      <div><strong>Generated:</strong> ${new Date().toLocaleDateString()}</div>
    </div>
  </div>
  
  ${[1,2,3].map(i=>`
    <div class="phase">
      <div class="phase-title">
        ${i===1?"Phase 1: Welcome & Setup":i===2?"Phase 2: Pre-Event Prep":"Phase 3: Go-Live"}
      </div>
      ${r.steps.filter(l=>l.phase===i).map(l=>`
        <div class="step">
          <span class="step-number">${l.id}.</span>
          <div>
            <div><span class="checkbox">☐</span><strong>${l.title}</strong> (Due: ${l.dueDate})</div>
            <div style="color: #666; margin-top: 5px;">${l.description}</div>
            ${l.subTasks&&l.subTasks.length>0?`
              <ul class="subtasks">
                ${l.subTasks.map(x=>`<li>${x}</li>`).join("")}
              </ul>
            `:""}
          </div>
        </div>
      `).join("")}
    </div>
  `).join("")}
</body>
</html>
  `:null}function je(){const{id:n}=te(),r=se(),[t,i]=u.useState(null),[l,x]=u.useState(null),[g,f]=u.useState(!1);u.useEffect(()=>{O()},[n]);const O=()=>{const s=T(n);s?i(s):r("/portal/onboarding")},I=s=>{const o=t.steps[s],d=k(n,s,{completed:!o.completed,completedDate:o.completed?null:new Date().toISOString().split("T")[0]});i(d)},A=s=>{const o=t.steps[s],d=k(n,s,{inProgress:!o.inProgress});i(d)},L=(s,o)=>{const d=k(n,s,{notes:o});i(d)},U=()=>{ie(n),r("/portal/onboarding")},M=()=>{const s=de(n),o=new Blob([s],{type:"text/html"}),d=URL.createObjectURL(o),a=document.createElement("a");a.href=d,a.download=`onboarding-${t.orgName.replace(/\s+/g,"-")}.html`,a.click(),URL.revokeObjectURL(d)},_=()=>{const s=t.steps.findIndex(o=>!o.completed);s!==-1&&(x(s),document.getElementById(`step-${s}`)?.scrollIntoView({behavior:"smooth",block:"center"}))};if(!t)return null;const j=t.steps.filter(s=>s.completed).length,v=t.steps.length,N=Math.round(j/v*100),S=s=>t.steps.filter(o=>o.phase===s),F=s=>{const o=S(s),d=o.filter(a=>a.completed).length;return{completed:d,total:o.length,percentage:Math.round(d/o.length*100)}},H={1:"Welcome & Setup",2:"Pre-Event Prep",3:"Go-Live"},R=s=>{switch(s){case"complete":return"text-green-400 bg-green-600/20 border-green-500/30";case"overdue":return"text-red-400 bg-red-600/20 border-red-500/30";case"in-progress":return"text-yellow-400 bg-yellow-600/20 border-yellow-500/30";default:return"text-gray-400 bg-gray-800/30 border-gray-700/30"}},G=s=>{switch(s){case"complete":return e.jsx(y,{size:18,className:"text-green-400"});case"overdue":return e.jsx(ne,{size:18,className:"text-red-400"});case"in-progress":return e.jsx(P,{size:18,className:"text-yellow-400"});default:return e.jsx(z,{size:18,className:"text-gray-400"})}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#0d0d1a] to-[#1a1a2e]",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#1a1a2e] to-[#16162a] border-b border-gray-800/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("button",{onClick:()=>r("/portal/onboarding"),className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-4",children:[e.jsx(Y,{size:20}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-white mb-2",children:t.orgName}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(K,{size:16}),t.contactName]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Q,{size:16}),t.email]}),t.phone&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(V,{size:16}),t.phone]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx($,{size:16}),"Event: ",new Date(t.firstEventDate).toLocaleDateString("en-AU")]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:_,disabled:j===v,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 text-white font-medium rounded-lg transition-all flex items-center gap-2",children:[e.jsx(P,{size:18}),"Next Step"]}),e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:M,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg transition-all flex items-center gap-2",children:[e.jsx(X,{size:18}),"Export"]}),e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>f(!0),className:"px-4 py-2 bg-red-600/20 hover:bg-red-600/30 text-red-400 font-medium rounded-lg transition-all flex items-center gap-2 border border-red-500/30",children:[e.jsx(ae,{size:18}),"Delete"]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-400",children:["Overall Progress: ",j,"/",v," steps"]}),e.jsxs("span",{className:"text-lg font-bold text-white",children:[N,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-800 rounded-full h-3 overflow-hidden",children:e.jsx(c.div,{initial:{width:0},animate:{width:`${N}%`},transition:{duration:.5},className:`h-full rounded-full ${N===100?"bg-gradient-to-r from-green-600 to-green-500":"bg-gradient-to-r from-red-600 to-red-500"}`})})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-gray-800/50 rounded-xl p-6 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Client Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Organization"}),e.jsx("span",{className:"text-white font-medium",children:t.orgName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Contact"}),e.jsx("span",{className:"text-white font-medium",children:t.contactName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Email"}),e.jsx("span",{className:"text-white font-medium break-all",children:t.email})]}),t.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Phone"}),e.jsx("span",{className:"text-white font-medium",children:t.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Sport"}),e.jsx("span",{className:"text-white font-medium",children:t.sport})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"First Event Date"}),e.jsx("span",{className:"text-white font-medium",children:new Date(t.firstEventDate).toLocaleDateString("en-AU",{weekday:"short",year:"numeric",month:"short",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Signing Date"}),e.jsx("span",{className:"text-white font-medium",children:new Date(t.signingDate).toLocaleDateString("en-AU")})]}),t.contractId&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Contract ID"}),e.jsx("span",{className:"text-white font-medium font-mono text-xs",children:t.contractId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block mb-1",children:"Status"}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold ${t.status==="completed"?"bg-green-600/20 text-green-400 border border-green-500/30":"bg-blue-600/20 text-blue-400 border border-blue-500/30"}`,children:t.status==="completed"?"Completed":"Active"})]})]})]})}),e.jsx("div",{className:"lg:col-span-2 space-y-6",children:[1,2,3].map(s=>{const o=F(s),d=S(s);return e.jsxs("div",{className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-gray-800/50 rounded-xl p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:["Phase ",s,": ",H[s]]}),e.jsxs("span",{className:"text-sm font-bold text-gray-400",children:[o.completed,"/",o.total]})]}),e.jsx("div",{className:"w-full bg-gray-800 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${o.percentage===100?"bg-green-600":"bg-red-600"}`,style:{width:`${o.percentage}%`}})})]}),e.jsx("div",{className:"space-y-4",children:d.map((a,ce)=>{const m=t.steps.findIndex(h=>h.id===a.id),p=oe(a,a.dueDate),w=l===m,W=new Date(a.dueDate),b=Math.ceil((W-new Date)/(1e3*60*60*24));return e.jsxs("div",{id:`step-${m}`,className:`border rounded-lg transition-all ${a.completed?"border-green-500/30 bg-green-600/5":p==="overdue"?"border-red-500/30 bg-red-600/5":"border-gray-700/50"}`,children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:()=>I(m),className:"flex-shrink-0 mt-1",children:a.completed?e.jsx(y,{size:24,className:"text-green-400"}):e.jsx(z,{size:24,className:"text-gray-600 hover:text-gray-400 transition-colors"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-2",children:[e.jsxs("h3",{className:`text-lg font-bold ${a.completed?"text-green-400 line-through":"text-white"}`,children:[a.id,". ",a.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!a.completed&&e.jsx("button",{onClick:()=>A(m),className:`px-3 py-1 rounded-full text-xs font-bold transition-all ${a.inProgress?"bg-yellow-600/20 text-yellow-400 border border-yellow-500/30":"bg-gray-800 text-gray-500 border border-gray-700 hover:bg-gray-700"}`,children:a.inProgress?"In Progress":"Mark In Progress"}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold border flex items-center gap-1 ${R(p)}`,children:[G(p),a.completed?"Complete":p==="overdue"?`${Math.abs(b)}d overdue`:p==="in-progress"?"In Progress":b===0?"Due today":b===1?"Due tomorrow":`${b}d remaining`]})]})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:a.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($,{size:14}),"Due: ",new Date(a.dueDate).toLocaleDateString("en-AU")]}),a.completedDate&&e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(y,{size:14}),"Completed: ",new Date(a.completedDate).toLocaleDateString("en-AU")]})]}),e.jsx("button",{onClick:()=>x(w?null:m),className:"mt-3 text-sm text-red-500 hover:text-red-400 font-medium flex items-center gap-1 transition-colors",children:w?e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:16}),"Hide Details"]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{size:16}),"Show Details & Notes"]})})]})]})}),e.jsx(E,{children:w&&e.jsx(c.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-0 border-t border-gray-700/50 mt-4",children:[a.subTasks&&a.subTasks.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-bold text-white mb-2",children:"Checklist:"}),e.jsx("ul",{className:"space-y-1.5",children:a.subTasks.map((h,B)=>e.jsxs("li",{className:"text-sm text-gray-400 flex items-start gap-2",children:[e.jsx("span",{className:"text-red-500 mt-0.5",children:"•"}),e.jsx("span",{children:h})]},B))})]}),a.emailTemplate&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(ee,{size:14}),"Email Template:"]}),e.jsx("div",{className:"bg-gray-900/50 rounded-lg p-4 border border-gray-800",children:e.jsx("pre",{className:"text-xs text-gray-300 whitespace-pre-wrap font-mono",children:a.emailTemplate.replace("[CLIENT_NAME]",t.contactName).replace("[ORG_NAME]",t.orgName)})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-sm font-bold text-white mb-2 block flex items-center gap-2",children:[e.jsx(re,{size:14}),"Notes:"]}),e.jsx("textarea",{value:a.notes,onChange:h=>L(m,h.target.value),placeholder:"Add notes, links, or details for this step...",className:"w-full bg-gray-900/50 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500 transition-colors text-sm min-h-[100px] resize-y"})]})]})})})]},a.id)})})]},s)})})]})}),e.jsx(E,{children:g&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",onClick:()=>f(!1),children:e.jsxs(c.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:s=>s.stopPropagation(),className:"bg-gradient-to-br from-[#1a1a2e] to-[#16162a] border border-red-500/30 rounded-xl p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Delete Onboarding?"}),e.jsxs("p",{className:"text-gray-400 mb-6",children:["Are you sure you want to delete the onboarding workflow for ",e.jsx("strong",{className:"text-white",children:t.orgName}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:U,className:"flex-1 px-4 py-3 bg-red-600 hover:bg-red-500 text-white font-bold rounded-lg transition-all",children:"Yes, Delete"}),e.jsx("button",{onClick:()=>f(!1),className:"flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-600 text-white font-bold rounded-lg transition-all",children:"Cancel"})]})]})})})]})}export{je as default};
