import{s as r,j as e,h as K}from"./index-B7o4PSF_.js";import{b as d}from"./vendor-react-q0iRXJvs.js";import"./vendor-supabase-DhDedaeW.js";function ye(){const[I,X]=d.useState([]),[l,S]=d.useState(null),[k,Z]=d.useState([]),[$,ee]=d.useState([]),[se,B]=d.useState([]),[te,G]=d.useState([]),[P,ae]=d.useState([]),[z,re]=d.useState([]),[ie,W]=d.useState(!0),[w,J]=d.useState("events"),[Y,D]=d.useState(!1),[m,le]=d.useState(null),[p,ne]=d.useState(null),[a,n]=d.useState({}),[j,de]=d.useState(null),[H,oe]=d.useState([]),[ce,O]=d.useState(!1),[q,xe]=d.useState([]),[_,A]=d.useState([]),Q=new URLSearchParams(window.location.hash.split("?")[1]||"").get("org");d.useEffect(()=>{E()},[]),d.useEffect(()=>{l&&f(l.id)},[l]);async function E(){W(!0);const{data:s}=await r.from("organizations").select("*").order("name");if(X(s||[]),Q&&s){const t=s.find(i=>i.id===Q);t&&(S(t),window.location.hash.includes("galleries")&&J("galleries"))}W(!1)}async function f(s){const[t,i,o,y]=await Promise.all([r.from("events").select("*").eq("organization_id",s).order("date",{ascending:!0}),r.from("packages").select("*").eq("organization_id",s).order("sort_order"),r.from("content_orders").select("*, events(name), packages(name)").eq("organization_id",s).order("created_at",{ascending:!1}).limit(50),r.from("galleries").select("*, events(name), gallery_photos(count)").eq("organization_id",s).order("created_at",{ascending:!1})]);Z(t.data||[]),ee(i.data||[]),ae(o.data||[]),re(y.data||[]);const N=(t.data||[]).map(c=>c.id);if(N.length>0){const[c,u]=await Promise.all([r.from("division_categories").select("*").in("event_id",N).order("sort_order"),r.from("division_subdivisions").select("*").order("sort_order")]);B(c.data||[]);const v=(c.data||[]).map(g=>g.id);G((u.data||[]).filter(g=>v.includes(g.category_id)))}else B([]),G([])}async function me(){const{data:s,error:t}=await r.from("packages").select("*, organizations(name, display_name)").neq("organization_id",l?.id).order("name");!t&&s&&xe(s)}async function ge(){if(_.length===0||!l)return;const t=q.filter(o=>_.includes(o.id)).map(o=>({name:o.name,description:o.description,price:o.price,sort_order:o.sort_order,active:o.active,organization_id:l.id})),{error:i}=await r.from("packages").insert(t);i?alert("Failed to import packages: "+i.message):(O(!1),A([]),f(l.id))}function M(s){return se.filter(t=>t.event_id===s)}function F(s){return te.filter(t=>t.category_id===s)}function b(s,t=null,i=null){le(s),ne(t),s==="org"?n(t||{name:"",display_name:"",legal_name:"",slug:"",description:"",logo_url:"",active:!0}):s==="event"?n(t||{organization_id:l?.id,name:"",date:"",location:"",status:"upcoming",active:!0,divisions_required:!1}):s==="package"?n(t||{organization_id:l?.id,name:"",description:"",price:"",sort_order:0,active:!0}):s==="division-cat"?n(t||{event_id:i||j,name:"",sort_order:0,active:!0}):s==="division-sub"&&n(t||{category_id:i,name:"",sort_order:0,active:!0}),D(!0)}async function he(){try{if(m==="org")p?.id?await r.from("organizations").update(a).eq("id",p.id):await r.from("organizations").insert(a),E();else if(m==="event"){const s={...a,organization_id:l.id};p?.id?await r.from("events").update(s).eq("id",p.id):await r.from("events").insert(s),f(l.id)}else if(m==="package"){const s={...a,organization_id:l.id,price:parseFloat(a.price)};p?.id?await r.from("packages").update(s).eq("id",p.id):await r.from("packages").insert(s),f(l.id)}else m==="division-cat"?(p?.id?await r.from("division_categories").update(a).eq("id",p.id):await r.from("division_categories").insert(a),f(l.id)):m==="division-sub"&&(p?.id?await r.from("division_subdivisions").update(a).eq("id",p.id):await r.from("division_subdivisions").insert(a),f(l.id));D(!1)}catch(s){console.error("Save error:",s),alert("Error saving. Check console.")}}async function C(s,t){if(s==="organizations"){await ue(t);return}if(!confirm("Are you sure you want to delete this item?"))return;const{error:i}=await r.from(s).delete().eq("id",t);if(i){console.error("Delete error:",i),alert(`Failed to delete: ${i.message}`);return}f(l.id)}async function ue(s){const t=I.find(x=>x.id===s);if(!t)return;const[i,o,y,N]=await Promise.all([r.from("events").select("id, name").eq("organization_id",s),r.from("packages").select("id, name").eq("organization_id",s),r.from("content_orders").select("id").eq("organization_id",s),r.from("livestream_events").select("id, title").eq("organization_id",s)]),c=i.data||[],u=o.data||[],v=y.data||[],g=N.data||[];let h=`âš ï¸ DELETE "${t.display_name||t.name}"?

This will also delete:
`;if(c.length>0&&(h+=`
ðŸ“… ${c.length} event${c.length>1?"s":""}`,c.slice(0,3).forEach(x=>{h+=`
   â€¢ ${x.name}`}),c.length>3&&(h+=`
   â€¢ ...and ${c.length-3} more`)),u.length>0&&(h+=`

ðŸ“¦ ${u.length} package${u.length>1?"s":""}`,u.slice(0,3).forEach(x=>{h+=`
   â€¢ ${x.name}`}),u.length>3&&(h+=`
   â€¢ ...and ${u.length-3} more`)),g.length>0&&(h+=`

ðŸŽ¬ ${g.length} livestream event${g.length>1?"s":""}`,g.slice(0,3).forEach(x=>{h+=`
   â€¢ ${x.title}`}),g.length>3&&(h+=`
   â€¢ ...and ${g.length-3} more`)),v.length>0&&(h+=`

ðŸ§¾ ${v.length} order${v.length>1?"s":""}`),c.length+u.length+v.length+g.length===0?h=`Delete "${t.display_name||t.name}"?

No related items will be affected.`:h+=`

âš ï¸ THIS CANNOT BE UNDONE!`,!!confirm(h))try{v.length>0&&await r.from("content_orders").delete().eq("organization_id",s),u.length>0&&await r.from("packages").delete().eq("organization_id",s);for(const T of c){const{data:U}=await r.from("division_categories").select("id").eq("event_id",T.id);if(U&&U.length>0){for(const pe of U)await r.from("division_subdivisions").delete().eq("category_id",pe.id);await r.from("division_categories").delete().eq("event_id",T.id)}await r.from("events").delete().eq("id",T.id)}g.length>0&&await r.from("livestream_events").update({organization_id:null}).eq("organization_id",s);const{error:x}=await r.from("organizations").delete().eq("id",s);if(x)throw x;E(),l?.id===s&&S(null)}catch(x){console.error("Cascade delete error:",x),alert(`Failed to delete: ${x.message}`)}}async function R(s,t,i){await r.from(s).update({active:!i}).eq("id",t),s==="organizations"?E():f(l.id)}if(ie)return e.jsx("div",{className:"p-8 text-gray-400",children:"Loading..."});if(!l)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Content Management"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select an organization to manage its events, packages, and divisions"})]}),e.jsx("button",{onClick:()=>b("org"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm font-medium",children:"+ Add Organization"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:I.map(s=>e.jsxs("div",{onClick:()=>S(s),className:"bg-gray-900/50 rounded-xl border border-gray-800 p-6 cursor-pointer hover:border-red-500/50 hover:bg-gray-900/80 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.logo_url?e.jsx("img",{src:K(s.logo_url),alt:s.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center text-xl font-bold",children:s.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg group-hover:text-red-400 transition-colors",children:s.display_name||s.name}),s.display_name&&s.display_name!==s.name&&e.jsx("p",{className:"text-xs text-gray-400",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",s.slug]})]})]}),!s.active&&e.jsx("span",{className:"text-xs bg-gray-700 px-2 py-1 rounded",children:"Inactive"})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),b("org",s)},className:"text-xs text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),R("organizations",s.id,s.active)},className:"text-xs text-gray-400 hover:text-white",children:s.active?"Deactivate":"Activate"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),C("organizations",s.id)},className:"text-xs text-red-400 hover:text-red-300",children:"Delete"})]})]},s.id))}),Y&&V()]});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>S(null),className:"text-gray-400 hover:text-white transition-colors",children:"â† Back"}),e.jsxs("div",{className:"flex items-center gap-3",children:[l.logo_url?e.jsx("img",{src:K(l.logo_url),alt:l.name,className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-red-600 to-red-800 flex items-center justify-center text-lg font-bold",children:l.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:l.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["/",l.slug]})]})]})]}),e.jsx("div",{className:"flex gap-2 mb-6 border-b border-gray-700 pb-2",children:["events","packages","divisions","galleries","orders"].map(s=>e.jsxs("button",{onClick:()=>J(s),className:`px-4 py-2 rounded-t-lg capitalize transition-colors ${w===s?"bg-red-600 text-white":"text-gray-400 hover:text-white"}`,children:[s," ",s==="events"&&`(${k.length})`,s==="packages"&&`(${$.length})`,s==="galleries"&&`(${z.length})`,s==="orders"&&`(${P.length})`]},s))}),w==="events"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Upcoming Events"}),e.jsx("button",{onClick:()=>b("event"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Event"})]}),k.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No events yet. Add one to get started."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Event Name"}),e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Location"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-center p-3",children:"Active"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(s=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:s.name}),e.jsx("td",{className:"p-3 text-gray-400",children:s.date&&new Date(s.date).toLocaleDateString("en-AU",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{className:"p-3 text-gray-400",children:s.location}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="upcoming"?"bg-blue-600":s.status==="active"?"bg-green-600":"bg-gray-600"}`,children:s.status})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>R("events",s.id,s.active),className:`px-2 py-1 rounded text-xs ${s.active?"bg-green-600":"bg-gray-600"}`,children:s.active?"Yes":"No"})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>b("event",s),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>C("events",s.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},s.id))})]})})]}),w==="packages"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Content Packages"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{me(),O(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm",children:"Import from..."}),e.jsx("button",{onClick:()=>b("package"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Package"})]})]}),$.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No packages yet. Add one to get started, or import from another organization."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Package Name"}),e.jsx("th",{className:"text-left p-3",children:"Description"}),e.jsx("th",{className:"text-right p-3",children:"Price"}),e.jsx("th",{className:"text-center p-3",children:"Active"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:$.map(s=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:s.name}),e.jsx("td",{className:"p-3 text-gray-400 truncate max-w-xs",children:s.description}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",s.price]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>R("packages",s.id,s.active),className:`px-2 py-1 rounded text-xs ${s.active?"bg-green-600":"bg-gray-600"}`,children:s.active?"Yes":"No"})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>b("package",s),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),e.jsx("button",{onClick:()=>C("packages",s.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]},s.id))})]})})]}),w==="divisions"&&e.jsx("div",{children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Divisions by Event"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Select an event to manage its division categories and subdivisions"}),k.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"Add events first, then you can manage their divisions."}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:j||"",onChange:s=>de(s.target.value),className:"w-full max-w-md px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"",children:"Select an event..."}),k.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.date&&new Date(s.date).toLocaleDateString("en-AU"),")"]},s.id))]}),j&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Division Categories (",M(j).length,")"]}),e.jsx("button",{onClick:()=>b("division-cat",null,j),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ Add Category"})]}),M(j).length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No division categories for this event yet."}):e.jsx("div",{className:"space-y-3",children:M(j).map(s=>e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>oe(t=>t.includes(s.id)?t.filter(i=>i!==s.id):[...t,s.id]),className:"text-gray-400 hover:text-white",children:e.jsx("svg",{className:`w-5 h-5 transition-transform ${H.includes(s.id)?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("span",{className:"font-semibold",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",F(s.id).length," subdivisions)"]}),!s.active&&e.jsx("span",{className:"text-xs bg-gray-600 px-2 py-0.5 rounded",children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>b("division-cat",s),className:"text-blue-400 hover:text-blue-300 text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>C("division_categories",s.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})]})]}),H.includes(s.id)&&e.jsxs("div",{className:"p-4 border-t border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Subdivisions:"}),e.jsx("button",{onClick:()=>b("division-sub",null,s.id),className:"text-sm text-green-400 hover:text-green-300",children:"+ Add Subdivision"})]}),F(s.id).length===0?e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No subdivisions yet"}):e.jsx("div",{className:"flex flex-wrap gap-2",children:F(s.id).map(t=>e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm ${t.active?"bg-gray-800 border-gray-600":"bg-gray-900 border-gray-700 opacity-50"}`,children:[e.jsx("span",{children:t.name}),e.jsx("button",{onClick:()=>b("division-sub",t,s.id),className:"text-blue-400 hover:text-blue-300",children:"âœŽ"}),e.jsx("button",{onClick:()=>C("division_subdivisions",t.id),className:"text-red-400 hover:text-red-300",children:"Ã—"})]},t.id))})]})]},s.id))}),l.slug==="nba"&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-900/20 border border-blue-800 rounded-xl",children:[e.jsx("h4",{className:"font-semibold text-blue-400 mb-2",children:"Quick Add: Standard NBA Divisions"}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Add all standard NBA bodybuilding divisions for this event"}),e.jsx("button",{onClick:async s=>{const t=s.target,i=t.innerText;if(!j){alert("Please select an event first");return}if(window.confirm("Add all standard NBA divisions to this event?")){t.disabled=!0,t.innerText="Adding divisions...";try{const o={"Men's Physique":["Novice","Open","Masters 40+","Masters 50+","Junior"],"Classic Physique":["Novice","Open","Masters 40+","Masters 50+"],Bodybuilding:["Novice","Open","Masters 40+","Masters 50+","Junior"],Figure:["Novice","Open","Masters 35+","Masters 45+","Junior"],Bikini:["Novice","Open","Masters 35+","Masters 45+","Junior"],Wellness:["Novice","Open","Masters 35+","Masters 45+"],"Fitness Model":["Open","Masters"],"Sports Model":["Open","Masters"],Transformation:["Open"]};let y=0,N=0;for(const[c,u]of Object.entries(o)){const{data:v,error:g}=await r.from("division_categories").insert({event_id:j,name:c,sort_order:y++,active:!0}).select().single();if(g){console.error("Error adding category:",c,g);continue}if(v){N++;let h=0;for(const L of u){const{error:x}=await r.from("division_subdivisions").insert({category_id:v.id,name:L,sort_order:h++,active:!0});x&&console.error("Error adding subdivision:",L,x)}}}alert(`Added ${N} division categories with subdivisions!`),await f(l.id)}catch(o){console.error("Error adding divisions:",o),alert("Error adding divisions: "+o.message)}finally{t.disabled=!1,t.innerText=i}}},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm disabled:opacity-50",children:"Add Standard NBA Divisions"})]})]})]})]})}),w==="galleries"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Photo Galleries"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`/#/portal/galleries?org=${l.id}&create=true`,className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm",children:"+ New Gallery"}),z.length>0&&e.jsx("a",{href:`/#/portal/galleries?org=${l.id}`,className:"px-4 py-2 bg-dark-600 hover:bg-dark-500 rounded-lg text-sm",children:"Manage All"})]})]}),z.length===0?e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-8 text-center text-gray-400",children:"No galleries yet. Create one to start selling event photos."}):e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Gallery Name"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-center p-3",children:"Photos"}),e.jsx("th",{className:"text-right p-3",children:"Price/Photo"}),e.jsx("th",{className:"text-center p-3",children:"Status"}),e.jsx("th",{className:"text-right p-3",children:"Actions"})]})}),e.jsx("tbody",{children:z.map(s=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 font-medium",children:s.title}),e.jsx("td",{className:"p-3 text-gray-400",children:s.events?.name||"â€”"}),e.jsx("td",{className:"p-3 text-center",children:s.gallery_photos?.[0]?.count||0}),e.jsxs("td",{className:"p-3 text-right font-semibold text-green-400",children:["$",(s.price_per_photo/100).toFixed(2)]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="published"?"bg-green-600":s.status==="draft"?"bg-yellow-600":"bg-gray-600"}`,children:s.status})}),e.jsxs("td",{className:"p-3 text-right space-x-2",children:[e.jsx("a",{href:`/#/portal/galleries?edit=${s.id}`,className:"text-blue-400 hover:text-blue-300",children:"Edit"}),s.status==="published"&&e.jsx("a",{href:`/#/gallery/${s.slug}`,target:"_blank",className:"text-green-400 hover:text-green-300",children:"View"})]})]},s.id))})]})})]}),w==="orders"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Orders"}),e.jsx("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Date"}),e.jsx("th",{className:"text-left p-3",children:"Athlete"}),e.jsx("th",{className:"text-left p-3",children:"Email"}),e.jsx("th",{className:"text-left p-3",children:"Event"}),e.jsx("th",{className:"text-left p-3",children:"Package"}),e.jsx("th",{className:"text-right p-3",children:"Amount"}),e.jsx("th",{className:"text-center p-3",children:"Status"})]})}),e.jsx("tbody",{children:P.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-400",children:"No orders yet"})}):P.map(s=>e.jsxs("tr",{className:"border-t border-gray-800",children:[e.jsx("td",{className:"p-3 text-gray-400",children:new Date(s.created_at).toLocaleDateString("en-AU")}),e.jsxs("td",{className:"p-3 font-medium",children:[s.first_name," ",s.last_name]}),e.jsx("td",{className:"p-3 text-gray-400",children:s.email}),e.jsx("td",{className:"p-3 text-gray-400",children:s.events?.name}),e.jsx("td",{className:"p-3 text-gray-400",children:s.packages?.name}),e.jsxs("td",{className:"p-3 text-right font-semibold",children:["$",s.amount]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="paid"?"bg-green-600":s.status==="delivered"?"bg-blue-600":s.status==="pending"?"bg-yellow-600":"bg-gray-600"}`,children:s.status})})]},s.id))})]})})]}),Y&&V(),ce&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-lg max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Import Packages from Other Organizations"}),q.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No packages available to import from other organizations."}):e.jsx("div",{className:"flex-1 overflow-y-auto mb-4 space-y-2",children:Object.entries(q.reduce((s,t)=>{const i=t.organizations?.display_name||t.organizations?.name||"Unknown";return s[i]||(s[i]=[]),s[i].push(t),s},{})).map(([s,t])=>e.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-800 px-3 py-2 font-medium text-sm",children:s}),e.jsx("div",{className:"divide-y divide-gray-800",children:t.map(i=>e.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-800/50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:_.includes(i.id),onChange:o=>{o.target.checked?A(y=>[...y,i.id]):A(y=>y.filter(N=>N!==i.id))},className:"w-4 h-4 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:i.name}),i.description&&e.jsx("div",{className:"text-xs text-gray-400 truncate",children:i.description})]}),e.jsxs("div",{className:"text-green-400 font-semibold",children:["$",i.price]})]},i.id))})]},s))}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>{O(!1),A([])},className:"flex-1 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:ge,disabled:_.length===0,className:"flex-1 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:["Import ",_.length>0&&`(${_.length})`]})]})]})})]});function V(){return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[p?"Edit":"Add"," ",m==="org"?"Organization":m==="event"?"Event":m==="package"?"Package":m==="division-cat"?"Division Category":m==="division-sub"?"Subdivision":""]}),e.jsxs("div",{className:"space-y-4",children:[m==="org"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Organization Name *"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value}),placeholder:"e.g., World Ninja Games",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name (Short)"}),e.jsx("input",{type:"text",value:a.display_name||"",onChange:s=>n({...a,display_name:s.target.value}),placeholder:"e.g., WNG",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown on livestream cards & filters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Legal Name"}),e.jsx("input",{type:"text",value:a.legal_name||"",onChange:s=>n({...a,legal_name:s.target.value}),placeholder:"e.g., World Ninja Games Pty Ltd",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For contracts & invoices"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Slug (URL-friendly)"}),e.jsx("input",{type:"text",value:a.slug||"",onChange:s=>n({...a,slug:s.target.value.toLowerCase().replace(/\s+/g,"-")}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Logo URL"}),e.jsx("input",{type:"text",value:a.logo_url||"",onChange:s=>n({...a,logo_url:s.target.value}),placeholder:"https://...",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:s=>n({...a,description:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",rows:3})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-4 mt-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-3 font-medium",children:"Contact / Organizer"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:a.contact_name||"",onChange:s=>n({...a,contact_name:s.target.value}),placeholder:"e.g., Phil Cassidy",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Email"}),e.jsx("input",{type:"email",value:a.contact_email||"",onChange:s=>n({...a,contact_email:s.target.value}),placeholder:"email@example.com",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Contact Phone"}),e.jsx("input",{type:"tel",value:a.contact_phone||"",onChange:s=>n({...a,contact_phone:s.target.value}),placeholder:"+61 400 000 000",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]})]})]})]}),m==="event"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Event Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:a.date||"",onChange:s=>n({...a,date:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:a.location||"",onChange:s=>n({...a,location:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:a.status||"upcoming",onChange:s=>n({...a,status:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg",children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.divisions_required||!1,onChange:s=>n({...a,divisions_required:s.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-white",children:"Require Divisions"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Athletes must select a division when ordering"})]})]})]}),m==="package"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Package Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:a.description||"",onChange:s=>n({...a,description:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Price (AUD)"}),e.jsx("input",{type:"number",value:a.price||"",onChange:s=>n({...a,price:s.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:s=>n({...a,sort_order:parseInt(s.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]})]}),m==="division-cat"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value}),placeholder:"e.g., Men's Physique, Bikini, Figure",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:s=>n({...a,sort_order:parseInt(s.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),m==="division-sub"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Subdivision Name"}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>n({...a,name:s.target.value}),placeholder:"e.g., Novice, Open, Masters 40+",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort Order"}),e.jsx("input",{type:"number",value:a.sort_order||0,onChange:s=>n({...a,sort_order:parseInt(s.target.value)}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:a.active??!0,onChange:s=>n({...a,active:s.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-400",children:"Active"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-2 border border-gray-600 rounded-lg hover:bg-gray-800",children:"Cancel"}),e.jsx("button",{onClick:he,className:"flex-1 py-2 bg-red-600 hover:bg-red-700 rounded-lg",children:"Save"})]})]})})}}export{ye as default};
